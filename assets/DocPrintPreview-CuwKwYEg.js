import{Bi as e,Fa as t,Ki as n,La as r,Li as i,Oa as a,Pa as o,Ra as s,Ui as c,Vi as l,Wi as u,ba as ee,ca as d,i as f,ia as te,mt as ne,o as p,oa as m,qi as h}from"./index-BHNnQTTo.js";import{t as re}from"./button-DHTtQedQ.js";var ie={class:`print-preview-container`},ae={class:`no-print flex justify-end items-center mb-8 gap-3 max-w-4xl mx-auto px-4 sm:px-0`},oe={key:0,class:`flex justify-center items-center h-64`},se={key:1,ref:`printRef`,class:`print-document bg-white p-4 shadow-lg rounded-lg max-w-4xl mx-auto`},ce={class:`m-8 py-6`},le={class:`flex justify-between items-start mb-8`},ue=[`src`],de={class:`text-2xl font-bold text-gray-900`},g={class:`text-sm text-gray-600`},_={key:1,class:`text-xs text-gray-500 font-medium`},v={class:`text-sm text-gray-600`},y={key:2,class:`text-sm text-gray-600`},b={class:`text-right`},x={class:`text-lg font-bold text-gray-900`},S={class:`mt-2 space-y-1`},C={key:0,class:`text-xs text-gray-500 font-medium`},w={key:1,class:`text-xs text-gray-500 font-medium`},T={class:`mb-8 p-4 bg-gray-50 rounded-lg`},E={class:`text-lg font-semibold text-gray-900`},D={class:`w-full mb-8 print-table`},O={class:`py-3 text-sm text-gray-600`},k={class:`py-3 text-sm text-gray-900`},A={class:`py-3 text-sm text-gray-900 text-right`},j={class:`py-3 text-sm text-gray-900 text-right`},M={class:`py-3 text-sm text-gray-900 text-right`},N={class:`py-3 text-sm text-gray-900 text-right font-medium`},P={class:`flex justify-end mb-8`},F={class:`w-64`},I={class:`flex justify-between py-2 border-b border-gray-100`},L={class:`font-medium`},R={key:0,class:`flex justify-between py-2 border-b border-gray-100`},z={class:`font-medium`},B={class:`flex justify-between py-3 text-lg font-bold`},V={class:`text-blue-600`},H={key:0,class:`flex items-center gap-4 mb-8 p-4 bg-gray-50 rounded-lg`},fe=[`src`],pe={class:`grid grid-cols-2 gap-x-8 gap-y-4 mb-8`},me={class:`text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1`},he={class:`text-sm text-gray-900`},ge={class:`text-sm font-bold text-gray-700 uppercase mb-3 border-b pb-1`},_e={class:`w-full print-table`},ve={class:`border-b-2 border-gray-200`},ye={class:`py-2 text-xs text-gray-500`},be={key:2,class:`mb-6`},xe={class:`text-sm text-gray-700 whitespace-pre-line`},Se={key:3,class:`mb-6 pt-4 border-t border-gray-200`},Ce={class:`text-xs text-gray-600 whitespace-pre-line`},we={class:`pt-8 border-t border-gray-200 text-center mt-auto`},Te={class:`text-xs text-gray-500`},Ee={key:0,class:`text-xs text-gray-400 mt-1`},U={__name:`DocPrintPreview`,props:{doctype:{type:String,required:!0},name:{type:String,required:!0}},setup(f){let U=f,W=a({}),G=a({}),K=a({}),q=a({}),J=a(!0);function Y(e){return e==null?`₦0.00`:new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:W.value.currency||`NGN`}).format(e)}function X(e){return e?new Date(e).toLocaleDateString(`en-GB`,{day:`2-digit`,month:`short`,year:`numeric`}):`-`}function De(e){return{Draft:`text-gray-500`,Submitted:`text-blue-600`,Paid:`text-green-600`,Partial:`text-amber-600`,Overdue:`text-red-600`,Cancelled:`text-red-600`,Approved:`text-green-600`,Pending:`text-amber-600`,Active:`text-green-600`}[e]||`text-gray-500`}function Z(e){return[`CURRENCY`,`FLOAT`,`INT`,`PERCENT`].includes(e.fieldtype)}let Oe=e(()=>G.value.fields?G.value.fields.filter(e=>!e.hidden&&![`TABLE`,`SECTION_BREAK`,`COLUMN_BREAK`,`HTML`,`READ_ONLY`].includes(e.fieldtype)&&W.value[e.fieldname]!==void 0&&W.value[e.fieldname]!==null&&W.value[e.fieldname]!==``):[]),ke=e(()=>G.value.fields?G.value.fields.filter(e=>e.fieldtype===`TABLE`&&!e.hidden):[]);function Q(e){if(!W.value[e.fieldname]||W.value[e.fieldname].length===0)return[];let t=W.value[e.fieldname][0];return Object.keys(t).filter(e=>![`name`,`owner`,`creation`,`modified`,`modified_by`,`parent`,`parentfield`,`parenttype`,`idx`,`docstatus`].includes(e)).map(e=>({fieldname:e,label:e.replace(/_/g,` `).toUpperCase(),fieldtype:typeof t[e]==`number`?`CURRENCY`:`DATA`}))}function $(){window.print()}async function Ae(){J.value=!0;try{G.value=(await p.get(`/org/doctypes/${encodeURIComponent(U.doctype)}`,{authorizeRequest:!0,organisationAware:!0})).data||{},W.value=(await p.get(`/org/doc/${encodeURIComponent(U.doctype)}/${encodeURIComponent(U.name)}`,{authorizeRequest:!0,organisationAware:!0})).data||{},document.title=`${U.doctype}: ${U.name} - Print Preview`;try{q.value=(await p.get(`/org/details`,{authorizeRequest:!0,organisationAware:!0})).data||{}}catch(e){console.error(`Failed to fetch organisation details:`,e)}try{K.value=(await p.get(`/org/doc/Brand Settings/Brand Settings`,{authorizeRequest:!0,organisationAware:!0})).data||{}}catch{console.warn(`Brand settings not found`)}}catch(e){console.error(`Failed to fetch data:`,e)}finally{J.value=!1}}return te(Ae),(e,a)=>(m(),u(`div`,ie,[l(`div`,ae,[h(o(re),{variant:`outline`,onClick:$,class:`rounded-full shadow-sm bg-white hover:bg-stone-50 border-stone-200 text-stone-600 px-6 font-semibold h-10`},{default:ee(()=>[h(o(ne),{class:`w-4 h-4 mr-2`}),a[0]||=n(` Print `,-1)]),_:1})]),J.value?(m(),u(`div`,oe,[...a[1]||=[l(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600`},null,-1)]])):(m(),u(`div`,se,[l(`div`,ce,[l(`div`,le,[l(`div`,null,[K.value?.logo_url?(m(),u(`img`,{key:0,src:K.value.logo_url,alt:`Company Logo`,class:`h-16 mb-2`},null,8,ue)):c(``,!0),l(`h1`,de,s(q.value?.legalName||q.value?.name||K.value?.legal_name||`Company Name`),1),l(`p`,g,s(q.value?.fullAddress||K.value?.full_address||``),1),q.value?.state||q.value?.country?(m(),u(`p`,_,s([q.value?.state,q.value?.country].filter(Boolean).join(`, `)),1)):c(``,!0),l(`p`,v,s(q.value?.phone||K.value?.phone||``),1),q.value?.email||K.value?.email?(m(),u(`p`,y,s(q.value?.email||K.value?.email),1)):c(``,!0)]),l(`div`,b,[l(`h2`,{class:`text-3xl font-black mb-1 uppercase tracking-tight`,style:r({color:G.value?.color||`#2563eb`})},s(G.value?.name||f.doctype),5),l(`p`,x,`#`+s(W.value.name||U.name),1),l(`div`,S,[W.value.posting_date||W.value.date?(m(),u(`p`,C,` DATE: `+s(X(W.value.posting_date||W.value.date)),1)):c(``,!0),W.value.due_date?(m(),u(`p`,w,` DUE: `+s(X(W.value.due_date)),1)):c(``,!0),W.value.status?(m(),u(`p`,{key:2,class:t([`text-xs font-bold uppercase`,De(W.value.status)])},` STATUS: `+s(W.value.status),3)):c(``,!0)])])]),f.doctype===`Sales Invoice`?(m(),u(i,{key:0},[l(`div`,T,[a[2]||=l(`h3`,{class:`text-sm font-semibold text-gray-500 uppercase mb-2`},`Bill To`,-1),l(`p`,E,s(W.value.customer_name),1)]),l(`table`,D,[a[3]||=l(`thead`,null,[l(`tr`,{class:`border-b-2 border-gray-200`},[l(`th`,{class:`text-left py-2 text-sm font-semibold text-gray-600`},`#`),l(`th`,{class:`text-left py-2 text-sm font-semibold text-gray-600`},`Description`),l(`th`,{class:`text-right py-2 text-sm font-semibold text-gray-600`},`Qty`),l(`th`,{class:`text-right py-2 text-sm font-semibold text-gray-600`},`Rate`),l(`th`,{class:`text-right py-2 text-sm font-semibold text-gray-600`},`Tax`),l(`th`,{class:`text-right py-2 text-sm font-semibold text-gray-600`},`Amount`)])],-1),l(`tbody`,null,[(m(!0),u(i,null,d(W.value.items||[],(e,t)=>(m(),u(`tr`,{key:t,class:`border-b border-gray-100`},[l(`td`,O,s(t+1),1),l(`td`,k,s(e.description),1),l(`td`,A,s(e.qty),1),l(`td`,j,s(Y(e.rate)),1),l(`td`,M,s(Y(e.tax_amount||0)),1),l(`td`,N,s(Y(e.net_amount||e.amount)),1)]))),128))])]),l(`div`,P,[l(`div`,F,[l(`div`,I,[a[4]||=l(`span`,{class:`text-gray-600`},`Subtotal`,-1),l(`span`,L,s(Y(W.value.grand_total)),1)]),W.value.total_tax?(m(),u(`div`,R,[a[5]||=l(`span`,{class:`text-gray-600`},`Tax`,-1),l(`span`,z,s(Y(W.value.total_tax)),1)])):c(``,!0),l(`div`,B,[a[6]||=l(`span`,null,`Total Due`,-1),l(`span`,V,s(Y(W.value.outstanding_amount||W.value.grand_total)),1)])])]),W.value.qr_code?(m(),u(`div`,H,[l(`img`,{src:W.value.qr_code,alt:`Payment QR Code`,class:`w-24 h-24`},null,8,fe),a[7]||=l(`div`,null,[l(`p`,{class:`text-sm font-semibold text-gray-700`},`Scan to Pay`),l(`p`,{class:`text-xs text-gray-500`},`Use your phone to scan and pay instantly`)],-1)])):c(``,!0)],64)):(m(),u(i,{key:1},[l(`div`,pe,[(m(!0),u(i,null,d(Oe.value,e=>(m(),u(`div`,{key:e.fieldname,class:`border-b border-gray-50 py-2`},[l(`h4`,me,s(e.label),1),l(`p`,he,[e.fieldtype===`CURRENCY`?(m(),u(i,{key:0},[n(s(Y(W.value[e.fieldname])),1)],64)):e.fieldtype===`DATE`?(m(),u(i,{key:1},[n(s(X(W.value[e.fieldname])),1)],64)):(m(),u(i,{key:2},[n(s(W.value[e.fieldname]||`—`),1)],64))])]))),128))]),(m(!0),u(i,null,d(ke.value,e=>(m(),u(`div`,{key:e.fieldname,class:`mb-8`},[l(`h3`,ge,s(e.label),1),l(`table`,_e,[l(`thead`,null,[l(`tr`,ve,[a[8]||=l(`th`,{class:`text-left py-2 text-xs font-semibold text-gray-600`},`#`,-1),(m(!0),u(i,null,d(Q(e),e=>(m(),u(`th`,{key:e.fieldname,class:t([`text-left py-2 text-xs font-semibold text-gray-600`,{"text-right":Z(e)}])},s(e.label),3))),128))])]),l(`tbody`,null,[(m(!0),u(i,null,d(W.value[e.fieldname]||[],(r,a)=>(m(),u(`tr`,{key:a,class:`border-b border-gray-50`},[l(`td`,ye,s(a+1),1),(m(!0),u(i,null,d(Q(e),e=>(m(),u(`td`,{key:e.fieldname,class:t([`py-2 text-xs text-gray-900`,{"text-right":Z(e)}])},[e.fieldtype===`CURRENCY`?(m(),u(i,{key:0},[n(s(Y(r[e.fieldname])),1)],64)):(m(),u(i,{key:1},[n(s(r[e.fieldname]||`—`),1)],64))],2))),128))]))),128))])])]))),128))],64)),W.value.payment_instructions?(m(),u(`div`,be,[a[9]||=l(`h3`,{class:`text-sm font-semibold text-gray-500 uppercase mb-2`},`Payment Instructions`,-1),l(`p`,xe,s(W.value.payment_instructions),1)])):c(``,!0),W.value.terms_and_conditions||W.value.terms?(m(),u(`div`,Se,[a[10]||=l(`h3`,{class:`text-sm font-semibold text-gray-500 uppercase mb-2`},`Terms & Conditions`,-1),l(`p`,Ce,s(W.value.terms_and_conditions||W.value.terms),1)])):c(``,!0),l(`div`,we,[l(`p`,Te,`Regulated and Powered by `+s(K.value?.legal_name||`Seamlessly`),1),K.value?.website?(m(),u(`p`,Ee,s(K.value.website),1)):c(``,!0)])])],512))]))}},W=f(U,[[`__scopeId`,`data-v-d8d2684c`]]);export{W as default};