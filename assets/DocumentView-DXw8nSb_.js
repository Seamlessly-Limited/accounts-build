import"./useFormControl-Dnp3iC5X.js";import"./ListboxItem-Bfe5qZhm.js";import"./useNonce-CnEoXn07.js";import"./nullish-CfjOSA4G.js";import"./useArrowNavigation-siWGBYoD.js";import"./ConfigProvider-Ckl6KgMj.js";import"./useHideOthers-L15EfXxs.js";import"./useDirection-B1kSZwKq.js";import"./PopperAnchor-Sq61S0mP.js";import"./useId-Da-MS2me.js";import"./useKbd-BvGB3m10.js";import"./PopperContent-b6gGwF_E.js";import"./useTypeahead---iVCXRs.js";import"./DialogPortal-Dl-6IrmI.js";import"./Teleport-BJpx-KiC.js";import"./utils-BpsHH13c.js";import"./DialogTitle-aue_-Krx.js";import"./sheet-NRY9vGcQ.js";import"./utils-BFR0tnUV.js";import"./RovingFocusGroup-BhwVgyO_.js";import"./VisuallyHiddenInput-B3HVdvGc.js";import"./ComboboxItem-BqMucZ-W.js";import"./ComboboxGroup-BeaaVWt-.js";import"./DropdownMenuTrigger-BH9p6Bti.js";import"./MenuSeparator-FLBLb_HD.js";import"./DropdownMenuSeparator-3oAyQvzW.js";import"./Label-BsQm4x39.js";import"./SelectViewport-BHDGvtQj.js";import"./SelectGroup-DgFFtqHX.js";import{$i as e,An as t,E as n,Ea as r,Fi as i,Jt as a,Li as o,Mi as s,Ni as c,Nt as l,Oi as u,Pi as d,Q as f,Ri as p,Ta as m,Tn as h,Yi as ee,Zi as g,_,da as v,g as y,gr as b,ji as x,ka as S,na as te,o as C,oa as w,pn as T,rn as E,ut as D,vn as O,vt as ne,ya as k}from"./index-CHNvwQRL.js";import{n as A,t as j}from"./DialogContent-BczLmPtx.js";import{n as M,r as N,t as P}from"./DialogTitle-Dz9VmaLr.js";import{t as F}from"./DialogFooter-DcKhuorP.js";import{t as I}from"./WorkspaceStore-Djee2ZJb.js";import{t as L}from"./Input-i1kcrjFD.js";import{t as R}from"./button-BRhnnMH3.js";import{i as re,n as z,r as B,t as V}from"./DropdownMenuTrigger-DB_AyFT1.js";import{t as H}from"./DropdownMenuSeparator-COnwGw4L.js";import"./DynamicIcon-xdE1DWwJ.js";import"./BottomSheet-BHwNzRxP.js";import"./viewRegistry-CEBXSj_v.js";import{t as U}from"./Label-q_qRHf8-.js";import"./LinkField-rhGWIhbd.js";import{t as W}from"./DocForm-COdYPNei.js";import"./purify.es-CrZVVHqb.js";import"./SelectValue-DyPaSYfc.js";import{t as G}from"./Textarea-BWn0Ir5g.js";var K={class:`grid gap-4 py-4`},q={class:`grid gap-2`},J={class:`grid gap-2`},Y={class:`grid gap-2`},X={__name:`ShareDialog`,props:{modelValue:{type:Boolean,default:!1},doctype:{type:String,required:!0},docName:{type:String,required:!0},defaultRecipient:{type:String,default:``},docData:{type:Object,default:()=>({})}},emits:[`update:modelValue`,`sent`],setup(e,{emit:t}){let n=e,r=t,{toast:i}=y(),a=k(!1),u=x({get:()=>n.modelValue,set:e=>r(`update:modelValue`,e)}),f=k({recipient:``,subject:``,content:``});w(()=>n.modelValue,e=>{e&&(f.value.recipient=n.defaultRecipient||n.docData.email||``,f.value.subject=`${n.doctype} Shared: ${n.docName}`,f.value.content=`Please find the attached ${n.doctype} ${n.docName}.`)});let h=async()=>{if(f.value.recipient){a.value=!0;try{await C.post(`/org/doc/Notification`,{data:{related_document:n.docName,recipient:f.value.recipient,channel:`Email`,subject:f.value.subject,content:f.value.content,status:`Queued`},authorizeRequest:!0,organisationAware:!0}),i({title:`Notification Queued`,description:`Email to ${f.value.recipient} has been queued.`,variant:`success`}),u.value=!1,r(`sent`)}catch(e){console.error(e),i({title:`Failed to Share`,description:e.response?.data?.message||e.message,variant:`destructive`})}finally{a.value=!1}}};return(t,n)=>(g(),c(m(A),{open:u.value,"onUpdate:open":n[4]||=e=>u.value=e},{default:v(()=>[p(m(j),{class:`sm:max-w-[500px]`},{default:v(()=>[p(m(M),null,{default:v(()=>[p(m(P),null,{default:v(()=>[o(`Share `+S(e.doctype),1)]),_:1}),p(m(N),null,{default:v(()=>[...n[5]||=[o(` Send this document via email. `,-1)]]),_:1})]),_:1}),s(`div`,K,[s(`div`,q,[p(m(U),{for:`recipient`},{default:v(()=>[...n[6]||=[o(`Recipient Email`,-1)]]),_:1}),p(m(L),{id:`recipient`,modelValue:f.value.recipient,"onUpdate:modelValue":n[0]||=e=>f.value.recipient=e,placeholder:`name@example.com`,type:`email`},null,8,[`modelValue`])]),s(`div`,J,[p(m(U),{for:`subject`},{default:v(()=>[...n[7]||=[o(`Subject`,-1)]]),_:1}),p(m(L),{id:`subject`,modelValue:f.value.subject,"onUpdate:modelValue":n[1]||=e=>f.value.subject=e,placeholder:`Subject line`},null,8,[`modelValue`])]),s(`div`,Y,[p(m(U),{for:`message`},{default:v(()=>[...n[8]||=[o(`Message (Optional)`,-1)]]),_:1}),p(m(G),{id:`message`,modelValue:f.value.content,"onUpdate:modelValue":n[2]||=e=>f.value.content=e,placeholder:`Add a personal message...`,rows:`4`},null,8,[`modelValue`])])]),p(m(F),null,{default:v(()=>[p(m(R),{variant:`outline`,onClick:n[3]||=e=>u.value=!1},{default:v(()=>[...n[9]||=[o(`Cancel`,-1)]]),_:1}),p(m(R),{onClick:h,disabled:a.value||!f.value.recipient},{default:v(()=>[a.value?(g(),c(m(l),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):d(``,!0),o(` `+S(a.value?`Sending...`:`Send`),1)]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`open`]))}},ie={class:`h-full flex flex-col bg-slate-50/50`},ae={class:`flex-none px-6 py-3 bg-white border-b border-gray-200 flex items-center justify-between sticky top-0 z-20`},oe={class:`flex items-center space-x-4`},se={class:`p-2 rounded-lg bg-stone-100`},ce={class:`flex items-center gap-2`},le={class:`text-[10px] font-bold text-stone-400 uppercase tracking-widest`},ue={class:`text-lg font-bold text-stone-900 leading-tight`},de={class:`flex items-center gap-2`},fe={class:`flex items-center bg-stone-100 p-0.5 rounded-full border border-stone-200 shadow-sm`},pe={class:`p-2 hover:bg-stone-100 rounded-full text-stone-500 transition-colors`},me={class:`flex-1 overflow-auto`},he={key:0,class:`h-full flex items-center justify-center`},ge={key:1,class:`h-full`},_e={key:0,class:`max-w-4xl mx-auto py-8 px-6`},ve={class:`bg-white rounded-3xl shadow-xl shadow-stone-200/50 border border-stone-200/60 overflow-hidden ring-1 ring-black/5`},ye={class:`px-8 py-8 border-b border-stone-100 flex justify-between items-start bg-gradient-to-br from-white to-stone-50/50`},be={class:`text-3xl font-black text-stone-900 tracking-tight`},xe={class:`text-stone-500 mt-1 flex items-center gap-2`},Se={class:`text-right`},Ce={class:`text-sm font-medium text-stone-600`},we={class:`p-8 space-y-10`},Te={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-12 gap-y-8`},Ee={class:`block text-[10px] font-bold text-stone-400 uppercase tracking-widest group-hover:text-stone-500 transition-colors`},De={class:`text-sm font-semibold text-stone-800 break-words`},Oe=[`onClick`],ke={key:0,class:`space-y-8 pt-6 border-t border-stone-100`},Ae={class:`block text-[10px] font-bold text-stone-400 uppercase tracking-widest`},je={class:`text-sm text-stone-600 leading-relaxed bg-stone-50/50 p-4 rounded-xl border border-stone-100 whitespace-pre-wrap`},Me={class:`pt-10 mt-10 border-t border-stone-100 flex items-center justify-between text-[11px] text-stone-400`},Ne={class:`flex items-center gap-4`},Pe={class:`flex items-center gap-1`},Fe={class:`flex items-center gap-1`},Ie={class:`flex items-center gap-1 font-mono uppercase opacity-60`},Z={key:1,class:`h-full`},Q={__name:`DocumentView`,props:{doctype:{type:String,required:!0},name:{type:String,required:!0},initialMode:{type:String,default:`view`}},setup(w){let A=w,{toast:j}=y(),M=I(),N=k(!0),P=k(A.initialMode),F=k({}),L=k({}),R=k(!1),U=x(()=>L.value.fields?L.value.fields.filter(e=>![`TABLE`,`SECTION_BREAK`,`COLUMN_BREAK`,`TEXT`,`LONG_TEXT`,`HTML`,`JSON`,`HEADING`].includes(e.fieldtype)&&!e.hidden):[]),G=x(()=>L.value.fields?L.value.fields.filter(e=>[`TEXT`,`LONG_TEXT`,`HTML`,`JSON`].includes(e.fieldtype)&&!e.hidden):[]);ee(K);async function K(){N.value=!0;try{let[e,t]=await Promise.all([C.get(`/org/doctypes/${encodeURIComponent(A.doctype)}`,{authorizeRequest:!0,organisationAware:!0}),C.get(`/org/doc/${encodeURIComponent(A.doctype)}/${encodeURIComponent(A.name)}`,{authorizeRequest:!0,organisationAware:!0})]);L.value=e.data||e,F.value=t.data||t}catch(e){console.error(e),j({title:`Fetch failed`,description:e.message,variant:`destructive`})}finally{N.value=!1}}function q(e){F.value=e,P.value=`view`,j({title:`Updated`,description:`Changes saved successfully`,variant:`success`})}function J(e){return _[e]||E}function Y(e){return typeof e==`number`?{0:`Draft`,1:`Submitted`,2:`Cancelled`}[e]||`Unknown`:e||`Draft`}function Q(e){return{Draft:`bg-stone-100 text-stone-600`,Submitted:`bg-blue-100 text-blue-600`,Paid:`bg-green-100 text-green-600`,Cancelled:`bg-red-100 text-red-600`,Active:`bg-indigo-100 text-indigo-600`}[Y(e)]||`bg-stone-100 text-stone-600`}function $(e){return e?new Date(e).toLocaleString(void 0,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`}):`—`}function Le(e){return e?new Date(e).toLocaleDateString(void 0,{year:`numeric`,month:`short`,day:`numeric`}):`—`}function Re(e){return e==null?`—`:new Intl.NumberFormat(void 0,{style:`currency`,currency:F.value.currency||`NGN`}).format(e)}function ze(e,t){!e||!t||M.openTab({id:`doctype-view-${e}-${t}`,title:t,icon:`FileText`,type:`doctype-view`,doctype:e,docName:t,closable:!0})}function Be(){R.value=!0}function Ve(){M.openTab({id:`archive-${A.doctype}-${A.name}`,title:`Archive: ${A.name}`,type:`archive`,doctype:A.doctype,docName:A.name,closable:!0})}function He(){j({title:`Duplicate`,description:`Duplication coming soon`})}function Ue(){window.print()}return(ee,_)=>(g(),i(u,null,[s(`div`,ie,[s(`header`,ae,[s(`div`,oe,[s(`div`,se,[(g(),c(te(J(L.value.icon)),{class:`w-5 h-5 text-stone-600`}))]),s(`div`,null,[s(`div`,ce,[s(`span`,le,S(L.value.name),1),F.value.status?(g(),i(`span`,{key:0,class:r([`px-1.5 py-0.5 rounded-full text-[9px] font-bold uppercase tracking-wider`,Q(F.value.status||F.value.docstatus)])},S(Y(F.value.status||F.value.docstatus)),3)):d(``,!0)]),s(`h1`,ue,S(F.value[L.value.title_field]||F.value.name||w.name),1)])]),s(`div`,de,[s(`div`,fe,[s(`button`,{onClick:_[0]||=e=>P.value=`view`,class:r([`px-4 py-1.5 rounded-full text-xs font-semibold transition-all flex items-center gap-2`,P.value===`view`?`bg-white text-stone-900 shadow-sm ring-1 ring-stone-900/5`:`text-stone-500 hover:text-stone-700`])},[p(m(T),{class:`w-3.5 h-3.5`}),_[3]||=o(` View `,-1)],2),s(`button`,{onClick:_[1]||=e=>P.value=`edit`,class:r([`px-4 py-1.5 rounded-full text-xs font-semibold transition-all flex items-center gap-2`,P.value===`edit`?`bg-white text-stone-900 shadow-sm ring-1 ring-stone-900/5`:`text-stone-500 hover:text-stone-700`])},[p(m(ne),{class:`w-3.5 h-3.5`}),_[4]||=o(` Edit `,-1)],2)]),_[8]||=s(`div`,{class:`w-px h-6 bg-stone-200 mx-1`},null,-1),s(`button`,{onClick:Be,class:`p-2 hover:bg-stone-100 rounded-full text-stone-500 transition-colors`},[p(m(f),{class:`w-4 h-4`})]),p(m(re),null,{default:v(()=>[p(m(V),{"as-child":``},{default:v(()=>[s(`button`,pe,[p(m(O),{class:`w-4 h-4`})])]),_:1}),p(m(B),{align:`end`},{default:v(()=>[p(m(z),{onClick:Ue},{default:v(()=>[p(m(D),{class:`w-4 h-4 mr-2`}),_[5]||=o(` Print `,-1)]),_:1}),p(m(z),{onClick:He},{default:v(()=>[p(m(h),{class:`w-4 h-4 mr-2`}),_[6]||=o(` Duplicate `,-1)]),_:1}),p(m(H)),p(m(z),{onClick:Ve,class:`text-amber-600`},{default:v(()=>[p(m(b),{class:`w-4 h-4 mr-2`}),_[7]||=o(` Archive `,-1)]),_:1})]),_:1})]),_:1})])]),s(`div`,me,[N.value?(g(),i(`div`,he,[p(m(l),{class:`w-8 h-8 animate-spin text-stone-300`})])):(g(),i(`div`,ge,[P.value===`view`?(g(),i(`div`,_e,[s(`div`,ve,[s(`div`,ye,[s(`div`,null,[s(`h2`,be,S(F.value[L.value.title_field]||F.value.name||w.name),1),s(`p`,xe,[p(m(a),{class:`w-3.5 h-3.5 opacity-40`}),o(` `+S(F.value.name),1)])]),s(`div`,Se,[_[9]||=s(`p`,{class:`text-[10px] font-bold text-stone-400 uppercase tracking-widest mb-1`},`Created `,-1),s(`p`,Ce,S($(F.value.created_at)),1)])]),s(`div`,we,[s(`div`,Te,[(g(!0),i(u,null,e(U.value,e=>(g(),i(`div`,{key:e.fieldname,class:`space-y-1.5 group`},[s(`label`,Ee,S(e.label),1),s(`div`,De,[e.fieldtype===`CURRENCY`?(g(),i(u,{key:0},[o(S(Re(F.value[e.fieldname])),1)],64)):e.fieldtype===`CHECKBOX`?(g(),i(`span`,{key:1,class:r(F.value[e.fieldname]?`text-green-600`:`text-stone-400 opacity-50`)},S(F.value[e.fieldname]?`Yes`:`No`),3)):e.fieldtype===`DATE`?(g(),i(u,{key:2},[o(S(Le(F.value[e.fieldname])),1)],64)):e.fieldtype===`LINK`?(g(),i(`button`,{key:3,onClick:t=>ze(e.options,F.value[e.fieldname]),class:`text-blue-600 hover:text-blue-800 hover:underline decoration-2 underline-offset-4 decoration-blue-200 transition-all`},S(F.value[e.fieldname]),9,Oe)):(g(),i(u,{key:4},[o(S(F.value[e.fieldname]||`—`),1)],64))])]))),128))]),G.value.length>0?(g(),i(`div`,ke,[(g(!0),i(u,null,e(G.value,e=>(g(),i(`div`,{key:e.fieldname,class:`space-y-2`},[s(`label`,Ae,S(e.label),1),s(`div`,je,S(F.value[e.fieldname]||`No content provided.`),1)]))),128))])):d(``,!0),s(`div`,Me,[s(`div`,Ne,[s(`span`,Pe,[p(m(n),{class:`w-3 h-3`}),o(` Owner: `+S(F.value.owner||`System`),1)]),s(`span`,Fe,[p(m(t),{class:`w-3 h-3`}),o(` Modified: `+S($(F.value.modified_at||F.value.updated_at)),1)])]),s(`div`,Ie,` MOD: `+S(L.value.module),1)])])])])):(g(),i(`div`,Z,[p(W,{doctype:w.doctype,name:w.name,"is-new":!1,"is-embedded":``,onSaved:q},null,8,[`doctype`,`name`])]))]))])]),F.value.name?(g(),c(X,{key:0,modelValue:R.value,"onUpdate:modelValue":_[2]||=e=>R.value=e,doctype:w.doctype,docName:w.name,docData:F.value},null,8,[`modelValue`,`doctype`,`docName`,`docData`])):d(``,!0)],64))}};export{Q as default};