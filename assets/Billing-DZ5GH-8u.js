import{Aa as e,Bi as t,Hi as n,Ii as r,Li as i,Ln as a,Ni as o,On as s,Pa as c,Ri as l,Ui as u,Yn as d,a as f,ea as p,ga as m,ia as h,ja as g,lt as _,na as v,ut as y,wa as b,zi as x}from"./index-BW6FH5S4.js";import{n as S,t as C}from"./DialogContent-DzO0B1dQ.js";import{n as w,r as T,t as E}from"./DialogTitle-BAO4s_Rj.js";import{t as D}from"./DialogFooter-BGPl6WoG.js";import{t as O}from"./button-BIS6kOZQ.js";import{t as k}from"./OrganisationService-DlrS9wAG.js";import{t as A}from"./Card-DL4aOVo_.js";import{t as j}from"./CardContent-DCQKa7iN.js";import{n as M,r as N,t as P}from"./CardTitle-DOurhy1D.js";import{t as F}from"./badge-DeOd_cPn.js";var I={class:`space-y-8`},L={class:`flex items-start justify-between`},R={class:`flex flex-col sm:flex-row gap-4`},ee={key:0,class:`space-y-4`},te={class:`flex items-center justify-between`},ne={class:`flex items-start gap-4 flex-1`},re={class:`p-3 rounded-full bg-slate-100 dark:bg-slate-900`},ie={class:`flex-1`},ae={class:`flex items-center gap-2`},oe={class:`font-semibold text-gray-900 dark:text-white`},se={class:`text-sm text-gray-500 dark:text-gray-400 mt-1`},ce={key:0,class:`text-xs text-gray-400 dark:text-gray-500 mt-1`},le={class:`text-right`},ue={class:`text-lg font-bold text-gray-900 dark:text-white`},de={class:`flex justify-center my-6`},fe={class:`rounded-full bg-stone-100 text-blue-950 px-0.5 py-0.5 w-fit inline-flex items-center`},pe={class:`grid md:grid-cols-3 gap-6`},me={class:`mb-4`},he={class:`text-lg font-bold text-gray-900 dark:text-white`},ge={class:`text-xs text-gray-500 dark:text-gray-400 mt-1`},_e={class:`mb-4`},ve={class:`text-3xl font-bold text-gray-900 dark:text-white`},ye={class:`text-gray-500 dark:text-gray-400`},be={class:`space-y-2 mb-6 flex-1 text-sm`},xe={class:`text-xs text-gray-600 dark:text-gray-300`},z={__name:`ActiveSubscription`,props:{subscription:{type:Object,required:!0},payments:{type:Array,default:()=>[]},plans:{type:Array,required:!0},isYearly:{type:Boolean,default:!1}},emits:[`subscription-updated`,`subscription-cancelled`],setup(p,{emit:D}){let z=f().toast,B=p,V=D,H=b(!1),U=b(!1),W=b(B.isYearly),G=r(()=>B.subscription?B.subscription.plan||B.subscription.planName||`Current Plan`:`No Plan`),K=r(()=>B.subscription?(B.subscription.duration||B.subscription.billingCycle)===`YEARLY`?`Billed Yearly`:`Billed Monthly`:``),q=r(()=>{let e=B.subscription?.status?.toLowerCase();return e===`active`?`default`:e===`cancelled`||e===`expired`?`destructive`:e===`expiring`?`warning`:`secondary`});function J(e){return e?Number(e).toLocaleString(`en-NG`,{minimumFractionDigits:0,maximumFractionDigits:0}):`0`}function Y(e){return B.subscription?(B.subscription.plan||B.subscription.planType)===e.planType:!1}async function X(e){H.value=!0;try{let t=W.value?e.idYearly:e.idMonthly,n=W.value?e.priceYearly:e.priceMonthly,r=W.value?`YEARLY`:`MONTHLY`;window.FlutterwaveCheckout||await Z();let i=JSON.parse(localStorage.getItem(`user`)||`{}`),a=i.email||`user@example.com`,o=i.name||`User`;window.FlutterwaveCheckout({public_key:`FLWPUBK_TEST-SANDBOXDEMOKEY-X`,tx_ref:`SUB-CHANGE-${Date.now()}-${t}`,amount:n,currency:`NGN`,payment_plan:t,payment_options:`card,banktransfer,ussd`,customer:{email:a,name:o},customizations:{title:`Change Subscription Plan`,description:`${e.name} - ${r}`,logo:`https://seamlessly.ng/logo.png`},callback:async function(t){if(t.status===`successful`)try{await k.setSubscription({"payment.reference":`${t.transaction_id}`,"payment.provider":`FLUTTERWAVE`,plan:e.planType,duration:`${r}`}),z({title:`Success`,message:`Subscription plan changed successfully!`,variant:`success`}),U.value=!1,V(`subscription-updated`)}catch(e){z({title:`Error`,message:e.message||`Failed to update subscription.`,variant:`error`})}else z({title:`Payment Failed`,message:`Your payment was not successful. Please try again.`,variant:`error`});H.value=!1},onclose:function(){H.value=!1}})}catch(e){z({title:`Error`,message:e.message||`Failed to initiate plan change.`,variant:`error`}),H.value=!1}}function Z(){return new Promise((e,t)=>{if(window.FlutterwaveCheckout){e();return}let n=document.createElement(`script`);n.src=`https://checkout.flutterwave.com/v3.js`,n.onload=e,n.onerror=t,document.head.appendChild(n)})}async function Q(){if(confirm(`Are you sure you want to cancel your subscription? You'll lose access to premium features at the end of your billing period.`)){H.value=!0;try{await k.cancelSubscription(),z({title:`Cancelled`,message:`Subscription cancelled successfully. You'll retain access until the end of your billing period.`,variant:`success`}),V(`subscription-cancelled`),window.location.reload()}catch(e){z({title:`Error`,message:e.message||`Failed to cancel subscription.`,variant:`error`})}finally{H.value=!1}}}async function $(e){try{let t=await k.downloadReceipt(e);t.data&&t.data.url?window.open(t.data.url,`_blank`):z({title:`Error`,message:`Receipt download link not found.`,variant:`error`})}catch{z({title:`Error`,message:`Failed to download receipt.`,variant:`error`})}}return(r,f)=>(v(),t(`div`,I,[u(A,{class:`overflow-hidden`},{default:m(()=>[u(M,{class:`bg-gradient-to-r from-primary-50 to-primary-100 dark:from-gray-800 dark:to-gray-700`},{default:m(()=>[i(`div`,L,[i(`div`,null,[u(P,{class:`text-2xl`},{default:m(()=>[n(c(G.value),1)]),_:1}),u(N,{class:`mt-2`},{default:m(()=>[n(c(K.value),1)]),_:1})]),u(F,{variant:q.value,class:`text-sm`},{default:m(()=>[n(c(p.subscription?.status||`Active`),1)]),_:1},8,[`variant`])])]),_:1}),u(j,{class:`pt-6`},{default:m(()=>[i(`div`,R,[u(O,{onClick:f[0]||=e=>U.value=!0,class:`flex-1 rounded-full bg-black dark:bg-white dark:text-black text-white hover:bg-gray-800 dark:hover:bg-gray-100`,disabled:H.value},{default:m(()=>[u(e(s),{class:`mr-2 h-4 w-4`}),f[4]||=n(` Change Plan `,-1)]),_:1},8,[`disabled`]),u(O,{onClick:Q,variant:`outline`,class:`flex-1 rounded-full border-gray-300 text-gray-600 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-950`,disabled:H.value},{default:m(()=>[u(e(a),{class:`mr-2 h-4 w-4`}),f[5]||=n(` Cancel Subscription `,-1)]),_:1},8,[`disabled`])])]),_:1})]),_:1}),i(`div`,null,[f[7]||=i(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-white mb-4`},`Payment History`,-1),p.payments&&p.payments.length>0?(v(),t(`div`,ee,[(v(!0),t(o,null,h(p.payments,r=>(v(),l(A,{key:r.id,class:`hover:shadow-md transition-shadow`},{default:m(()=>[u(j,{class:`pt-6`},{default:m(()=>[i(`div`,te,[i(`div`,ne,[i(`div`,re,[u(e(y),{class:`h-5 w-5 text-blue-600 dark:text-blue-400`})]),i(`div`,ie,[i(`div`,ae,[i(`h3`,oe,c(r.plan||`Subscription Payment`),1),u(F,{variant:`outline`,class:`text-xs`},{default:m(()=>[n(c(r.status||`Completed`),1)]),_:2},1024)]),i(`p`,se,` Completed on `+c(r.timeCompleted),1),r.reference?(v(),t(`p`,ce,` Ref: `+c(r.reference),1)):x(``,!0)])]),i(`div`,le,[i(`p`,ue,` ₦`+c(J(r.amountPaid)),1),r.id?(v(),l(O,{key:0,onClick:e=>$(r.id),variant:`ghost`,size:`sm`,class:`mt-2 text-xs`},null,8,[`onClick`])):x(``,!0)])])]),_:2},1024)]),_:2},1024))),128))])):(v(),l(A,{key:1,class:`shadow-md`},{default:m(()=>[u(j,{class:`pt-12 pb-12 text-center`},{default:m(()=>[u(e(_),{class:`h-12 w-12 text-gray-400 mx-auto mb-4`}),f[6]||=i(`p`,{class:`text-gray-500 dark:text-gray-400`},`No payment history yet`,-1)]),_:1})]),_:1}))]),u(S,{open:U.value,"onUpdate:open":f[3]||=e=>U.value=e},{default:m(()=>[u(C,{class:`max-w-5xl max-h-[90vh] overflow-y-auto`},{default:m(()=>[u(w,null,{default:m(()=>[u(E,{class:`text-2xl`},{default:m(()=>[...f[8]||=[n(`Change Your Plan`,-1)]]),_:1}),u(T,null,{default:m(()=>[...f[9]||=[n(` Select a new plan to upgrade or downgrade your subscription `,-1)]]),_:1})]),_:1}),i(`div`,de,[i(`div`,fe,[i(`button`,{onClick:f[1]||=e=>W.value=!1,class:g([`rounded-full px-4 py-0.5 w-fit font-medium transition-all`,W.value?`text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white`:`bg-stone-50 dark:bg-gray-700 shadow-sm text-gray-900 dark:text-white`])},` Monthly `,2),i(`button`,{onClick:f[2]||=e=>W.value=!0,class:g([`rounded-full bg-stone-100 text-blue-950 px-4 py-0.5 w-fit font-medium transition-all`,W.value?`bg-stone-50 dark:bg-gray-700 shadow-sm text-gray-900 dark:text-white`:`text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white`])},[...f[10]||=[n(` Yearly `,-1),i(`span`,{class:`ml-2 text-xs text-green-600 font-bold`},`-17%`,-1)]],2)])]),i(`div`,pe,[(v(!0),t(o,null,h(p.plans,r=>(v(),t(`div`,{key:r.name,class:`relative flex flex-col p-6 bg-white dark:bg-gray-800 rounded-sm border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow`},[i(`div`,me,[i(`h3`,he,c(r.name),1),i(`p`,ge,c(r.description),1)]),i(`div`,_e,[i(`span`,ve,` ₦`+c(J(W.value?r.priceYearly:r.priceMonthly)),1),i(`span`,ye,`/`+c(W.value?`year`:`month`),1)]),i(`ul`,be,[(v(!0),t(o,null,h(r.features.slice(0,6),n=>(v(),t(`li`,{key:n,class:`flex items-start`},[u(e(d),{class:`h-4 w-4 text-green-500 mr-2 flex-shrink-0 mt-0.5`}),i(`span`,xe,c(n),1)]))),128))]),u(O,{onClick:e=>X(r),disabled:H.value||Y(r),class:g([`w-full rounded-full font-semibold transition-colors`,Y(r)?`bg-gray-100 dark:bg-gray-700 text-gray-400 cursor-not-allowed`:`bg-black hover:bg-gray-800 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100`])},{default:m(()=>[n(c(Y(r)?`Current Plan`:`Select Plan`),1)]),_:2},1032,[`onClick`,`disabled`,`class`])]))),128))])]),_:1})]),_:1},8,[`open`])]))}},B={class:`container mx-auto py-10 px-4 max-w-7xl`},V={key:1},H={class:`flex justify-center mb-10`},U={class:`rounded-full bg-stone-100 text-blue-950 px-0.5 py-0.5 w-fit inline-flex items-center`},W={class:`grid md:grid-cols-3 gap-8 mb-20`},G={class:`mb-6`},K={class:`text-xl font-bold text-gray-900 dark:text-white`},q={class:`text-sm text-gray-500 dark:text-gray-400 mt-2`},J={class:`mb-6`},Y={class:`text-4xl font-bold text-gray-900 dark:text-white`},X={class:`text-gray-500 dark:text-gray-400`},Z={class:`space-y-4 mb-8 flex-1`},Q={class:`text-sm text-gray-600 dark:text-gray-300`},$={__name:`Billing`,setup(r){let a=f().toast,s=b(!1),_=b(!1),y=b(null),x=b([]),A=b(!1),j=[{name:`Basic`,message:`Good for starters and mom-&-pop shops.`,priceMonthly:14500,priceYearly:145e3,idMonthly:227736,idYearly:227736,planType:`BASIC`,features:[`Transactions categorization`,`Financial statements`,`Custom dashboards`,`AI assisted planning`,`Human support`,`1 Bank account sync (NG)`,`Single user access`,`500 transactions per month`,`Bulk data export`,`Third Party integration`,`Cashflow forecast`,`Monthly Budget`,`Tax forms completion`]},{name:`SME/NGO`,message:`Perfect for growing businesses.`,priceMonthly:44500,priceYearly:445e3,idMonthly:227738,idYearly:227739,planType:`SME_NGO`,features:[`Transactions categorization`,`Financial statements`,`Custom dashboards`,`AI assisted planning`,`Live human support`,`5 Bank account sync (NG)`,`Infinite user access`,`1,000 transactions per month`,`Bulk data export`,`Third party integration`,`Cashflow forecast`,`Monthly Budget`,`Tax forms completion`]},{name:`Business`,message:`Deploy large-scale reconciliations.`,priceMonthly:1e5,priceYearly:1e6,idMonthly:227740,idYearly:227741,planType:`BUSINESS`,features:[`Transactions categorization`,`Financial statements`,`Custom dashboards`,`AI assisted planning`,`Live support`,`15 Bank account sync (NG)`,`Infinite user access`,`4,500 transactions per month`,`Bulk data export`,`Third party integration`,`Cashflow forecast`,`Monthly Budget`,`Tax forms completion`]}];p(async()=>{await M()});async function M(){try{let[e,t]=await Promise.all([k.getSubscription().catch(()=>null),k.getPayments().catch(()=>[])]);e&&e.data&&(y.value=e.data),t&&t.data?x.value=t.data:Array.isArray(t)&&(x.value=t)}catch{}}async function N(e){_.value=!0;try{let t=s.value?e.idYearly:e.idMonthly,n=s.value?e.priceYearly:e.priceMonthly,r=s.value?`YEARLY`:`MONTHLY`;window.FlutterwaveCheckout||await P();let i=JSON.parse(localStorage.getItem(`user`)||`{}`),o=i.email||`user@example.com`,c=i.name||`User`;window.FlutterwaveCheckout({public_key:`FLWPUBK_TEST-SANDBOXDEMOKEY-X`,tx_ref:`SUB-${Date.now()}-${t}`,amount:n,currency:`NGN`,payment_plan:t,payment_options:`card,banktransfer,ussd`,customer:{email:o,name:c},customizations:{title:`Seamlessly Subscription`,message:`${e.name} - ${r}`,logo:`https://seamlessly.ng/logo.png`},callback:async function(t){if(t.status===`successful`)try{await k.setSubscription({"payment.reference":`${t.transaction_id}`,"payment.provider":`FLUTTERWAVE`,plan:e.planType,duration:`${r}`}),a({title:`Welcome!`,message:`Your subscription has been activated successfully!`,variant:`success`}),setTimeout(()=>{window.location.reload()},5e3)}catch(e){a({title:`Error`,message:e.message||`Failed to activate subscription.`,variant:`error`})}else a({title:`Payment Failed`,message:`Your payment was not successful. Please try again.`,variant:`error`});_.value=!1},onclose:function(){_.value=!1}})}catch(e){a({title:`Subscription Error`,message:e.message||`Failed to initiate subscription.`,variant:`error`}),_.value=!1}}function P(){return new Promise((e,t)=>{if(window.FlutterwaveCheckout){e();return}let n=document.createElement(`script`);n.src=`https://checkout.flutterwave.com/v3.js`,n.onload=e,n.onerror=t,document.head.appendChild(n)})}async function F(){_.value=!0;try{await k.cancelSubscription(),a({title:`Cancelled`,message:`Subscription cancelled successfully.`,variant:`success`}),y.value=null,await M(),A.value=!1}catch(e){a({title:`Error`,message:e.message||`Failed to cancel subscription.`,variant:`error`})}finally{_.value=!1}}function I(e){return Number(e).toLocaleString(`en-NG`,{minimumFractionDigits:0,maximumFractionDigits:0})}function L(e){if(!y.value)return!1;let t=s.value?e.idYearly:e.idMonthly;return y.value.planId===t||y.value.planName===e.name}return(r,a)=>(v(),t(o,null,[i(`div`,B,[y.value?(v(),l(z,{key:0,subscription:y.value,payments:x.value,plans:j,"is-yearly":s.value,onSubscriptionUpdated:M,onSubscriptionCancelled:M},null,8,[`subscription`,`payments`,`is-yearly`])):(v(),t(`div`,V,[a[5]||=i(`div`,{class:`text-center mb-8`},[i(`h1`,{class:`text-4xl font-bold tracking-tight text-gray-900 dark:text-white mb-4`},` Simple Pricing - Zero Exclusion `),i(`p`,{class:`text-lg text-gray-600 dark:text-gray-400`},[n(` Every plan is premium and gives access to `),i(`strong`,null,`SIMI`),n(` (your consultant). `)])],-1),i(`div`,H,[i(`div`,U,[i(`button`,{onClick:a[0]||=e=>s.value=!1,class:g([`rounded-full px-4 py-0.5 w-fit font-medium transition-all`,s.value?`text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white`:`bg-stone-50 dark:bg-gray-700 shadow-sm text-gray-900 dark:text-white`])},` Monthly `,2),i(`button`,{onClick:a[1]||=e=>s.value=!0,class:g([`rounded-full bg-stone-100 text-blue-950 px-4 py-0.5 w-fit font-medium transition-all`,s.value?`bg-stone-50 dark:bg-gray-700 shadow-sm text-gray-900 dark:text-white`:`text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white`])},[...a[4]||=[n(` Yearly `,-1),i(`span`,{class:`ml-2 text-xs text-green-600 font-bold`},`-17%`,-1)]],2)])]),i(`div`,W,[(v(),t(o,null,h(j,r=>i(`div`,{key:r.name,class:`relative flex flex-col p-8 bg-white dark:bg-gray-800 rounded-sm border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow`},[i(`div`,G,[i(`h3`,K,c(r.name),1),i(`p`,q,c(r.message),1)]),i(`div`,J,[i(`span`,Y,`₦`+c(I(s.value?r.priceYearly:r.priceMonthly)),1),i(`span`,X,`/`+c(s.value?`year`:`month`),1)]),i(`ul`,Z,[(v(!0),t(o,null,h(r.features,n=>(v(),t(`li`,{key:n,class:`flex items-start`},[u(e(d),{class:`h-5 w-5 text-green-500 mr-3 flex-shrink-0`}),i(`span`,Q,c(n),1)]))),128))]),u(O,{onClick:e=>N(r),disabled:_.value||L(r),class:g([`w-full rounded-full font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500`,L(r)?`bg-gray-100 dark:bg-gray-700 text-gray-400 cursor-not-allowed`:`bg-primary-600 hover:bg-primary-700 text-white bg-black dark:bg-white dark:text-black`])},{default:m(()=>[n(c(L(r)?`Current Plan`:`Subscribe`),1)]),_:2},1032,[`onClick`,`disabled`,`class`])])),64))])]))]),u(e(S),{open:A.value,"onUpdate:open":a[3]||=e=>A.value=e},{default:m(()=>[u(e(C),{class:`sm:max-w-md bg-white`},{default:m(()=>[u(e(w),null,{default:m(()=>[u(e(E),null,{default:m(()=>[...a[6]||=[n(`Cancel Subscription`,-1)]]),_:1}),u(e(T),null,{default:m(()=>[...a[7]||=[n(` Are you sure you want to cancel your subscription? You will lose access to premium features at the end of your billing period. `,-1)]]),_:1})]),_:1}),u(e(D),{class:`gap-2 sm:gap-0`},{default:m(()=>[u(O,{variant:`outline`,onClick:a[2]||=e=>A.value=!1},{default:m(()=>[...a[8]||=[n(`Keep Subscription`,-1)]]),_:1}),u(O,{variant:`destructive`,onClick:F,disabled:_.value},{default:m(()=>[n(c(_.value?`Cancelling...`:`Confirm Cancellation`),1)]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`open`])],64))}};export{$ as t};