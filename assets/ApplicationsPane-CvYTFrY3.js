import{$ as e,$n as t,$t as n,Ai as r,Bt as i,C as a,Di as o,Dn as ee,Dt as te,E as ne,En as re,G as ie,Gi as ae,J as oe,Jn as se,K as ce,Ki as le,L as ue,Lt as de,Mn as fe,N as pe,Oi as s,On as me,Pi as c,Pt as he,Q as ge,Qi as l,Qt as _e,S as ve,Sa as u,T as ye,Ta as d,U as be,Wn as xe,Wt as Se,Xn as Ce,Yi as f,Yt as we,Z as Te,an as Ee,at as De,b as Oe,bt as ke,ca as Ae,cn as je,er as Me,et as Ne,fi as Pe,ha as p,hi as m,i as h,ii as Fe,in as g,ir as _,it as v,j as Ie,ji as y,jn as Le,jt as Re,ki as b,li as x,ln as ze,na as Be,o as S,on as Ve,ot as He,pr as Ue,q as We,qi as C,r as Ge,rr as Ke,sa as w,sn as qe,tn as Je,tr as Ye,ut as Xe,wa as T,wi as E,x as Ze,xa as D,xn as O,xt as Qe,y as $e,yi as et,yt as tt,z as nt}from"./index-DUz5oLRf.js";import{t as rt}from"./WorkspaceStore-DloGvRxv.js";const k=[{id:`inventory-group`,name:`Inventory`,type:`group`,icon:`Package`,background:`bg-orange-500`,apps:[]},{id:`sales-group`,name:`Sales`,type:`group`,icon:`TrendingUp`,background:`bg-blue-500`,apps:[]},{id:`purchases-group`,name:`Purchases`,type:`group`,icon:`ShoppingCart`,background:`bg-purple-500`,apps:[]},{id:`finance-group`,name:`Finance`,type:`group`,icon:`Landmark`,background:`bg-green-600`,apps:[]},{id:`files-group`,name:`Files`,type:`group`,icon:`Folder`,background:`bg-yellow-500`,apps:[{id:`recents`,name:`Recents`,icon:`Clock`,doctype:`File`,background:`bg-yellow-400`},{id:`personal`,name:`Personal`,icon:`User`,doctype:`File`,background:`bg-yellow-400`},{id:`organisation`,name:`Organisation`,icon:`Building`,doctype:`File`,background:`bg-yellow-400`},{id:`pinned`,name:`Pinned Files`,icon:`Pin`,doctype:`File`,background:`bg-yellow-400`}]},{id:`settings`,name:`Settings`,type:`app`,icon:`Settings`,route:`/settings`,background:`bg-slate-600`},{id:`people`,name:`People`,type:`app`,icon:`Users`,route:`/team`,background:`bg-indigo-500`},{id:`reports`,name:`Reports`,type:`app`,icon:`BarChart`,route:`/reports`,background:`bg-purple-500`},{id:`developer-group`,name:`Developer`,type:`group`,icon:`Code`,background:`bg-slate-700`,ownerOnly:!0,apps:[]},{id:`help`,name:`Help`,type:`app`,icon:`HelpCircle`,route:`/help`,background:`bg-teal-500`}];var A={getDocTypes:async()=>{try{return(await S.get(`/org/doctypes`,{authorizeRequest:!0,organisationAware:!0}))?.data||[]}catch(e){return console.warn(`Failed to fetch doc types:`,e),[]}},getAllApplications:async()=>{let e=await A.getDocTypes(),t={Stock:`inventory-group`,Inventory:`inventory-group`,Selling:`sales-group`,Billing:`sales-group`,CRM:`sales-group`,Buying:`purchases-group`,Purchases:`purchases-group`,Accounting:`finance-group`,Finance:`finance-group`,System:`developer-group`},n=JSON.parse(JSON.stringify(k));return e.forEach(e=>{if(e.is_child||[`File`,`Brand Settings`,`Application`,`Application Group`,`Doc Event Type`].includes(e.name))return;let r=t[e.module];if(!r)return;let i=n.find(e=>e.id===r);i&&i.apps.push({id:`doctype-${e.name.toLowerCase().replace(/\s+/g,`-`)}`,name:e.name,icon:e.icon||`FileText`,background:e.color||`bg-stone-400`,route:`/app/${encodeURIComponent(e.name)}`,type:`doctype-app`,doctype:e.name})}),n}},it=A,at={key:0,class:`absolute inset-0 z-[100] flex flex-col`},ot={class:`relative z-10 flex flex-col h-full w-full max-w-7xl mx-auto p-4 md:p-8 pointer-events-none`},st={class:`flex justify-center mb-8 mt-4`},ct={class:`relative w-full max-w-md pointer-events-auto`},lt={class:`flex-1 relative overflow-hidden flex flex-col justify-center`},ut={key:0,class:`grid-container h-full`},dt=[`draggable`,`onDragstart`,`onDrop`,`onClick`],ft={key:0,class:`grid grid-cols-2 gap-1 p-1.5 w-full h-full`},pt={class:`text-black text-xs md:text-sm font-medium text-center line-clamp-2 shadow-black drop-shadow-md`},mt={key:1,class:`h-full overflow-y-auto`},ht={class:`grid grid-cols-3 md:grid-cols-6 gap-4 md:gap-8 justify-items-center content-start`},gt=[`onClick`],_t={class:`text-black text-xs md:text-sm font-medium text-center line-clamp-2 shadow-black drop-shadow-md`},vt={key:0,class:`flex justify-center gap-2 mt-4 mb-4 pointer-events-auto`},yt=[`onClick`],bt={key:0,class:`absolute inset-0 z-20 flex items-center justify-center p-4`},xt={class:`bg-stone-100/90 backdrop-blur-md rounded-3xl p-6 w-full max-w-2xl shadow-2xl border-4 border-white/50 relative`},St={class:`text-xl font-semibold text-slate-800 mb-6 mx-2`},Ct={class:`grid grid-cols-3 md:grid-cols-4 gap-6 justify-items-center`},wt=[`onClick`],Tt={class:`text-slate-700 text-xs font-medium text-center line-clamp-2`},Et=3,Dt=5,Ot=24,j={__name:`ApplicationsPane`,props:{isOpen:Boolean},emits:[`close`],setup(h,{emit:S}){let A=h,j=S,M=Ge(),kt=rt(),N={Package:ke,Box:t,SlidersHorizontal:ie,Truck:Ie,TrendingUp:pe,Users:a,UserPlus:ne,FileText:Je,FileQuestion:g,Receipt:He,Bookmark:Me,ClipboardList:me,Banknote:_,FileMinus:Ve,RefreshCw:v,CreditCard:O,ShoppingCart:ce,Store:nt,Vault:ve,FileInput:qe,CalendarClock:se,ShoppingBag:We,PackageCheck:Qe,Send:ge,FilePlus:Ee,RefreshCcw:De,Landmark:i,Scale:Ne,Link:he,BookOpen:Ye,Library:de,Folder:_e,FolderOpen:n,Clock:ee,User:ye,Building:Ce,Pin:Xe,Code:re,FileCode:je,Settings:Te,BarChart:xe,HelpCircle:fe,Sparkles:be,Mail:te,AppWindow:Ue,CircleUserRound:Le,History:Se,Zap:$e,Globe:we,Palette:tt,Wallet:Ze,List:Re,Bell:Ke,ShieldCheck:oe,Terminal:ue,FileJson:ze};function At(){try{let e=JSON.parse(localStorage.getItem(`organisation`)||`{}`),t=JSON.parse(localStorage.getItem(`user`)||`{}`);return e.creatorId===t.id||e.creator?.id===t.id}catch{return!1}}function P(e){return e&&(e.startsWith(`#`)||e.startsWith(`rgb`))}function F(e){return!e||P(e)?``:e}function I(e){return!e||!P(e)?{}:{backgroundColor:e}}function L(e){return e.type===`group`?{...e,apps:e.apps.map(e=>({...e}))}:{...e}}function R(e,t){let n=new Map;t.forEach(e=>{n.set(e.id,e)});let r=new Set(e.map(e=>e.id)),i=[];return e.forEach(e=>{let t=n.get(e.id);if(t)if(t.type===`group`&&e.type===`group`){let n=L(t);n.apps=R(e.apps||[],t.apps||[]),i.push(n)}else i.push(L(t))}),t.forEach(e=>{r.has(e.id)||i.push(L(e))}),i}let z=x(`flow-applications-order`,null),B=x(`flow-cached-apps`,[]),V=p(!0),H=p([]);ae(async()=>{B.value&&B.value.length>0&&(z.value&&Array.isArray(z.value)?H.value=R(z.value,B.value):H.value=B.value,V.value=!1);try{let e=await it.getAllApplications();z.value&&Array.isArray(z.value)?H.value=R(z.value,e):H.value=e.map(L),B.value=e}catch(e){console.error(`Failed to load applications:`,e),H.value.length===0&&(H.value=k.map(L))}finally{V.value=!1}}),Pe(H,e=>{z.value=e},{deep:!0,debounce:500});let U=p(``),W=p(0),G=p(null),K=p(null),jt=Et*Dt,q=p(window.innerWidth<768),J=()=>{q.value=window.innerWidth<768};window.addEventListener(`resize`,J),le(()=>{window.removeEventListener(`resize`,J)});let Y=o(()=>q.value?jt:Ot),X=o(()=>{let e=At(),t=t=>t.filter(t=>!t.ownerOnly||e),n=t(H.value).map(e=>e.type===`group`&&e.apps?{...e,apps:t(e.apps)}:e);if(!U.value)return n;let r=U.value.toLowerCase(),i=[],a=e=>!!e.name.toLowerCase().includes(r);return n.forEach(e=>{e.type===`group`?(e.name.toLowerCase().includes(r)&&i.push(e),e.apps.forEach(e=>{a(e)&&i.push(e)})):a(e)&&i.push(e)}),[...new Set(i)]}),Z=o(()=>Math.ceil(X.value.length/Y.value)),Mt=o(()=>{if(U.value)return X.value;let e=W.value*Y.value;return X.value.slice(e,e+Y.value)}),Q=e=>{try{if(e.type===`group`)G.value=e;else if(e.doctype){let t={id:e.id||`doctype-${e.doctype.toLowerCase().replace(/\s+/g,`-`)}`,title:e.name,icon:e.icon,type:`doctype`,doctype:e.doctype,props:e.props||{},closable:!0};kt.openTab(t),j(`close`),M.push({path:`/workspace`,hash:`#${t.id}`})}else j(`close`),M.push(e.route)}catch(e){console.error(`Failed to open app:`,e)}},$=()=>{G.value=null},Nt=(e,t)=>{U.value||(K.value=t,e.dataTransfer.effectAllowed=`move`)},Pt=e=>{U.value||(e.preventDefault(),e.dataTransfer.dropEffect=`move`)},Ft=(e,t)=>{if(!U.value){if(e.preventDefault(),K.value&&K.value.id!==t.id){let e=H.value.findIndex(e=>e.id===K.value.id),n=H.value.findIndex(e=>e.id===t.id);if(e!==-1&&n!==-1){let[t]=H.value.splice(e,1);H.value.splice(n,0,t)}}K.value=null}};return Be(()=>A.isOpen,e=>{e||setTimeout(()=>{U.value=``,W.value=0,G.value=null},300)}),Fe(`Escape`,()=>{A.isOpen&&j(`close`)}),(t,n)=>h.isOpen?(C(),y(`div`,at,[s(`div`,{class:`absolute inset-0 bg-white/40 backdrop-blur-xl`,onClick:n[0]||=e=>t.$emit(`close`)}),s(`div`,ot,[s(`div`,st,[s(`div`,ct,[c(D(e),{class:`absolute left-3 top-1/2 -translate-y-1/2 text-black/60 h-5 w-5`}),Ae(s(`input`,{"onUpdate:modelValue":n[1]||=e=>U.value=e,type:`text`,placeholder:`Type to search...`,class:`w-full bg-white/10 border-4 border-stone-50 rounded-full py-3 pl-10 pr-4 text-black placeholder-black/50 focus:outline-none focus:bg-white/20 focus:border-stone-100/80 transition-all`},null,512),[[et,U.value]])])]),s(`div`,lt,[U.value?(C(),y(`div`,mt,[s(`div`,ht,[(C(!0),y(E,null,f(X.value,e=>(C(),y(`div`,{key:e.id,class:`flex flex-col items-center gap-2 group cursor-pointer w-20 md:w-24 pointer-events-auto`,onClick:t=>Q(e)},[s(`div`,{class:u([`w-14 h-14 md:w-16 md:h-16 rounded-2xl flex items-center justify-center shadow-lg transition-transform group-hover:scale-110 duration-200`,F(e.background)]),style:T(I(e.background))},[(C(),b(l(N[e.icon]),{class:`text-white h-7 w-7 md:h-8 md:w-8`}))],6),s(`span`,_t,d(e.name),1)],8,gt))),128))])])):(C(),y(`div`,ut,[c(m,{name:`slide-fade`,mode:`out-in`},{default:w(()=>[(C(),y(`div`,{key:W.value,class:`grid grid-cols-3 md:grid-cols-6 gap-4 md:gap-8 justify-items-center content-start md:content-center h-full`},[(C(!0),y(E,null,f(Mt.value,e=>(C(),y(`div`,{key:e.id,class:`flex flex-col items-center gap-2 group cursor-pointer w-20 md:w-24 pointer-events-auto`,draggable:!U.value,onDragstart:t=>Nt(t,e),onDragover:Pt,onDrop:t=>Ft(t,e),onClick:t=>Q(e)},[s(`div`,{class:u([`w-14 h-14 md:w-16 md:h-16 rounded-2xl flex items-center justify-center shadow-lg transition-transform group-hover:scale-110 duration-200 overflow-hidden`,e.type===`group`?`bg-white/20 backdrop-blur-md border border-white/10`:F(e.background)]),style:T(e.type===`group`?{}:I(e.background))},[e.type===`group`?(C(),y(`div`,ft,[(C(!0),y(E,null,f(e.apps.slice(0,4),e=>(C(),y(`div`,{key:e.id,class:u([`rounded-md flex items-center justify-center`,F(e.background)]),style:T(I(e.background))},[(C(),b(l(N[e.icon]),{class:`text-white h-3 w-3 md:h-3.5 md:w-3.5`}))],6))),128))])):(C(),b(l(N[e.icon]),{key:1,class:`text-white h-7 w-7 md:h-8 md:w-8`}))],6),s(`span`,pt,d(e.name),1)],40,dt))),128))]))]),_:1})]))]),!U.value&&Z.value>1?(C(),y(`div`,vt,[(C(!0),y(E,null,f(Z.value,e=>(C(),y(`button`,{key:e,onClick:t=>W.value=e-1,class:u([`w-2 h-2 rounded-full transition-all duration-300`,W.value===e-1?`bg-white w-4`:`bg-white/30 hover:bg-white/50`])},null,10,yt))),128))])):r(``,!0)]),c(m,{name:`folder-zoom`},{default:w(()=>[G.value?(C(),y(`div`,bt,[s(`div`,{class:`absolute inset-0 bg-white/50`,onClick:$}),s(`div`,xt,[s(`button`,{onClick:$,class:`absolute top-4 right-4 p-1 rounded-full hover:bg-black/10 transition-colors`},[c(D(Oe),{class:`h-5 w-5 text-slate-600`})]),s(`h3`,St,d(G.value.name),1),s(`div`,Ct,[(C(!0),y(E,null,f(G.value.apps,e=>(C(),y(`div`,{key:e.id,class:`flex flex-col items-center gap-2 group cursor-pointer w-20`,onClick:t=>Q(e)},[s(`div`,{class:u([`w-14 h-14 rounded-2xl flex items-center justify-center shadow-md transition-transform group-hover:scale-110 duration-200`,F(e.background)]),style:T(I(e.background))},[(C(),b(l(N[e.icon]),{class:`text-white h-7 w-7`}))],6),s(`span`,Tt,d(e.name),1)],8,wt))),128))])])])):r(``,!0)]),_:1})])):r(``,!0)}},M=h(j,[[`__scopeId`,`data-v-b7c09bc3`]]);export{M as default};