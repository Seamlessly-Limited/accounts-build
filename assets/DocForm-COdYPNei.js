import{a as e,i as t,n,o as r,r as i}from"./sheet-NRY9vGcQ.js";import{t as a}from"./SelectGroup-DgFFtqHX.js";import{$i as o,Ci as s,Ea as c,Fi as l,Fn as ee,Gn as u,I as te,Li as d,Lt as f,Mi as p,Ni as m,Nt as ne,Oi as h,Pi as g,Ri as _,Si as v,Ta as y,Wn as re,Xi as ie,Yi as ae,Zi as b,ar as x,da as S,dt as C,fa as w,fr as T,g as oe,i as E,ji as D,ka as O,l as se,n as ce,na as le,o as k,oa as A,ot as ue,r as de,u as fe,x as pe,xi as me,ya as j,zi as he}from"./index-CHNvwQRL.js";import{t as ge}from"./WorkspaceStore-Djee2ZJb.js";import{t as M}from"./Input-i1kcrjFD.js";import{t as _e}from"./DynamicIcon-xdE1DWwJ.js";import{t as ve}from"./viewRegistry-CEBXSj_v.js";import{t as ye}from"./LinkField-rhGWIhbd.js";import{n as N,t as be}from"./purify.es-CrZVVHqb.js";import{a as xe,i as Se,n as Ce,r as we,t as Te}from"./SelectValue-DyPaSYfc.js";var P={class:`border border-gray-200 rounded-lg overflow-hidden`},F={class:`px-4 py-3 bg-gray-50 border-b border-gray-200 flex justify-between items-center`},I={class:`font-medium text-gray-900 text-sm`},L={key:0,class:`p-6 text-center text-gray-500 text-sm`},R={key:1,class:`p-6 text-center text-gray-400 text-sm`},z={key:2,class:`overflow-x-auto`},B={class:`w-full text-sm`},V={class:`bg-gray-50 text-gray-600 text-left`},H={class:`divide-y divide-gray-100`},U={class:`px-3 py-2 text-gray-400`},W=[`onUpdate:modelValue`,`placeholder`],G=[`onUpdate:modelValue`,`placeholder`],K=[`onUpdate:modelValue`],q=[`value`],J=[`checked`,`onChange`],Y={key:5,class:`text-gray-400`},Ee={class:`px-3 py-2`},De=[`onClick`],Oe={__name:`ChildTableEditor`,props:{fieldname:{type:String,required:!0},options:{type:String,required:!0},label:{type:String,default:`Items`},modelValue:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:[`update:modelValue`],setup(e,{emit:t}){let n=e,r=t,i=j(!1),a=j([]),c=j([]),ee=0,u=()=>`new-${++ee}`,f=D(()=>a.value.filter(e=>![`parent`,`parenttype`,`parentfield`,`idx`,`name`,`owner`,`docstatus`].includes(e.fieldname)&&!e.hidden&&![`SECTION_BREAK`,`COLUMN_BREAK`,`TAB_BREAK`].includes(e.fieldtype))),g=e=>[`DATA`,`TEXT`,`SMALL_TEXT`].includes(e.fieldtype),re=e=>[`INT`,`FLOAT`,`CURRENCY`,`PERCENT`].includes(e.fieldtype),ie=e=>e.options?e.options.split(`
`).map(e=>e.trim()).filter(Boolean):[];function x(){let e={_id:u()};for(let t of f.value)t.default_value!==void 0&&t.default_value!==null&&(e[t.fieldname]=t.default_value);c.value.push(e),T()}function S(e){c.value.splice(e,1),T()}function T(){let e=c.value.map(e=>{let{_id:t,...n}=e;return n});r(`update:modelValue`,e)}A(()=>n.modelValue,e=>{Array.isArray(e)&&(c.value=e.map((e,t)=>({...e,_id:e.name||`existing-${t}`})))},{immediate:!0,deep:!0}),A(c,()=>{T()},{deep:!0});async function oe(){if(n.options){i.value=!0;try{a.value=(await k.get(`/org/doctypes/${encodeURIComponent(n.options)}`)).data?.fields||[]}catch(e){console.error(`Failed to load child schema:`,e)}finally{i.value=!1}}}return ae(()=>{oe()}),(t,n)=>(b(),l(`div`,P,[p(`div`,F,[p(`h4`,I,O(e.label),1),p(`button`,{onClick:x,type:`button`,class:`text-sm text-blue-600 font-medium hover:text-blue-700 flex items-center gap-1`},[_(y(C),{class:`w-4 h-4`}),n[0]||=d(` Add Row `,-1)])]),i.value?(b(),l(`div`,L,[_(y(ne),{class:`w-5 h-5 animate-spin mx-auto mb-2`}),n[1]||=d(` Loading schema... `,-1)])):c.value.length?(b(),l(`div`,z,[p(`table`,B,[p(`thead`,V,[p(`tr`,null,[n[2]||=p(`th`,{class:`px-3 py-2 font-medium w-10`},`#`,-1),(b(!0),l(h,null,o(f.value,e=>(b(),l(`th`,{key:e.fieldname,class:`px-3 py-2 font-medium`},O(e.label),1))),128)),n[3]||=p(`th`,{class:`px-3 py-2 w-10`},null,-1)])]),p(`tbody`,H,[(b(!0),l(h,null,o(c.value,(e,t)=>(b(),l(`tr`,{key:e._id||t,class:`hover:bg-gray-50`},[p(`td`,U,O(t+1),1),(b(!0),l(h,null,o(f.value,t=>(b(),l(`td`,{key:t.fieldname,class:`px-3 py-2`},[g(t)?w((b(),l(`input`,{key:0,type:`text`,"onUpdate:modelValue":n=>e[t.fieldname]=n,placeholder:t.label,class:`w-full px-2 py-1 border border-gray-200 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500`},null,8,W)),[[s,e[t.fieldname]]]):re(t)?w((b(),l(`input`,{key:1,type:`number`,"onUpdate:modelValue":n=>e[t.fieldname]=n,placeholder:t.label,class:`w-full px-2 py-1 border border-gray-200 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500`},null,8,G)),[[s,e[t.fieldname],void 0,{number:!0}]]):t.fieldtype===`SELECT`?w((b(),l(`select`,{key:2,"onUpdate:modelValue":n=>e[t.fieldname]=n,class:`w-full px-2 py-1 border border-gray-200 rounded text-sm focus:ring-1 focus:ring-blue-500 focus:border-blue-500`},[n[4]||=p(`option`,{value:``},`Select...`,-1),(b(!0),l(h,null,o(ie(t),e=>(b(),l(`option`,{key:e,value:e},O(e),9,q))),128))],8,K)),[[v,e[t.fieldname]]]):t.fieldtype===`CHECK`?(b(),l(`input`,{key:3,type:`checkbox`,checked:e[t.fieldname],onChange:n=>e[t.fieldname]=n.target.checked,class:`w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500`},null,40,J)):t.fieldtype===`LINK`?(b(),m(ye,{key:4,modelValue:e[t.fieldname],"onUpdate:modelValue":n=>e[t.fieldname]=n,options:t.options,placeholder:t.label,compact:``},null,8,[`modelValue`,`onUpdate:modelValue`,`options`,`placeholder`])):(b(),l(`span`,Y,O(e[t.fieldname]||`-`),1))]))),128)),p(`td`,Ee,[p(`button`,{onClick:e=>S(t),type:`button`,class:`text-gray-400 hover:text-red-500 transition-colors`},[_(y(te),{class:`w-4 h-4`})],8,De)])]))),128))])])])):(b(),l(`div`,R,` No items. Click "Add Row" to add one. `))]))}},ke=[`innerHTML`],X={__name:`DocumentationSheet`,props:{open:{type:Boolean,default:!1},title:{type:String,default:`Documentation`},content:{type:String,default:``}},emits:[`update:open`],setup(a,{emit:o}){let s=a,c=o,l=D(()=>{if(!s.content)return`<p class="text-gray-400 italic">No documentation available.</p>`;let e=N.parse(s.content);return be.sanitize(e)});return(o,s)=>(b(),m(y(r),{open:a.open,"onUpdate:open":s[0]||=e=>c(`update:open`,e)},{default:S(()=>[_(y(e),{side:`right`,class:`w-[400px] sm:w-[540px] overflow-y-auto`},{default:S(()=>[_(y(i),null,{default:S(()=>[_(y(n),{class:`flex items-center gap-2`},{default:S(()=>[_(y(x),{class:`w-5 h-5`}),d(` `+O(a.title),1)]),_:1}),_(y(t),null,{default:S(()=>[...s[1]||=[d(` Reference documentation for this document type. `,-1)]]),_:1})]),_:1}),p(`div`,{class:`mt-6 prose prose-sm max-w-none`,innerHTML:l.value},null,8,ke)]),_:1})]),_:1},8,[`open`]))}},Ae=E(X,[[`__scopeId`,`data-v-ac8cb5c0`]]),je={key:1,class:`h-full flex flex-col bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] to-slate-100/50 from-stone-100/60 from-5%`},Me={class:`flex-none px-6 py-4 bg-white border-b border-gray-200 flex items-center justify-between sticky top-0 z-10`},Ne={class:`flex items-center space-x-4`},Pe={class:`flex items-center gap-2`},Fe={class:`text-sm font-medium text-gray-500 uppercase tracking-wider`},Ie={class:`text-xl font-bold text-gray-900 mt-1`},Le={class:`flex items-center space-x-3`},Re={key:0,class:`absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-20`},ze=[`disabled`],Be=[`disabled`],Ve={key:3,class:`border-t border-gray-100 my-1`},He=[`disabled`],Ue=[`disabled`],We=[`disabled`],Ge={class:`flex items-center gap-3`},Ke={key:0,class:`flex items-center gap-2`},qe=[`disabled`],Je=[`disabled`],Ye={key:1,class:`fixed inset-0 bg-black/50 flex items-center justify-center z-50`},Xe={class:`bg-white rounded-xl shadow-xl w-full max-w-md p-6 m-4`},Ze={class:`flex justify-end gap-2 mt-4`},Qe=[`disabled`],$e={class:`flex-1 overflow-auto p-6`},et={key:0,class:`flex justify-center items-center h-64`},tt={key:1,class:`max-w-5xl mx-auto space-y-6`},nt={class:`rounded-sm p-6 pt-8`},rt={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},it={class:`block text-sm font-medium text-gray-700`},at={key:0,class:`text-red-500`},ot={key:0},st={key:1},ct={key:2},lt={key:3},ut={key:4},dt=[`onUpdate:modelValue`,`placeholder`,`disabled`],ft={key:5},pt={class:`flex items-center space-x-2 cursor-pointer mt-1`},mt=[`onUpdate:modelValue`,`disabled`],ht={class:`text-sm text-gray-600`},gt={key:6},_t={key:7},vt={class:`flex items-center gap-2`},yt=[`onUpdate:modelValue`,`disabled`],bt=[`onUpdate:modelValue`,`disabled`],xt={key:8},St={class:`flex items-center gap-2`},Ct={class:`h-10 w-10 flex items-center justify-center rounded border border-gray-300 bg-gray-50`},wt=[`onUpdate:modelValue`,`disabled`,`placeholder`],Tt={key:9,class:`p-2 bg-gray-50 border border-gray-100 rounded text-sm text-gray-600`},Et={key:10,class:`p-2 bg-gray-50 border border-gray-200 rounded text-xs text-gray-500`},Dt={key:11,class:`text-[11px] text-gray-400 mt-1 italic px-1`},Ot={__name:`DocForm`,props:{doctype:{type:String,default:null},name:{type:String,default:null},isNew:{type:Boolean,default:void 0},isEmbedded:{type:Boolean,default:!1}},emits:[`saved`],setup(e,{emit:t}){let{toast:n}=oe(),r=ge(),i=e,v=ce(),x=de(),C=D(()=>i.doctype||v.params.doctype),E=D(()=>i.name||v.params.name),N=D(()=>i.isNew===void 0?E.value===`new`:i.isNew),be=D(()=>{if(!C.value)return null;let e=ve(C.value,`form`);return e?he(e):null}),P=j({}),F=j({}),I=j(!0),L=j(!1),R=j(!1),z=j(!1),B=j(!1),V=j(!1),H=j(!1),U=j(null),W=j(!1),G=j(null),K=j(!1),q=j(!1),J=j(!1),Y=j(``),Ee=new Set([`DATA`,`CURRENCY`,`FLOAT`,`INT`,`PERCENT`,`PHONE`,`EMAIL`,`PASSWORD`,`ATTACH`,`ATTACH_IMAGE`,`URL`]),De=new Set([`CURRENCY`,`FLOAT`,`PERCENT`]),ke=new Set([`TABLE`,`SECTION_BREAK`,`COLUMN_BREAK`]),X=D(()=>(P.value.fields||[]).map(e=>({...e,_isDataType:Ee.has(e.fieldtype),_isNumericType:De.has(e.fieldtype),_inputType:Mt(e.fieldtype),_parsedOptions:e.options?e.options.split(`
`):[],_step:De.has(e.fieldtype)?`0.01`:`1`,_placeholder:e.placeholder||`Select ${e.label}...`}))),Ot=D(()=>X.value.filter(e=>!ke.has(e.fieldtype)&&!e.hidden)),kt=D(()=>X.value.filter(e=>e.fieldtype===`TABLE`&&!e.hidden)),At=D(()=>{let e=new Map;for(let t of X.value)e.set(t.fieldname,t);return e}),jt=D(()=>{let e=new Set,t=F.value.docstatus||0;for(let n of X.value)(n.read_only||t>0&&!n.allow_on_submit)&&e.add(n.fieldname);return e}),Z=e=>jt.value.has(e.fieldname),Mt=e=>e===`INT`||e===`FLOAT`||e===`CURRENCY`?`number`:e===`DATE`?`date`:e===`PASSWORD`?`password`:`text`,Nt=e=>({Draft:`bg-gray-100 text-gray-800`,Submitted:`bg-blue-100 text-blue-800`,Paid:`bg-green-100 text-green-800`})[e]||`bg-gray-100 text-gray-800`,Q=async()=>{I.value=!0;try{if(P.value=(await k.get(`/org/doctypes/${C.value}`,{authorizeRequest:!0,organisationAware:!0})).data||{},N.value){let e={};P.value.fields&&P.value.fields.forEach(t=>{t.default_value&&(e[t.fieldname]=t.default_value)}),F.value=e}else{if(!E.value){console.warn(`Cannot fetch document: docName is undefined`);return}F.value=(await k.get(`/org/doc/${C.value}/${E.value}`,{authorizeRequest:!0,organisationAware:!0})).data||{}}}catch(e){console.error(e);let t=e.response?.data?.message||e.message;n({title:`Failed to load`,description:t,variant:`destructive`}),F.value||={}}finally{I.value=!1}N.value||Pt()};async function Pt(){if(!(N.value||!C.value||!E.value))try{let e=(await k.get(`/org/doc/Approval Pipeline`,{params:{filters:JSON.stringify({target_doctype:C.value,target_document:E.value,status:`Pending`}),limit:1}})).data?.data||[];if(e.length>0){let t=e[0],n=(t.items||[]).find(e=>e.status===`Pending`);G.value=n?{...n,pipeline_name:t.name,target_doctype:t.target_doctype,target_document:t.target_document}:null}else G.value=null}catch(e){console.error(`Failed to fetch pending approval:`,e)}}let $=D(()=>{if(!G.value)return!1;let e=fe();return G.value.assigned_to===e.email});async function Ft(){if(!(!G.value||K.value)){K.value=!0;try{await k.patch(`/org/doc/Approval Pipeline/${G.value.pipeline_name}`,{data:{items:[{name:G.value.name,status:`Approved`,approver:Vt.email,decision_time:new Date().toISOString()}]}}),n({title:`Approved`,description:`Document has been approved successfully.`,variant:`success`}),G.value=null,await Q()}catch(e){console.error(`Failed to approve:`,e),n({title:`Approval Failed`,description:e.response?.data?.message||e.message,variant:`destructive`})}finally{K.value=!1}}}async function It(){if(!(!G.value||q.value)){q.value=!0;try{await k.patch(`/org/doc/Approval Pipeline/${G.value.pipeline_name}`,{data:{items:[{name:G.value.name,status:`Rejected`,approver:Vt.email,comments:Y.value,decision_time:new Date().toISOString()}]}}),n({title:`Rejected`,description:`Document has been rejected.`,variant:`success`}),G.value=null,J.value=!1,Y.value=``,await Q()}catch(e){console.error(`Failed to reject:`,e),n({title:`Rejection Failed`,description:e.response?.data?.message||e.message,variant:`destructive`})}finally{q.value=!1}}}let Lt=j(null);function Rt(){!N.value||!C.value||(Lt.value&&clearTimeout(Lt.value),Lt.value=setTimeout(()=>{r.saveFormData(C.value,F.value,!0,null)},500))}A(F,()=>{Rt()},{deep:!0});let zt=t,Bt=async()=>{L.value=!0;try{let e,t={data:F.value,authorizeRequest:!0,organisationAware:!0};e=N.value?await k.post(`/org/doc/${C.value}`,t):await k.patch(`/org/doc/${C.value}/${E.value}`,t);let a=e?.data;if(!a)throw Error(`Server returned empty data`);F.value=a,zt(`saved`,a),n({title:N.value?`Created`:`Saved`,description:`${P.value.name} has been ${N.value?`created`:`saved`} successfully.`,variant:`success`}),C.value&&r.clearFormData(C.value,N.value,N.value?null:E.value),r.notifyDocSaved(C.value,a.name),N.value&&!i.name&&!i.isEmbedded&&x.replace(`/app/${C.value}/${a.name}`)}catch(e){console.error(e);let t=e.response?.data?.message||e.message;n({title:`Error saving`,description:t,variant:`destructive`})}finally{L.value=!1}};A(()=>v.params.name,Q),A(E,(e,t)=>{e&&e!==t&&Q()}),ae(()=>{if(N.value&&C.value){let e=r.getFormData(C.value,!0,null);e&&e.data&&(F.value={...e.data})}Q()});let Vt=se(),Ht=D(()=>{if(!P.value.is_submittable||F.value.docstatus!==0)return!1;let e=P.value.config?.workflow;return e?!(e.submit_roles&&e.submit_roles.length>0&&(!Vt.role||!e.submit_roles.includes(Vt.role))):!0}),Ut=async()=>{z.value=!0,R.value=!1;try{let e=(await k.patch(`/org/doc/${C.value}/${E.value}`,{data:{docstatus:1},authorizeRequest:!0,organisationAware:!0})).data?.data||{};F.value=e,zt(`saved`,e),n({title:`Submitted`,description:`Document has been submitted successfully.`,variant:`success`})}catch(e){console.error(e);let t=e.response?.data?.message||e.message;n({title:`Result`,description:t,variant:t.includes(`submitted`)?`success`:`destructive`})}finally{z.value=!1}},Wt=async()=>{try{let e=crypto.randomUUID();await k.post(`/org/doc/Public Document Access`,{data:{doctype:C.value,doc_name:E.value,token:e,access_type:`View`,max_views:0},authorizeRequest:!0,organisationAware:!0});let t=`${window.location.origin}/public/d/${e}`;navigator.clipboard.writeText(t),n({title:`Link Copied`,description:`Public link has been copied to clipboard.`,variant:`success`}),R.value=!1}catch(e){console.error(e),n({title:`Failed`,description:e.message,variant:`destructive`})}},Gt=async()=>{if(confirm(`Are you sure you want to cancel this document?`)){B.value=!0,R.value=!1;try{let e=(await k.patch(`/org/doc/${C.value}/${E.value}`,{data:{docstatus:2},authorizeRequest:!0,organisationAware:!0})).data?.data||{};F.value=e,zt(`saved`,e),n({title:`Cancelled`,description:`Document has been cancelled.`,variant:`default`})}catch(e){console.error(e);let t=e.response?.data?.message||e.message;n({title:`Error cancelling`,description:t,variant:`destructive`})}finally{B.value=!1}}},Kt=async()=>{if(confirm(`Are you sure you want to delete this document? This cannot be undone.`)){V.value=!0,R.value=!1;try{await k.delete(`/org/doc/${C.value}/${E.value}`,{authorizeRequest:!0,organisationAware:!0}),n({title:`Deleted`,description:`Document has been deleted.`,variant:`default`}),x.back()}catch(e){console.error(e);let t=e.response?.data?.message||e.message;n({title:`Error deleting`,description:t,variant:`destructive`})}finally{V.value=!1}}},qt=async()=>{H.value=!0;try{F.value.status=`Queued`,F.value.error_log=``,await k.patch(`/org/doc/Notification/${E.value}`,{data:{status:`Queued`,error_log:``},authorizeRequest:!0,organisationAware:!0}),n({title:`Retry Queued`,description:`Notification has been queued for retry.`,variant:`default`})}catch(e){console.error(e),n({title:`Retry Failed`,description:e.response?.data?.message||e.message,variant:`destructive`})}finally{H.value=!1}},Jt=e=>{U.value&&!U.value.contains(e.target)&&(R.value=!1)};return ae(()=>document.addEventListener(`click`,Jt)),ie(()=>document.removeEventListener(`click`,Jt)),(t,n)=>(b(),l(h,null,[be.value?(b(),m(le(be.value),{key:0,doctype:C.value,name:E.value,isNew:N.value},null,8,[`doctype`,`name`,`isNew`])):(b(),l(`div`,je,[p(`header`,Me,[p(`div`,Ne,[e.isEmbedded?g(``,!0):(b(),l(`button`,{key:0,onClick:n[0]||=e=>t.$router.back(),class:`p-2 hover:bg-gray-100 rounded-full text-gray-500`},[_(y(T),{class:`w-5 h-5`})])),p(`div`,{class:c({"pl-0":e.isEmbedded})},[p(`div`,Pe,[p(`span`,Fe,O(P.value.name),1),F.value.status?(b(),l(`span`,{key:0,class:c([`px-2 py-0.5 rounded text-xs font-bold`,Nt(F.value.status)])},O(F.value.status),3)):g(``,!0)]),p(`h1`,Ie,O(N.value?`New `+P.value.name:F.value[P.value.title_field]||F.value.name),1)],2)]),p(`div`,Le,[P.value.documentation?(b(),l(`button`,{key:0,onClick:n[1]||=e=>W.value=!0,class:`p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors`,title:`View Documentation`},[_(y(ee),{class:`w-5 h-5`})])):g(``,!0),N.value?g(``,!0):(b(),l(`div`,{key:1,class:`relative`,ref_key:`actionsDropdownRef`,ref:U},[p(`button`,{onClick:n[2]||=e=>R.value=!R.value,class:`px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-full text-sm font-medium transition-colors flex items-center gap-1`},[n[7]||=d(` Actions `,-1),_(y(re),{class:`w-4 h-4`})]),R.value?(b(),l(`div`,Re,[Ht.value?(b(),l(`button`,{key:0,onClick:Ut,disabled:z.value,class:`w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50 flex items-center gap-2`},[_(y(u),{class:`w-4 h-4`}),n[8]||=d(` Submit `,-1)],8,ze)):g(``,!0),P.value.is_submittable&&F.value.docstatus===1?(b(),l(`button`,{key:1,onClick:Gt,disabled:B.value,class:`w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50 flex items-center gap-2`},[_(y(pe),{class:`w-4 h-4`}),n[9]||=d(` Cancel `,-1)],8,Be)):g(``,!0),N.value?g(``,!0):(b(),l(`button`,{key:2,onClick:Wt,class:`w-full text-left px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 flex items-center gap-2`},[_(y(f),{class:`w-4 h-4`}),n[10]||=d(` Get Public Link `,-1)])),P.value.is_submittable&&(F.value.docstatus===0||F.value.docstatus===1)?(b(),l(`div`,Ve)):g(``,!0),p(`button`,{onClick:Kt,disabled:V.value,class:`w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2`},[_(y(te),{class:`w-4 h-4`}),n[11]||=d(` Delete `,-1)],8,He)])):g(``,!0)],512)),C.value===`Notification`&&F.value.status===`Failed`?(b(),l(`button`,{key:2,onClick:qt,disabled:H.value,class:`px-5 py-2 bg-amber-500 text-white rounded-full text-sm font-medium hover:bg-amber-600 transition-colors flex items-center gap-2 shadow-sm`},[H.value?(b(),m(y(ne),{key:1,class:`w-4 h-4 animate-spin`})):(b(),m(y(ue),{key:0,class:`w-4 h-4`})),n[12]||=d(` Retry `,-1)],8,Ue)):g(``,!0),p(`button`,{onClick:Bt,disabled:L.value,class:`px-6 py-2 bg-black text-white rounded-full text-sm font-medium hover:bg-gray-900 transition-colors flex items-center gap-2 shadow-sm`},[L.value?(b(),m(y(ne),{key:0,class:`w-4 h-4 animate-spin`})):g(``,!0),d(` `+O(N.value?`Create`:`Save`),1)],8,We)])]),G.value?(b(),l(`div`,{key:0,class:c([`mx-6 mt-4 p-4 rounded-xl border flex items-center justify-between gap-4`,$.value?`bg-amber-50 border-amber-200`:`bg-gray-50 border-gray-200`])},[p(`div`,Ge,[p(`div`,{class:c([`w-10 h-10 rounded-full flex items-center justify-center`,$.value?`bg-amber-500`:`bg-gray-400`])},[_(y(u),{class:`w-5 h-5 text-white`})],2),p(`div`,null,[p(`h3`,{class:c([`font-semibold`,$.value?`text-amber-900`:`text-gray-700`])},O($.value?`Approval Required`:`Pending Approval`),3),p(`p`,{class:c([`text-sm`,$.value?`text-amber-700`:`text-gray-500`])},O(G.value.stage_name||`Approval`)+` â€¢ Assigned to `+O(G.value.assigned_to),3)])]),$.value?(b(),l(`div`,Ke,[p(`button`,{onClick:Ft,disabled:K.value,class:`px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-1`},[_(y(u),{class:`w-4 h-4`}),n[13]||=d(` Approve `,-1)],8,qe),p(`button`,{onClick:n[3]||=e=>J.value=!0,disabled:q.value,class:`px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-1`},[_(y(pe),{class:`w-4 h-4`}),n[14]||=d(` Reject `,-1)],8,Je)])):g(``,!0)],2)):g(``,!0),J.value?(b(),l(`div`,Ye,[p(`div`,Xe,[n[15]||=p(`h3`,{class:`text-lg font-semibold text-gray-900 mb-4`},`Reject Document`,-1),w(p(`textarea`,{"onUpdate:modelValue":n[4]||=e=>Y.value=e,rows:`3`,placeholder:`Reason for rejection (optional)`,class:`w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-red-500`},null,512),[[s,Y.value]]),p(`div`,Ze,[p(`button`,{onClick:n[5]||=e=>{J.value=!1,Y.value=``},class:`px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors`},` Cancel `),p(`button`,{onClick:It,disabled:q.value,class:`px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors`},` Reject `,8,Qe)])])])):g(``,!0),p(`div`,$e,[I.value?(b(),l(`div`,et,[...n[16]||=[p(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-black`},null,-1)]])):(b(),l(`div`,tt,[p(`div`,nt,[p(`div`,rt,[(b(!0),l(h,null,o(Ot.value,e=>(b(),l(`div`,{key:e.fieldname,class:c([`space-y-1`,{"col-span-2":e.fieldtype===`TEXT`||e.fieldtype===`LONG_TEXT`||e.fieldtype===`TABLE`||e.fieldtype===`HTML`}])},[p(`label`,it,[d(O(e.label)+` `,1),e.reqd?(b(),l(`span`,at,`*`)):g(``,!0)]),e._isDataType?(b(),l(`div`,ot,[_(M,{class:`bg-white/40`,type:e._inputType,modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,placeholder:e.placeholder,disabled:Z(e),step:e._step},null,8,[`type`,`modelValue`,`onUpdate:modelValue`,`placeholder`,`disabled`,`step`])])):e.fieldtype===`SELECT`?(b(),l(`div`,st,[_(y(xe),{modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:Z(e)},{default:S(()=>[_(y(Ce),{class:`bg-white/40`},{default:S(()=>[_(y(Te),{placeholder:e._placeholder},null,8,[`placeholder`])]),_:2},1024),_(y(Se),null,{default:S(()=>[_(y(a),null,{default:S(()=>[(b(!0),l(h,null,o(e._parsedOptions,e=>(b(),m(y(we),{key:e,value:e},{default:S(()=>[d(O(e),1)]),_:2},1032,[`value`]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,[`modelValue`,`onUpdate:modelValue`,`disabled`])])):e.fieldtype===`DATE`?(b(),l(`div`,ct,[_(M,{class:`bg-white/40`,type:`date`,modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:Z(e)},null,8,[`modelValue`,`onUpdate:modelValue`,`disabled`])])):[`DATETIME`,`TIME`].includes(e.fieldtype)?(b(),l(`div`,lt,[_(M,{class:`bg-white/40`,type:e.fieldtype===`TIME`?`time`:`datetime-local`,modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:Z(e)},null,8,[`type`,`modelValue`,`onUpdate:modelValue`,`disabled`])])):[`TEXT`,`SMALL_TEXT`,`LONG_TEXT`,`HTML`,`JSON`].includes(e.fieldtype)?(b(),l(`div`,ut,[w(p(`textarea`,{class:`flex min-h-[80px] w-full rounded-xl border border-input bg-white/40 px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all focus:ring-black/5`,"onUpdate:modelValue":t=>F.value[e.fieldname]=t,placeholder:e.placeholder,disabled:Z(e),rows:`3`},null,8,dt),[[s,F.value[e.fieldname]]])])):e.fieldtype===`CHECKBOX`?(b(),l(`div`,ft,[p(`label`,pt,[w(p(`input`,{type:`checkbox`,"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:Z(e),class:`w-4 h-4 text-black rounded border-gray-300 focus:ring-black`},null,8,mt),[[me,F.value[e.fieldname]]]),p(`span`,ht,O(e.label),1)])])):e.fieldtype===`LINK`?(b(),l(`div`,gt,[e.meta?.link_doctype_field?(b(),l(h,{key:0},[F.value[e.meta.link_doctype_field]?(b(),m(ye,{modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,doctype:F.value[e.meta.link_doctype_field],label:e.label,placeholder:e._placeholder,disabled:Z(e),key:`${e.fieldname}-${F.value[e.meta.link_doctype_field]}`},null,8,[`modelValue`,`onUpdate:modelValue`,`doctype`,`label`,`placeholder`,`disabled`])):(b(),m(M,{key:1,type:`text`,disabled:``,placeholder:`Select ${At.value.get(e.meta.link_doctype_field)?.label||`DocType`} first...`,class:`w-full bg-gray-100 border border-gray-200 rounded-full text-gray-400 cursor-not-allowed`},null,8,[`placeholder`]))],64)):(b(),m(ye,{key:1,modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,doctype:e.options,label:e.label,placeholder:e._placeholder,disabled:Z(e)},null,8,[`modelValue`,`onUpdate:modelValue`,`doctype`,`label`,`placeholder`,`disabled`]))])):e.fieldtype===`COLOR`?(b(),l(`div`,_t,[p(`div`,vt,[w(p(`input`,{type:`color`,"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:Z(e),class:`h-10 w-10 p-1 rounded border border-gray-300 shadow-sm`},null,8,yt),[[s,F.value[e.fieldname]]]),w(p(`input`,{type:`text`,"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:Z(e),class:`flex-1 px-4 py-2 border border-gray-300 rounded-full focus:ring-2 focus:ring-black outline-none transition-all`},null,8,bt),[[s,F.value[e.fieldname]]])])])):e.fieldtype===`ICON`?(b(),l(`div`,xt,[p(`div`,St,[p(`div`,Ct,[_(_e,{name:F.value[e.fieldname]||`Layers`,class:`size-5 text-gray-600`},null,8,[`name`])]),w(p(`input`,{type:`text`,"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:Z(e),placeholder:e.placeholder||`Enter Lucide icon name (e.g., Bell, FileText)`,class:`flex-1 px-4 py-2 border border-gray-300 rounded-full focus:ring-2 focus:ring-black outline-none transition-all`},null,8,wt),[[s,F.value[e.fieldname]]])])])):e.fieldtype===`READ_ONLY`?(b(),l(`div`,Tt,O(F.value[e.fieldname]||`-`),1)):(b(),l(`div`,Et,` Unsupported field: `+O(e.fieldtype),1)),e.description?(b(),l(`p`,Dt,O(e.description),1)):g(``,!0)],2))),128))])]),(b(!0),l(h,null,o(kt.value,e=>(b(),l(`div`,{key:e.fieldname,class:`bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden p-4`},[_(Oe,{fieldname:e.fieldname,options:e.options,label:e.label,modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:t.isLocked},null,8,[`fieldname`,`options`,`label`,`modelValue`,`onUpdate:modelValue`,`disabled`])]))),128))]))])])),_(Ae,{open:W.value,"onUpdate:open":n[6]||=e=>W.value=e,title:P.value.name,content:P.value.documentation},null,8,[`open`,`title`,`content`])],64))}};export{Ot as t};