import"./useFormControl-DvkL6jNJ.js";import"./ListboxItem-qNA3-DTC.js";import"./nullish-CfjOSA4G.js";import"./CheckboxIndicator-BI1DZyat.js";import"./useArrowNavigation-siWGBYoD.js";import"./ConfigProvider-COTvgjgS.js";import"./useHideOthers-DDpiFsmm.js";import"./useDirection-D13jZBr-.js";import"./PopperAnchor-D24J2rYd.js";import"./useId-Cbz22I98.js";import"./useKbd-BvGB3m10.js";import"./PopperContent-C4v9BcUF.js";import"./useTypeahead-m4pU0-pP.js";import"./Teleport-BgQd8kcT.js";import"./utils-B7nnpTSD.js";import"./utils-DPCF9wwr.js";import"./RovingFocusGroup-C_eVAqgr.js";import"./RovingFocusItem-J1kH07XU.js";import"./VisuallyHiddenInput-Cjn1nZPy.js";import{i as e,n as t,r as n,s as r,t as i}from"./ComboboxItem-DCOWyVRk.js";import"./DropdownMenuTrigger-BeoVkMbF.js";import{Ai as a,An as o,At as s,Di as c,Dn as l,Gi as u,In as d,J as f,Ki as p,M as m,Ni as h,Nn as g,Oi as _,Pi as v,Pn as y,Qi as b,S as x,Sa as S,Si as C,Ta as w,Vn as T,Xn as E,Yi as D,_n as O,a as k,b as A,dr as j,gi as M,ha as N,hi as P,i as F,ji as I,ki as L,ln as R,lr as z,lt as B,na as V,nn as H,o as U,or as W,qi as G,sa as K,sr as q,wi as J,xa as Y,y as ee,zn as X,zt as te}from"./index-DYsAJfvN.js";import{t as ne}from"./Input-CVPFaPt_.js";import{t as Z}from"./button-JGcPCTN0.js";import{i as re,n as Q,r as ie,t as ae}from"./DropdownMenuTrigger-CmnHF1bg.js";import{t as oe}from"./BackgroundAnimation-Y5lauJ0W.js";import{t as se}from"./BankAccountService-BkKCeYBy.js";import{t as ce}from"./Checkbox-Bmkx-qUG.js";var le={class:`flex flex-col items-center`},ue={class:`flex-1 min-w-0`},de={class:`flex items-center justify-between gap-2 mb-1`},fe={class:`font-medium text-slate-800`},pe={class:`text-xs text-slate-400`},me={class:`flex items-center gap-2 mt-2 text-sm text-slate-500`},he={key:0},ge={key:1,class:`text-xs text-slate-400 font-mono`},_e={__name:`FlowEventCard`,props:{event:{type:Object,required:!0},isLast:{type:Boolean,default:!1}},emits:[`click`],setup(e){let t=e,n=c(()=>t.event.eventType===`INCOMING_PAYMENT`),r=c(()=>t.event.eventType===`SETTLEMENT_COMPLETED`),i=c(()=>t.event.eventType===`SETTLEMENT_FAILED`),s=c(()=>t.event.eventType===`SETTLEMENT_INITIATED`),u=c(()=>n.value?j:r.value?g:i.value?o:s.value?l:W),d=c(()=>{switch(t.event.eventType){case`INCOMING_PAYMENT`:return`Payment received`;case`SETTLEMENT_INITIATED`:return`Settlement initiated`;case`SETTLEMENT_COMPLETED`:return`Settled to bank`;case`SETTLEMENT_FAILED`:return`Settlement failed`;default:return t.event.eventType}}),f=c(()=>n.value?`animate-slide-in-left`:`animate-slide-in-right`),p=c(()=>n.value?`bg-emerald-100 text-emerald-600`:r.value?`bg-blue-100 text-blue-600`:i.value?`bg-orange-100 text-orange-600`:(s.value,`bg-slate-100 text-slate-600`)),m=c(()=>n.value?`from-emerald-200 to-transparent`:r.value?`from-blue-200 to-transparent`:`from-slate-200 to-transparent`),h=c(()=>n.value?`text-emerald-600`:r.value?`text-blue-600`:i.value?`text-orange-600`:`text-slate-700`),y=c(()=>{let e=t.event.payload?.amount,n=t.event.payload?.currency||`NGN`;return e?new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:n,minimumFractionDigits:0,maximumFractionDigits:2}).format(e):`—`}),x=c(()=>{if(!t.event.timestamp)return``;let e=new Date(t.event.timestamp),n=new Date-e,r=Math.floor(n/6e4),i=Math.floor(n/36e5),a=Math.floor(n/864e5);return r<1?`Just now`:r<60?`${r}m ago`:i<24?`${i}h ago`:a<7?`${a}d ago`:e.toLocaleDateString(`en-NG`,{day:`numeric`,month:`short`})}),C=e=>e?e.length<=12?e:e.substring(0,6)+`...`+e.substring(e.length-4):``;return(t,n)=>(G(),I(`div`,{class:S([`flow-event-card group relative flex items-start gap-4 p-4 rounded-xl transition-all duration-300 hover:bg-slate-50/50 cursor-pointer`,f.value]),onClick:n[0]||=n=>t.$emit(`click`,e.event)},[_(`div`,le,[_(`div`,{class:S([`w-10 h-10 rounded-full flex items-center justify-center shrink-0 transition-all duration-300`,p.value])},[(G(),L(b(u.value),{class:`w-5 h-5`}))],2),e.isLast?a(``,!0):(G(),I(`div`,{key:0,class:S([`w-0.5 h-full min-h-[40px] mt-2 rounded-full bg-gradient-to-b`,m.value])},null,2))]),_(`div`,ue,[_(`div`,de,[_(`span`,fe,w(d.value),1),_(`span`,pe,w(x.value),1)]),_(`div`,{class:S([`text-lg font-semibold`,h.value])},w(y.value),3),_(`div`,me,[e.event.payload?.payerName||e.event.payload?.bankName?(G(),I(`span`,he,w(e.event.payload?.payerName||e.event.payload?.bankName),1)):a(``,!0),e.event.eventRef?(G(),I(`span`,ge,w(C(e.event.eventRef)),1)):a(``,!0)])]),v(Y(X),{class:`w-4 h-4 text-slate-300 group-hover:text-slate-500 transition-colors shrink-0 mt-1`})],2))}},ve=F(_e,[[`__scopeId`,`data-v-245f882a`]]),ye={class:`flex items-center justify-between mb-3`},be={class:`flex items-center gap-2`},xe={class:`text-xs text-slate-400`},Se={key:0,class:`flex items-center justify-between`},Ce={class:`flex items-center gap-2`},we={key:1,class:`flex items-center justify-between`},Te={class:`flex items-center gap-2`},Ee={class:`text-lg font-semibold text-emerald-600`},De={class:`mt-1 text-xs text-slate-400 font-mono`},Oe={key:1,class:`flex items-center gap-2 pl-4 my-2`},ke=[`onClick`],Ae={class:`flex items-center justify-between`},je={class:`flex items-center gap-2`},Me={class:`text-xs text-slate-600`},Ne={__name:`FlowEventGroup`,props:{group:{type:Object,required:!0}},emits:[`event-click`],setup(e){let t=e,n=c(()=>t.group.payment?.eventType===`VAULT_ACTIVATED`?`ACTIVATED`:t.group.status||`PENDING`),r=c(()=>{switch(n.value){case`COMPLETED`:return`Settled`;case`FAILED`:return`Failed`;case`INITIATED`:return`Settling...`;case`ACTIVATED`:return`Active`;default:return`Pending`}}),i=c(()=>{switch(n.value){case`COMPLETED`:return g;case`FAILED`:return o;case`INITIATED`:return s;case`ACTIVATED`:return f;default:return l}}),u=c(()=>{switch(n.value){case`COMPLETED`:return`bg-blue-50/50 border-blue-200`;case`FAILED`:return`bg-orange-50/50 border-orange-200`;case`ACTIVATED`:return`bg-slate-50/50 border-slate-200`;default:return`bg-slate-50/50 border-slate-200`}}),d=c(()=>{switch(n.value){case`COMPLETED`:return`bg-blue-100 text-blue-600`;case`FAILED`:return`bg-orange-100 text-orange-600`;case`ACTIVATED`:return`bg-blue-100 text-blue-600`;default:return`bg-slate-100 text-slate-500`}}),p=c(()=>{switch(n.value){case`COMPLETED`:return`text-blue-600`;case`FAILED`:return`text-orange-600`;case`ACTIVATED`:return`text-blue-600`;default:return`text-slate-500`}}),m=c(()=>{let e=t.group.payment?.timestamp;return e?new Date(e).toLocaleDateString(`en-NG`,{day:`numeric`,month:`short`,hour:`2-digit`,minute:`2-digit`}):``}),h=c(()=>{let e=t.group.payment;return e?y(e.payload?.amount,e.payload?.currency):`—`}),y=(e,t=`NGN`)=>e?new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:t,minimumFractionDigits:0,maximumFractionDigits:2}).format(e):`—`,x=e=>e?e.length<=12?e:e.substring(0,6)+`...`+e.substring(e.length-4):``,C=e=>e.eventType===`SETTLEMENT_COMPLETED`?g:e.eventType===`SETTLEMENT_FAILED`?o:l,T=e=>e.eventType===`SETTLEMENT_COMPLETED`?`text-blue-500`:e.eventType===`SETTLEMENT_FAILED`?`text-orange-500`:`text-slate-400`,E=e=>e.eventType===`SETTLEMENT_COMPLETED`?`Settled to bank`:e.eventType===`SETTLEMENT_FAILED`?`Settlement failed`:`Settling...`,O=e=>e.eventType===`SETTLEMENT_COMPLETED`?`border-blue-200 bg-blue-50/50`:e.eventType===`SETTLEMENT_FAILED`?`border-orange-200 bg-orange-50/50`:`border-slate-200`,k=e=>e.eventType===`SETTLEMENT_COMPLETED`?`text-blue-600`:e.eventType===`SETTLEMENT_FAILED`?`text-orange-600`:`text-slate-600`;return(t,n)=>(G(),I(`div`,{class:S([`flow-event-group p-4 rounded-xl border`,u.value])},[_(`div`,ye,[_(`div`,be,[_(`div`,{class:S([`w-8 h-8 rounded-full flex items-center justify-center`,d.value])},[(G(),L(b(i.value),{class:`w-4 h-4`}))],2),_(`span`,{class:S([`text-xs font-medium uppercase tracking-wide`,p.value])},w(r.value),3)]),_(`span`,xe,w(m.value),1)]),e.group.payment?(G(),I(`div`,{key:0,class:`p-3 rounded-lg bg-white border cursor-pointer hover:bg-slate-50 transition-colors`,onClick:n[0]||=n=>t.$emit(`event-click`,e.group.payment)},[e.group.payment.eventType===`VAULT_ACTIVATED`?(G(),I(`div`,Se,[_(`div`,Ce,[v(Y(f),{class:`w-4 h-4 text-blue-500`}),n[1]||=_(`span`,{class:`text-sm font-medium text-slate-700`},`Vault Activated`,-1)]),n[2]||=_(`span`,{class:`text-xs text-slate-500`},`System Event`,-1)])):(G(),I(`div`,we,[_(`div`,Te,[v(Y(j),{class:`w-4 h-4 text-emerald-500`}),n[3]||=_(`span`,{class:`text-sm font-medium text-slate-700`},`Payment received`,-1)]),_(`span`,Ee,w(h.value),1)])),_(`div`,De,w(x(e.group.payment?.eventRef)),1)])):a(``,!0),e.group.settlements?.length?(G(),I(`div`,Oe,[n[4]||=_(`div`,{class:`w-0.5 h-4 bg-slate-200`},null,-1),v(Y(q),{class:`w-3 h-3 text-slate-400`})])):a(``,!0),(G(!0),I(J,null,D(e.group.settlements,e=>(G(),I(`div`,{key:e.hash,class:S([`ml-6 p-2 rounded-lg border cursor-pointer hover:bg-slate-50 transition-colors`,O(e)]),onClick:n=>t.$emit(`event-click`,e)},[_(`div`,Ae,[_(`div`,je,[(G(),L(b(C(e)),{class:S([`w-3 h-3`,T(e)])},null,8,[`class`])),_(`span`,Me,w(E(e)),1)]),_(`span`,{class:S([`text-sm font-medium`,k(e)])},w(y(e.payload?.amount,e.payload?.currency)),3)])],10,ke))),128))],2))}},$={async getVaultStatus(){let e=await U.get(`/org/flow-vault`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e},async getTimeline(e=0,t=20){let n=await U.get(`/org/flow-vault/timeline`,{query:{page:e,size:t},authorizeRequest:!0,organisationAware:!0});return n?.data||n},async verifyChain(){let e=await U.get(`/org/flow-vault/verify`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e},async exportJsonl(){let e=await U.get(`/org/flow-vault/export/jsonl`,{responseType:`blob`,authorizeRequest:!0,organisationAware:!0}),t=window.URL.createObjectURL(new Blob([e])),n=document.createElement(`a`);n.href=t,n.setAttribute(`download`,`flowvault-${new Date().toISOString().split(`T`)[0]}.jsonl`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t)},async exportCsv(){let e=await U.get(`/org/flow-vault/export/csv`,{responseType:`blob`,authorizeRequest:!0,organisationAware:!0}),t=window.URL.createObjectURL(new Blob([e])),n=document.createElement(`a`);n.href=t,n.setAttribute(`download`,`flowvault-${new Date().toISOString().split(`T`)[0]}.csv`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t)},async getGroupedTimeline(){let e=await U.get(`/org/flow-vault/timeline/grouped`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e}},Pe={class:`flow-timeline`},Fe={class:`flex items-center justify-between mb-4`},Ie={class:`text-sm text-slate-500`},Le={key:0,class:`flex items-center justify-center py-12`},Re={key:1,class:`text-center py-12`},ze={class:`w-16 h-16 mx-auto mb-4 rounded-full bg-slate-100 flex items-center justify-center`},Be={key:2,class:`space-y-4`},Ve={key:3,class:`space-y-0`},He={__name:`FlowTimeline`,props:{pageSize:{type:Number,default:20}},emits:[`event-click`],setup(e,{expose:t,emit:n}){let r=e,i=n,o=N([]),l=N([]),d=N(!0),f=N(!1),m=N(!1),g=N(0),y=N(null),b=N(!0),x=null,C=c(()=>b.value?l.value.length===0:o.value.length===0),E=async()=>{try{d.value=!0;let e=await $.getTimeline(0,r.pageSize);o.value=e.content||[],m.value=!e.last,g.value=0}catch(e){console.error(`Failed to load timeline:`,e)}finally{d.value=!1}},O=async()=>{try{d.value=!0,l.value=await $.getGroupedTimeline()}catch(e){console.error(`Failed to load grouped timeline:`,e)}finally{d.value=!1}},k=async()=>{if(!(f.value||!m.value||b.value))try{f.value=!0,g.value++;let e=await $.getTimeline(g.value,r.pageSize);o.value.push(...e.content||[]),m.value=!e.last}catch(e){console.error(`Failed to load more events:`,e),g.value--}finally{f.value=!1}},A=()=>{b.value=!b.value,b.value?O():E()},j=e=>{i(`event-click`,e)},P=()=>{y.value&&(x=new IntersectionObserver(e=>{e[0].isIntersecting&&m.value&&!f.value&&!b.value&&k()},{threshold:.1}),x.observe(y.value))};return u(()=>{O(),setTimeout(P,500)}),p(()=>{x&&x.disconnect()}),t({refresh:()=>b.value?O():E()}),(e,t)=>(G(),I(`div`,Pe,[_(`div`,Fe,[_(`span`,Ie,w(b.value?`Grouped by payment`:`All events`),1),_(`button`,{onClick:A,class:S([`text-xs px-3 py-1 rounded-full border transition-colors`,b.value?`bg-blue-50 border-blue-200 text-blue-600`:`bg-slate-50 border-slate-200 text-slate-600`])},[v(Y(te),{class:`w-3 h-3 inline mr-1`}),h(` `+w(b.value?`Show flat`:`Group by payment`),1)],2)]),d.value?(G(),I(`div`,Le,[v(Y(s),{class:`w-6 h-6 animate-spin text-slate-400`})])):C.value?(G(),I(`div`,Re,[_(`div`,ze,[v(Y(z),{class:`w-8 h-8 text-slate-400`})]),t[0]||=_(`h3`,{class:`text-lg font-medium text-slate-700 mb-2`},`No events yet`,-1),t[1]||=_(`p`,{class:`text-sm text-slate-500 max-w-sm mx-auto`},` Incoming payments and settlements will appear here as they flow through your vault. `,-1)])):b.value?(G(),I(`div`,Be,[v(M,{name:`timeline`},{default:K(()=>[(G(!0),I(J,null,D(l.value,e=>(G(),L(Ne,{key:e.payment?.hash||e.settlements?.[0]?.hash,group:e,onEventClick:j},null,8,[`group`]))),128))]),_:1})])):(G(),I(`div`,Ve,[v(M,{name:`timeline`},{default:K(()=>[(G(!0),I(J,null,D(o.value,(e,t)=>(G(),L(ve,{key:e.hash||e.index,event:e,"is-last":t===o.value.length-1,onClick:t=>j(e)},null,8,[`event`,`is-last`,`onClick`]))),128))]),_:1}),m.value?(G(),I(`div`,{key:0,ref_key:`loadMoreTrigger`,ref:y,class:`py-4 flex items-center justify-center`},[f.value?(G(),L(Y(s),{key:1,class:`w-5 h-5 animate-spin text-slate-400`})):(G(),I(`button`,{key:0,onClick:k,class:`text-sm text-slate-500 hover:text-slate-700 flex items-center gap-2`},[v(Y(T),{class:`w-4 h-4`}),t[2]||=h(` Load more `,-1)]))],512)):a(``,!0)]))]))}},Ue=F(He,[[`__scopeId`,`data-v-dea6f07d`]]),We={key:0,class:`flow-event-drawer fixed inset-y-0 right-0 w-full max-w-md bg-white shadow-xl z-50 flex flex-col`},Ge={class:`flex items-center justify-between p-4 border-b`},Ke={class:`text-sm text-slate-500`},qe={key:0,class:`flex-1 overflow-y-auto p-4 space-y-6`},Je={class:`text-2xl font-bold`},Ye={class:`space-y-4`},Xe={class:`text-slate-700`},Ze={key:0},Qe={class:`text-slate-700 font-mono text-sm`},$e={key:1},et={class:`text-slate-700`},tt={key:2},nt={class:`text-slate-700`},rt={key:3},it={class:`text-slate-700`},at={key:4},ot={class:`text-slate-700 font-mono`},st={key:5},ct={class:`text-orange-600`},lt={class:`space-y-3`},ut={class:`text-sm font-medium text-slate-700 flex items-center gap-2`},dt={class:`text-slate-700 font-mono`},ft={class:`text-slate-700 font-mono text-xs break-all bg-slate-50 p-2 rounded`},pt={class:`text-slate-700 font-mono text-xs break-all bg-slate-50 p-2 rounded`},mt={key:0,class:`space-y-3`},ht={class:`text-slate-700 font-mono text-sm`},gt={class:`p-4 border-t bg-slate-50`},_t={class:`flex items-center justify-between text-xs text-slate-500`},vt={class:`flex items-center gap-1 text-emerald-500`},yt={__name:`FlowEventDrawer`,props:{event:{type:Object,default:null},isOpen:{type:Boolean,default:!1}},emits:[`close`],setup(e,{emit:t}){let n=e,r=t,i=()=>r(`close`),o=c(()=>n.event?.eventType===`INCOMING_PAYMENT`),s=c(()=>n.event?.eventType===`SETTLEMENT_COMPLETED`),l=c(()=>{if(!n.event)return``;switch(n.event.eventType){case`INCOMING_PAYMENT`:return`Payment Received`;case`SETTLEMENT_INITIATED`:return`Settlement Initiated`;case`SETTLEMENT_COMPLETED`:return`Settled to Bank`;case`SETTLEMENT_FAILED`:return`Settlement Failed`;default:return n.event.eventType}}),u=c(()=>o.value?`bg-emerald-50 text-emerald-700`:s.value?`bg-blue-50 text-blue-700`:`bg-slate-50 text-slate-700`),d=c(()=>{if(!n.event?.payload?.amount)return`—`;let e=n.event.payload.currency||`NGN`;return new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:e,minimumFractionDigits:0,maximumFractionDigits:2}).format(n.event.payload.amount)}),p=c(()=>n.event?.timestamp?new Date(n.event.timestamp).toLocaleString(`en-NG`,{dateStyle:`full`,timeStyle:`short`}):``);return(t,n)=>(G(),I(J,null,[v(P,{name:`drawer`},{default:K(()=>[e.isOpen?(G(),I(`div`,We,[_(`div`,Ge,[_(`div`,null,[n[0]||=_(`h2`,{class:`text-lg font-semibold text-slate-800`},`Event Details`,-1),_(`p`,Ke,w(l.value),1)]),_(`button`,{onClick:i,class:`p-2 rounded-lg hover:bg-slate-100 transition-colors`},[v(Y(A),{class:`w-5 h-5 text-slate-500`})])]),e.event?(G(),I(`div`,qe,[_(`div`,{class:S([`p-4 rounded-xl`,u.value])},[n[1]||=_(`div`,{class:`text-sm opacity-75 mb-1`},`Amount`,-1),_(`div`,Je,w(d.value),1)],2),_(`div`,Ye,[_(`div`,null,[n[2]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Timestamp`,-1),_(`p`,Xe,w(p.value),1)]),e.event.eventRef?(G(),I(`div`,Ze,[n[3]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Reference`,-1),_(`p`,Qe,w(e.event.eventRef),1)])):a(``,!0),e.event.payload?.payerName?(G(),I(`div`,$e,[n[4]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Payer`,-1),_(`p`,et,w(e.event.payload.payerName),1)])):a(``,!0),e.event.payload?.payerEmail?(G(),I(`div`,tt,[n[5]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Payer Email`,-1),_(`p`,nt,w(e.event.payload.payerEmail),1)])):a(``,!0),e.event.payload?.bankName?(G(),I(`div`,rt,[n[6]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Bank`,-1),_(`p`,it,w(e.event.payload.bankName),1)])):a(``,!0),e.event.payload?.accountNumber?(G(),I(`div`,at,[n[7]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Account`,-1),_(`p`,ot,w(e.event.payload.accountNumber),1)])):a(``,!0),e.event.payload?.failureReason?(G(),I(`div`,st,[n[8]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Failure Reason`,-1),_(`p`,ct,w(e.event.payload.failureReason),1)])):a(``,!0)]),n[15]||=_(`hr`,{class:`border-slate-100`},null,-1),_(`div`,lt,[_(`h3`,ut,[v(Y(f),{class:`w-4 h-4 text-emerald-500`}),n[9]||=h(` Chain Verification `,-1)]),_(`div`,null,[n[10]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Block Index`,-1),_(`p`,dt,w(e.event.index),1)]),_(`div`,null,[n[11]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Block Hash`,-1),_(`p`,ft,w(e.event.hash),1)]),_(`div`,null,[n[12]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Previous Hash`,-1),_(`p`,pt,w(e.event.prevHash||`(genesis block)`),1)])]),e.event.payload?.flwRef?(G(),I(`div`,mt,[n[14]||=_(`h3`,{class:`text-sm font-medium text-slate-700`},`PSP Reference IDs`,-1),_(`div`,null,[n[13]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Flutterwave Ref`,-1),_(`p`,ht,w(e.event.payload.flwRef),1)])])):a(``,!0)])):a(``,!0),_(`div`,gt,[_(`div`,_t,[n[17]||=_(`span`,null,`Cryptographically verified`,-1),_(`div`,vt,[v(Y(y),{class:`w-3.5 h-3.5`}),n[16]||=_(`span`,null,`Chain intact`,-1)])])])])):a(``,!0)]),_:1}),v(P,{name:`fade`},{default:K(()=>[e.isOpen?(G(),I(`div`,{key:0,class:`fixed inset-0 bg-black/20 z-40`,onClick:i})):a(``,!0)]),_:1})],64))}},bt=F(yt,[[`__scopeId`,`data-v-90a5feef`]]),xt={async getSettlementAccounts(){return(await U.get(`/org/settlement-accounts`,{authorizeRequest:!0,organisationAware:!0}))?.data||[]},async getSupportedBanks(){return(await U.get(`/org/settlement-accounts/banks`,{authorizeRequest:!0,organisationAware:!0}))?.data||[]},async validateBankAccount(e,t){let n=await U.post(`/org/settlement-accounts/validate`,{data:{bankCode:e,accountNumber:t},authorizeRequest:!0,organisationAware:!0});return n?.data||n},async createSettlementAccount(e){let t=await U.post(`/org/settlement-accounts`,{data:e,authorizeRequest:!0,organisationAware:!0});return t?.data||t},async setPrimaryAccount(e){let t=await U.patch(`/org/settlement-accounts/${e}`,{data:{primary:!0},authorizeRequest:!0,organisationAware:!0});return t?.data||t},async disableAccount(e){let t=await U.patch(`/org/settlement-accounts/${e}`,{data:{enabled:!1},authorizeRequest:!0,organisationAware:!0});return t?.data||t},async getPrimaryAccount(){return(await U.get(`/org/settlement-accounts/primary`,{authorizeRequest:!0,organisationAware:!0}))?.data||null}},St={class:`flex items-center justify-center min-h-screen p-4`},Ct={class:`p-6 space-y-4`},wt={class:`relative`},Tt={key:0,class:`py-3 text-center text-slate-500`},Et={key:0,class:`py-3 text-center text-slate-500 text-sm`},Dt={key:0,class:`flex items-center gap-2 text-slate-500`},Ot={key:1,class:`p-3 rounded-xl bg-emerald-50 border border-emerald-200`},kt={class:`flex items-center gap-2 text-emerald-700`},At={class:`text-sm font-medium`},jt={key:2,class:`p-3 rounded-xl bg-orange-50 border border-orange-200`},Mt={class:`flex items-center gap-2 text-orange-700`},Nt={class:`text-sm`},Pt={class:`flex items-center gap-2 py-4`},Ft={class:`p-6 border-t rounded-b-2xl flex items-center justify-end gap-3`},It={__name:`SettlementAccountDialog`,props:{isOpen:{type:Boolean,default:!1}},emits:[`close`,`created`],setup(o,{emit:l}){let u=l,f=k(),p=N({accountNumber:``,makePrimary:!0}),m=N([]),g=N(!1),b=N(``),x=N(!1),S=N(null),T=N(null),E=N(!1),O=c(()=>{let e=new Map;for(let t of m.value)e.set(t.name,t);return e}),A=c(()=>b.value?O.value.get(b.value):null),j=c(()=>m.value),M=c(()=>A.value&&p.value.accountNumber.length===10&&S.value&&!x.value),P=async()=>{if(!(g.value||m.value.length>0)){g.value=!0;try{let{data:e}=await se.getBanksByCountry(`NG`);m.value=(e||[]).sort((e,t)=>e.name.localeCompare(t.name))}catch(e){console.error(`Failed to load banks:`,e)}finally{g.value=!1}}},F=e=>{e&&m.value.length===0&&P()},R=e=>{let t=String(e).replace(/\D/g,``).slice(0,10);p.value.accountNumber=t,S.value=null,T.value=null,t.length===10&&A.value&&z()},z=async()=>{if(!(!A.value||p.value.accountNumber.length!==10)){x.value=!0,T.value=null,S.value=null;try{let e=await se.validateAccount(`NG`,A.value.code,p.value.accountNumber);S.value=e.data?.data||e.data}catch(e){T.value=e.response?.data?.message||e.response?.data||`Could not verify account`}finally{x.value=!1}}},B=async()=>{if(M.value){E.value=!0;try{let e=await xt.createSettlementAccount({name:S.value.account_name,bankCode:A.value.code,bankName:A.value.name,accountNumber:p.value.accountNumber,accountName:S.value.account_name,makePrimary:p.value.makePrimary});u(`created`,e),H()}catch(e){f.toast({title:e.response?.data?.message||`Failed to add settlement account`,variant:`error`})}finally{E.value=!1}}},H=()=>{p.value.accountNumber=``,p.value.makePrimary=!0,b.value=``,S.value=null,T.value=null,u(`close`)};return V(b,()=>{p.value.accountNumber.length===10&&z()}),(c,l)=>o.isOpen?(G(),I(`div`,{key:0,class:`fixed inset-0 bg-white/80 backdrop-blur-sm z-50 overflow-y-auto`,onClick:C(H,[`self`])},[_(`div`,St,[_(`div`,{class:`bg-stone-50 rounded-2xl shadow-2xl shadow-gray-300 border-4 border-white w-full max-w-md`,onClick:l[2]||=C(()=>{},[`stop`])},[l[8]||=_(`div`,{class:`p-6`},[_(`h2`,{class:`text-xl font-semibold text-slate-800`},`Add Settlement Account`),_(`p`,{class:`text-sm text-slate-500 mt-1`},` Payments will automatically settle to this bank account `)],-1),_(`div`,Ct,[_(`div`,wt,[l[3]||=_(`label`,{class:`block text-sm font-medium text-slate-700 mb-1`},`Bank`,-1),v(Y(n),{modelValue:b.value,"onUpdate:modelValue":l[0]||=e=>b.value=e,class:`relative`,"onUpdate:open":F},{default:K(()=>[v(Y(e),{class:`w-full`},{default:K(()=>[v(Y(t),{class:`bg-stone-50 w-full`,placeholder:g.value?`Loading banks...`:`Select a bank...`},null,8,[`placeholder`])]),_:1}),v(Y(r),{class:`absolute bg-stone-50 z-50 border border-solid border-slate-300 rounded-md mt-1 px-2 py-3 max-h-[250px] overflow-y-scroll w-full`,style:{"scrollbar-width":`none`}},{default:K(()=>[g.value?(G(),I(`div`,Tt,[v(Y(s),{class:`w-4 h-4 animate-spin mx-auto`})])):(G(),I(J,{key:1},[j.value.length===0?(G(),I(`div`,Et,` No banks found `)):a(``,!0),(G(!0),I(J,null,D(j.value,e=>(G(),L(Y(i),{key:e.code,value:e.name,class:`px-4 rounded-full cursor-pointer`},{default:K(()=>[h(w(e.name),1)]),_:2},1032,[`value`]))),128))],64))]),_:1})]),_:1},8,[`modelValue`])]),_(`div`,null,[l[4]||=_(`label`,{class:`block text-sm font-medium text-slate-700 mb-1`},`Account Number`,-1),v(Y(ne),{"model-value":p.value.accountNumber,"onUpdate:modelValue":R,placeholder:`10-digit account number`,maxlength:`10`,inputmode:`numeric`,class:`rounded-full`},null,8,[`model-value`])]),x.value?(G(),I(`div`,Dt,[v(Y(s),{class:`w-4 h-4 animate-spin`}),l[5]||=_(`span`,{class:`text-sm`},`Validating account...`,-1)])):S.value?(G(),I(`div`,Ot,[_(`div`,kt,[v(Y(y),{class:`w-4 h-4`}),_(`span`,At,w(S.value.account_name),1)])])):T.value?(G(),I(`div`,jt,[_(`div`,Mt,[v(Y(d),{class:`w-4 h-4`}),_(`span`,Nt,w(T.value),1)])])):a(``,!0),_(`div`,Pt,[v(Y(ce),{checked:p.value.makePrimary,"onUpdate:checked":l[1]||=e=>p.value.makePrimary=e,id:`makePrimary`},null,8,[`checked`]),l[6]||=_(`label`,{for:`makePrimary`,class:`text-sm text-slate-700 cursor-pointer`},` Set as primary settlement account `,-1)])]),_(`div`,Ft,[v(Y(Z),{variant:`outline`,onClick:H,class:`rounded-full`},{default:K(()=>[...l[7]||=[h(`Cancel`,-1)]]),_:1}),v(Y(Z),{onClick:B,disabled:!M.value||E.value,class:`rounded-full`},{default:K(()=>[E.value?(G(),L(Y(s),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):a(``,!0),h(` `+w(E.value?`Adding...`:`Add Account`),1)]),_:1},8,[`disabled`])])])])])):a(``,!0)}},Lt={class:`absolute w-full flow-vault-page min-h-screen bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-blue-300/80 to-sky-800 from-5% overflow-y-scroll h-screen`,style:{"scrollbar-width":`none`}},Rt={class:`relative container mx-auto py-16 px-4 max-w-4xl`},zt={class:`flex items-center justify-between`},Bt={class:`flex items-center gap-3`},Vt={class:`font-medium text-blue-950`},Ht={class:`text-sm text-blue-950`},Ut={key:0,class:`text-right`},Wt={class:`font-medium text-slate-700`},Gt={key:1,class:`flex items-center justify-center py-16`},Kt={key:2,class:`text-center py-16 px-4`},qt={class:`w-20 h-20 mx-auto mb-6 rounded-full backdrop-blur-lg bg-white/5 border border-white/50 flex items-center justify-center`},Jt={class:`flex items-center justify-between mb-6`},Yt={class:`flex items-center gap-2`},Xt={class:`text-sm text-slate-500`},Zt={class:`flex items-center gap-2`},Qt={class:`text-sm`},$t={class:`bg-white rounded-2xl border shadow-sm p-4`},en={__name:`FlowVault`,setup(e){let t=N(!0),n=N(null),r=N(!1),i=N(null),o=N(null),l=N(!1),d=N(null),p=N(!1),g=N([]),C=c(()=>n.value?n.value.active?`bg-emerald-50 border-emerald-200`:`bg-amber-50 border-amber-200`:`bg-slate-50 border-slate-200`),T=c(()=>n.value?n.value.active?`bg-emerald-100 text-emerald-600`:`bg-amber-100 text-amber-600`:`bg-slate-100 text-slate-500`),D=c(()=>n.value?.active?ee:x),k=c(()=>n.value?n.value.active?`Flow Vault Active`:n.value.state===`PENDING_VIRTUAL_ACCOUNT`?`Pending Virtual Account`:`Setup Required`:`Loading...`),j=c(()=>n.value?n.value.active?`Auto-settlement enabled`:n.value.state===`PENDING_VIRTUAL_ACCOUNT`?`Awaiting virtual account creation`:`Add a settlement account to get started`:``),M=async()=>{try{t.value=!0,n.value=await $.getVaultStatus()}catch(e){console.error(`Failed to load vault status:`,e),n.value={state:`NOT_SETUP`,active:!1}}finally{t.value=!1}},P=async()=>{try{r.value=!0,i.value=await $.verifyChain()}catch(e){i.value={valid:!1,message:`Verification failed: `+e.message}}finally{r.value=!1}},F=async()=>{await $.exportJsonl()},z=async()=>{await $.exportCsv()},V=()=>{p.value=!0},U=async()=>{try{g.value=await xt.getSettlementAccounts()}catch(e){console.error(`Failed to load settlement accounts:`,e),g.value=[]}},W=()=>{M(),U()},q=e=>{o.value=e,l.value=!0},X=()=>{l.value=!1,setTimeout(()=>{o.value=null},300)};return u(()=>{M(),U()}),(e,c)=>(G(),I(`div`,Lt,[v(oe),_(`div`,Rt,[c[10]||=_(`div`,{class:`mb-8`},[_(`h1`,{class:`text-2xl font-bold text-white mb-2`},`Flow Vault`),_(`p`,{class:`text-white`},`Payment flow timeline and settlement events`)],-1),n.value?(G(),I(`div`,{key:0,class:S([`mb-6 p-4 rounded-xl border`,C.value])},[_(`div`,zt,[_(`div`,Bt,[_(`div`,{class:S([`w-10 h-10 rounded-full flex items-center justify-center`,T.value])},[(G(),L(b(D.value),{class:`w-5 h-5`}))],2),_(`div`,null,[_(`h3`,Vt,w(k.value),1),_(`p`,Ht,w(j.value),1)])]),n.value.settlementConfigured?(G(),I(`div`,Ut,[c[2]||=_(`div`,{class:`text-xs text-slate-400`},`Settlement destination`,-1),_(`div`,Wt,w(n.value.settlementBank)+` `+w(n.value.settlementAccountMasked),1)])):a(``,!0)])],2)):a(``,!0),t.value?(G(),I(`div`,Gt,[v(Y(s),{class:`w-8 h-8 animate-spin text-white`})])):n.value?.state===`NEEDS_SETTLEMENT_ACCOUNT`||n.value?.state===`NOT_SETUP`?(G(),I(`div`,Kt,[_(`div`,qt,[v(Y(x),{class:`w-10 h-10 text-stone-100 animate-pulse`,style:{"animation-duration":`7s !important`}})]),c[4]||=_(`h2`,{class:`text-xl font-semibold text-white mb-3`},` Add a settlement account to activate your Flow Vault `,-1),c[5]||=_(`p`,{class:`text-white max-w-md mx-auto mb-6`},` Incoming payments will be routed and settled automatically to your bank account. `,-1),v(Y(Z),{onClick:V,class:`rounded-full px-6`},{default:K(()=>[v(Y(E),{class:`w-4 h-4 mr-2`}),c[3]||=h(` Add Settlement Account `,-1)]),_:1})])):n.value?.active?(G(),I(J,{key:3},[_(`div`,Jt,[_(`div`,Yt,[_(`span`,Xt,w(n.value.blockCount)+` events recorded `,1)]),_(`div`,Zt,[v(Y(Z),{variant:`outline`,size:`sm`,onClick:V,class:`rounded-full`},{default:K(()=>[v(Y(B),{class:`w-4 h-4 mr-1`}),c[6]||=h(` Add Account `,-1)]),_:1}),v(Y(Z),{variant:`outline`,size:`sm`,onClick:P,disabled:r.value,class:`rounded-full`},{default:K(()=>[v(Y(f),{class:`w-4 h-4 mr-1`}),h(` `+w(r.value?`Verifying...`:`Verify Chain`),1)]),_:1},8,[`disabled`]),v(Y(re),null,{default:K(()=>[v(Y(ae),{asChild:``},{default:K(()=>[v(Y(Z),{variant:`outline`,size:`sm`,class:`rounded-full`},{default:K(()=>[v(Y(O),{class:`w-4 h-4 mr-1`}),c[7]||=h(` Export `,-1)]),_:1})]),_:1}),v(Y(ie),null,{default:K(()=>[v(Y(Q),{onClick:F},{default:K(()=>[v(Y(R),{class:`w-4 h-4 mr-2`}),c[8]||=h(` Export JSONL `,-1)]),_:1}),v(Y(Q),{onClick:z},{default:K(()=>[v(Y(H),{class:`w-4 h-4 mr-2`}),c[9]||=h(` Export CSV `,-1)]),_:1})]),_:1})]),_:1})])]),i.value?(G(),I(`div`,{key:0,class:S([`mb-4 p-3 rounded-lg flex items-center gap-2`,i.value.valid?`bg-emerald-50 text-emerald-700`:`bg-orange-50 text-orange-700`])},[(G(),L(b(i.value.valid?Y(y):Y(m)),{class:`w-5 h-5`})),_(`span`,Qt,w(i.value.message),1),_(`button`,{onClick:c[0]||=e=>i.value=null,class:`ml-auto`},[v(Y(A),{class:`w-4 h-4`})])],2)):a(``,!0),_(`div`,$t,[v(Ue,{ref_key:`timelineRef`,ref:d,onEventClick:q},null,512)])],64)):a(``,!0)]),v(bt,{event:o.value,"is-open":l.value,onClose:X},null,8,[`event`,`is-open`]),v(It,{"is-open":p.value,onClose:c[1]||=e=>p.value=!1,onCreated:W},null,8,[`is-open`])]))}};export{en as default};