import{t as e}from"./ohash.D__AXeF1-CGofPpTT.js";import{t}from"./useDirection-Deo8eDT7.js";import{t as n}from"./useFormControl-B1lwnDDb.js";import{t as r}from"./useId-BYCjH9U2.js";import{r as i}from"./PopperContent-BIF3WxAU.js";import{i as a}from"./utils-DO_BBTlw.js";import{t as o}from"./VisuallyHiddenInput-CqgfkHv4.js";import{$t as s,At as c,Bt as l,Ct as u,F as d,H as f,It as p,Lt as m,O as h,Ot as g,Vt as _,W as v,Wt as y,Xt as b,Y as x,gt as S,hn as C,ht as w,k as T,ln as E,pn as ee,rn as D,rt as O,tn as k,tt as A,wt as te,xt as j,y as M,zt as N}from"./index-ByhxY-z7.js";function ne(t,n,r){let i=t.findIndex(t=>e(t,n)),a=t.findIndex(t=>e(t,r));if(i===-1||a===-1)return[];let[o,s]=[i,a].sort((e,t)=>e-t);return t.slice(o,s+1)}function P(e){let t=j(()=>C(e)),n=j(()=>new Intl.Collator(`en`,{usage:`search`,...t.value}));return{startsWith:(e,t)=>t.length===0?!0:(e=e.normalize(`NFC`),t=t.normalize(`NFC`),n.value.compare(e.slice(0,t.length),t)===0),endsWith:(e,t)=>t.length===0?!0:(e=e.normalize(`NFC`),t=t.normalize(`NFC`),n.value.compare(e.slice(-t.length),t)===0),contains:(e,t)=>{if(t.length===0)return!0;e=e.normalize(`NFC`),t=t.normalize(`NFC`);let r=0,i=t.length;for(;r+i<=e.length;r++){let a=e.slice(r,r+i);if(n.value.compare(t,a)===0)return!0}return!1}}}function re(){return{ALT:`Alt`,ARROW_DOWN:`ArrowDown`,ARROW_LEFT:`ArrowLeft`,ARROW_RIGHT:`ArrowRight`,ARROW_UP:`ArrowUp`,BACKSPACE:`Backspace`,CAPS_LOCK:`CapsLock`,CONTROL:`Control`,DELETE:`Delete`,END:`End`,ENTER:`Enter`,ESCAPE:`Escape`,F1:`F1`,F10:`F10`,F11:`F11`,F12:`F12`,F2:`F2`,F3:`F3`,F4:`F4`,F5:`F5`,F6:`F6`,F7:`F7`,F8:`F8`,F9:`F9`,HOME:`Home`,META:`Meta`,PAGE_DOWN:`PageDown`,PAGE_UP:`PageUp`,SHIFT:`Shift`,SPACE:` `,TAB:`Tab`,CTRL:`Control`,ASTERISK:`*`,SPACE_CODE:`Space`}}function F(e,t,n){return e===void 0?!1:Array.isArray(e)?e.some(e=>I(e,t,n)):I(e,t,n)}function I(t,n,r){return t===void 0||n===void 0?!1:typeof t==`string`?t===n:typeof r==`function`?r(t,n):typeof r==`string`?t?.[r]===n?.[r]:e(t,n)}var[L,ie]=O(`ListboxRoot`),R=c({__name:`ListboxRoot`,props:{modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},multiple:{type:Boolean,required:!1},orientation:{type:String,required:!1,default:`vertical`},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},selectionBehavior:{type:String,required:!1,default:`toggle`},highlightOnHover:{type:Boolean,required:!1},by:{type:[String,Function],required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:[`update:modelValue`,`highlight`,`entryFocus`,`leave`],setup(e,{expose:r,emit:s}){let c=e,l=s,{multiple:d,highlightOnHover:p,orientation:g,disabled:x,selectionBehavior:S,dir:w}=ee(c),{getItems:D}=M({isProvider:!0}),{handleTypeaheadSearch:O}=i(),{primitiveElement:A,currentElement:j}=h(),N=re(),P=t(w),F=n(j),L=E(),R=E(!1),z=E(!0),B=f(c,`modelValue`,l,{defaultValue:c.defaultValue??(d.value?[]:void 0),passive:c.modelValue===void 0,deep:!0});function V(e){if(R.value=!0,c.multiple){let t=Array.isArray(B.value)?[...B.value]:[],n=t.findIndex(t=>I(t,e,c.by));c.selectionBehavior===`toggle`?(n===-1?t.push(e):t.splice(n,1),B.value=t):(B.value=[e],L.value=e)}else c.selectionBehavior===`toggle`&&I(B.value,e,c.by)?B.value=void 0:B.value=e;setTimeout(()=>{R.value=!1},1)}let H=E(null),U=E(null),W=E(!1),G=E(!1),K=v(),q=v(),J=v();function Y(){return D().map(e=>e.ref).filter(e=>e.dataset.disabled!==``)}function X(e,t=!0){if(!e)return;H.value=e,z.value&&H.value.focus(),t&&H.value.scrollIntoView({block:`nearest`});let n=D().find(t=>t.ref===e);l(`highlight`,n)}function ae(e){if(W.value)J.trigger(e);else{let t=D().find(t=>I(t.value,e,c.by));t&&(H.value=t.ref,X(t.ref))}}function oe(e){H.value&&H.value.isConnected&&(e.preventDefault(),e.stopPropagation(),G.value||H.value.click())}function se(e){if(z.value){if(R.value=!0,W.value)q.trigger(e);else{let t=e.altKey||e.ctrlKey||e.metaKey;if(t&&e.key===`a`&&d.value){let t=D();B.value=[...t.map(e=>e.value)],e.preventDefault(),X(t[t.length-1].ref)}else if(!t){let t=O(e.key,D());t&&X(t)}}setTimeout(()=>{R.value=!1},1)}}function ce(){G.value=!0}function le(){m(()=>{G.value=!1})}function Z(){m(()=>{let e=new KeyboardEvent(`keydown`,{key:`PageUp`});$(e)})}function Q(e){let t=H.value;t?.isConnected&&(U.value=t),H.value=null,l(`leave`,e)}function ue(e){let t=new CustomEvent(`listbox.entryFocus`,{bubbles:!1,cancelable:!0});if(e.currentTarget?.dispatchEvent(t),l(`entryFocus`,t),!t.defaultPrevented)if(U.value)X(U.value);else{let e=Y()?.[0];X(e)}}function $(e){let t=a(e,g.value,P.value);if(!t)return;let n=Y();if(H.value){if(t===`last`)n.reverse();else if(t===`prev`||t===`next`){t===`prev`&&n.reverse();let e=n.indexOf(H.value);n=n.slice(e+1)}de(e,n[0])}if(n.length){let e=!H.value&&t===`prev`?n.length-1:0;X(n[e])}if(W.value)return q.trigger(e)}function de(e,t){if(!(W.value||c.selectionBehavior!==`replace`||!d.value||!Array.isArray(B.value))&&!((e.altKey||e.ctrlKey||e.metaKey)&&!e.shiftKey)&&e.shiftKey){let n=D().filter(e=>e.ref.dataset.disabled!==``),r=n.find(e=>e.ref===t)?.value;if(e.key===N.END?r=n[n.length-1].value:e.key===N.HOME&&(r=n[0].value),!r||!L.value)return;B.value=ne(n.map(e=>e.value),L.value,r)}}async function fe(e){if(await m(),W.value)K.trigger(e);else{let e=Y(),t=e.find(e=>e.dataset.state===`checked`);t?X(t):e.length&&X(e[0])}}return b(B,()=>{R.value||m(()=>{fe()})},{immediate:!0,deep:!0}),r({highlightedElement:H,highlightItem:ae,highlightFirstItem:Z,highlightSelected:fe,getItems:D}),ie({modelValue:B,onValueChange:V,multiple:d,orientation:g,dir:P,disabled:x,highlightOnHover:p,highlightedElement:H,isVirtual:W,virtualFocusHook:K,virtualKeydownHook:q,virtualHighlightHook:J,by:c.by,firstValue:L,selectionBehavior:S,focusable:z,onLeave:Q,onEnter:ue,changeHighlight:X,onKeydownEnter:oe,onKeydownNavigation:$,onKeydownTypeAhead:se,onCompositionStart:ce,onCompositionEnd:le,highlightFirstItem:Z}),(e,t)=>(_(),u(C(T),{ref_key:`primitiveElement`,ref:A,as:e.as,"as-child":e.asChild,dir:C(P),"data-disabled":C(x)?``:void 0,onPointerleave:Q,onFocusout:t[0]||=async e=>{let t=e.relatedTarget||e.target;await m(),H.value&&C(j)&&!C(j).contains(t)&&Q(e)}},{default:k(()=>[y(e.$slots,`default`,{modelValue:C(B)}),C(F)&&e.name?(_(),u(C(o),{key:0,name:e.name,value:C(B),disabled:C(x),required:e.required},null,8,[`name`,`value`,`disabled`,`required`])):te(`v-if`,!0)]),_:3},8,[`as`,`as-child`,`dir`,`data-disabled`]))}}),z=c({__name:`ListboxContent`,props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(e){let{CollectionSlot:t}=M(),n=L(),r=x(!1,10);return(e,i)=>(_(),u(C(t),null,{default:k(()=>[g(C(T),{role:`listbox`,as:e.as,"as-child":e.asChild,tabindex:C(n).focusable.value?C(n).highlightedElement.value?`-1`:`0`:`-1`,"aria-orientation":C(n).orientation.value,"aria-multiselectable":!!C(n).multiple.value,"data-orientation":C(n).orientation.value,onMousedown:i[0]||=S(e=>r.value=!0,[`left`]),onFocus:i[1]||=e=>{C(r)||C(n).onEnter(e)},onKeydown:[i[2]||=w(e=>{C(n).orientation.value===`vertical`&&(e.key===`ArrowLeft`||e.key===`ArrowRight`)||C(n).orientation.value===`horizontal`&&(e.key===`ArrowUp`||e.key===`ArrowDown`)||(e.preventDefault(),C(n).focusable.value&&C(n).onKeydownNavigation(e))},[`down`,`up`,`left`,`right`,`home`,`end`]),w(C(n).onKeydownEnter,[`enter`]),C(n).onKeydownTypeAhead]},{default:k(()=>[y(e.$slots,`default`)]),_:3},8,[`as`,`as-child`,`tabindex`,`aria-orientation`,`aria-multiselectable`,`data-orientation`,`onKeydown`])]),_:3}))}}),B=c({__name:`ListboxFilter`,props:{modelValue:{type:String,required:!1},autoFocus:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:`input`}},emits:[`update:modelValue`],setup(e,{emit:t}){let n=e,r=f(n,`modelValue`,t,{defaultValue:``,passive:n.modelValue===void 0}),i=L(),{primitiveElement:a,currentElement:o}=h(),c=j(()=>n.disabled||i.disabled.value||!1),d=E();return s(()=>d.value=i.highlightedElement.value?.id),N(()=>{i.focusable.value=!1,setTimeout(()=>{n.autoFocus&&o.value?.focus()},1)}),l(()=>{i.focusable.value=!0}),(e,t)=>(_(),u(C(T),{ref_key:`primitiveElement`,ref:a,as:e.as,"as-child":e.asChild,value:C(r),disabled:c.value?``:void 0,"data-disabled":c.value?``:void 0,"aria-disabled":c.value??void 0,"aria-activedescendant":d.value,type:`text`,onKeydown:[w(S(C(i).onKeydownNavigation,[`prevent`]),[`down`,`up`,`home`,`end`]),w(C(i).onKeydownEnter,[`enter`])],onInput:t[0]||=e=>{r.value=e.target.value,C(i).highlightFirstItem()},onCompositionstart:C(i).onCompositionStart,onCompositionend:C(i).onCompositionEnd},{default:k(()=>[y(e.$slots,`default`,{modelValue:C(r)})]),_:3},8,[`as`,`as-child`,`value`,`disabled`,`data-disabled`,`aria-disabled`,`aria-activedescendant`,`onKeydown`,`onCompositionstart`,`onCompositionend`]))}}),[V,H]=O(`ListboxGroup`),U=c({__name:`ListboxGroup`,props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(e){let t=e,n=r(void 0,`reka-listbox-group`);return H({id:n}),(e,r)=>(_(),u(C(T),p({role:`group`},t,{"aria-labelledby":C(n)}),{default:k(()=>[y(e.$slots,`default`)]),_:3},16,[`aria-labelledby`]))}}),W=`listbox.select`,[G,K]=O(`ListboxItem`),q=c({__name:`ListboxItem`,props:{value:{type:null,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:`div`}},emits:[`select`],setup(e,{emit:t}){let n=e,i=t,a=r(void 0,`reka-listbox-item`),{CollectionItem:o}=M(),{forwardRef:s,currentElement:c}=d(),l=L(),f=j(()=>c.value===l.highlightedElement.value),m=j(()=>F(l.modelValue.value,n.value,l.by)),h=j(()=>l.disabled.value||n.disabled);async function v(e){i(`select`,e),!e?.defaultPrevented&&!h.value&&e&&(l.onValueChange(n.value),l.changeHighlight(c.value))}function b(e){let t={originalEvent:e,value:n.value};A(W,v,t)}return K({isSelected:m}),(e,t)=>(_(),u(C(o),{value:e.value},{default:k(()=>[D([f.value,m.value],()=>g(C(T),p({id:C(a)},e.$attrs,{ref:C(s),role:`option`,tabindex:C(l).focusable.value?f.value?`0`:`-1`:-1,"aria-selected":m.value,as:e.as,"as-child":e.asChild,disabled:h.value?``:void 0,"data-disabled":h.value?``:void 0,"data-highlighted":f.value?``:void 0,"data-state":m.value?`checked`:`unchecked`,onClick:b,onKeydown:w(S(b,[`prevent`]),[`space`]),onPointermove:t[0]||=()=>{C(l).highlightedElement.value!==C(c)&&C(l).highlightOnHover.value&&!C(l).focusable.value&&C(l).changeHighlight(C(c),!1)}}),{default:k(()=>[y(e.$slots,`default`)]),_:3},16,[`id`,`tabindex`,`aria-selected`,`as`,`as-child`,`disabled`,`data-disabled`,`data-highlighted`,`data-state`,`onKeydown`]),t,1)]),_:3},8,[`value`]))}});export{z as a,P as c,B as i,U as n,R as o,V as r,L as s,q as t};