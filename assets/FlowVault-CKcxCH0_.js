import"./useFormControl-Dnp3iC5X.js";import"./ListboxItem-Bfe5qZhm.js";import"./nullish-CfjOSA4G.js";import"./CheckboxIndicator-CPem_8FL.js";import"./useArrowNavigation-siWGBYoD.js";import"./ConfigProvider-Ckl6KgMj.js";import"./useHideOthers-L15EfXxs.js";import"./useDirection-B1kSZwKq.js";import"./PopperAnchor-Sq61S0mP.js";import"./useId-Da-MS2me.js";import"./useKbd-BvGB3m10.js";import"./PopperContent-b6gGwF_E.js";import"./useTypeahead---iVCXRs.js";import"./Teleport-BJpx-KiC.js";import"./utils-BpsHH13c.js";import"./utils-BFR0tnUV.js";import"./RovingFocusGroup-BhwVgyO_.js";import"./RovingFocusItem-DP4RL6Sr.js";import"./VisuallyHiddenInput-B3HVdvGc.js";import{i as e,n as t,r as n,s as r,t as i}from"./ComboboxItem-BqMucZ-W.js";import"./DropdownMenuTrigger-BH9p6Bti.js";import{$i as a,$n as o,An as s,C as c,Ea as l,Ei as u,Fi as d,Hn as f,Ht as p,In as m,Li as h,Ln as g,Mi as _,Ni as v,Nn as y,Nt as b,Oi as x,P as S,Pi as C,Ri as w,Ta as T,Wn as E,X as D,Xi as O,Yi as k,Zi as A,a as j,b as M,bi as N,da as P,dn as F,dr as I,dt as L,hr as R,i as z,in as B,ji as V,ka as H,na as U,o as W,oa as G,pr as K,ur as q,x as J,ya as Y,yi as X,yn as ee,zn as te}from"./index-CHNvwQRL.js";import{t as ne}from"./Input-i1kcrjFD.js";import{t as Z}from"./button-BRhnnMH3.js";import{i as re,n as Q,r as ie,t as ae}from"./DropdownMenuTrigger-DB_AyFT1.js";import{t as oe}from"./BackgroundAnimation-DnlEY4kt.js";import{t as se}from"./BankAccountService-CMPAALVv.js";import{t as ce}from"./Checkbox-CDVlNxvg.js";var le={class:`flex flex-col items-center`},ue={class:`flex-1 min-w-0`},de={class:`flex items-center justify-between gap-2 mb-1`},fe={class:`font-medium text-slate-800`},pe={class:`text-xs text-slate-400`},me={class:`flex items-center gap-2 mt-2 text-sm text-slate-500`},he={key:0},ge={key:1,class:`text-xs text-slate-400 font-mono`},_e={__name:`FlowEventCard`,props:{event:{type:Object,required:!0},isLast:{type:Boolean,default:!1}},emits:[`click`],setup(e){let t=e,n=V(()=>t.event.eventType===`INCOMING_PAYMENT`),r=V(()=>t.event.eventType===`SETTLEMENT_COMPLETED`),i=V(()=>t.event.eventType===`SETTLEMENT_FAILED`),a=V(()=>t.event.eventType===`SETTLEMENT_INITIATED`),o=V(()=>n.value?R:r.value?m:i.value?y:a.value?s:q),c=V(()=>{switch(t.event.eventType){case`INCOMING_PAYMENT`:return`Payment received`;case`SETTLEMENT_INITIATED`:return`Settlement initiated`;case`SETTLEMENT_COMPLETED`:return`Settled to bank`;case`SETTLEMENT_FAILED`:return`Settlement failed`;default:return t.event.eventType}}),u=V(()=>n.value?`animate-slide-in-left`:`animate-slide-in-right`),p=V(()=>n.value?`bg-emerald-100 text-emerald-600`:r.value?`bg-blue-100 text-blue-600`:i.value?`bg-orange-100 text-orange-600`:(a.value,`bg-slate-100 text-slate-600`)),h=V(()=>n.value?`from-emerald-200 to-transparent`:r.value?`from-blue-200 to-transparent`:`from-slate-200 to-transparent`),g=V(()=>n.value?`text-emerald-600`:r.value?`text-blue-600`:i.value?`text-orange-600`:`text-slate-700`),b=V(()=>{let e=t.event.payload?.amount,n=t.event.payload?.currency||`NGN`;return e?new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:n,minimumFractionDigits:0,maximumFractionDigits:2}).format(e):`—`}),x=V(()=>{if(!t.event.timestamp)return``;let e=new Date(t.event.timestamp),n=new Date-e,r=Math.floor(n/6e4),i=Math.floor(n/36e5),a=Math.floor(n/864e5);return r<1?`Just now`:r<60?`${r}m ago`:i<24?`${i}h ago`:a<7?`${a}d ago`:e.toLocaleDateString(`en-NG`,{day:`numeric`,month:`short`})}),S=e=>e?e.length<=12?e:e.substring(0,6)+`...`+e.substring(e.length-4):``;return(t,n)=>(A(),d(`div`,{class:l([`flow-event-card group relative flex items-start gap-4 p-4 rounded-xl transition-all duration-300 hover:bg-slate-50/50 cursor-pointer`,u.value]),onClick:n[0]||=n=>t.$emit(`click`,e.event)},[_(`div`,le,[_(`div`,{class:l([`w-10 h-10 rounded-full flex items-center justify-center shrink-0 transition-all duration-300`,p.value])},[(A(),v(U(o.value),{class:`w-5 h-5`}))],2),e.isLast?C(``,!0):(A(),d(`div`,{key:0,class:l([`w-0.5 h-full min-h-[40px] mt-2 rounded-full bg-gradient-to-b`,h.value])},null,2))]),_(`div`,ue,[_(`div`,de,[_(`span`,fe,H(c.value),1),_(`span`,pe,H(x.value),1)]),_(`div`,{class:l([`text-lg font-semibold`,g.value])},H(b.value),3),_(`div`,me,[e.event.payload?.payerName||e.event.payload?.bankName?(A(),d(`span`,he,H(e.event.payload?.payerName||e.event.payload?.bankName),1)):C(``,!0),e.event.eventRef?(A(),d(`span`,ge,H(S(e.event.eventRef)),1)):C(``,!0)])]),w(T(f),{class:`w-4 h-4 text-slate-300 group-hover:text-slate-500 transition-colors shrink-0 mt-1`})],2))}},ve=z(_e,[[`__scopeId`,`data-v-245f882a`]]),ye={class:`flex items-center justify-between mb-3`},be={class:`flex items-center gap-2`},xe={class:`text-xs text-slate-400`},Se={key:0,class:`flex items-center justify-between`},Ce={class:`flex items-center gap-2`},we={key:1,class:`flex items-center justify-between`},Te={class:`flex items-center gap-2`},Ee={class:`text-lg font-semibold text-emerald-600`},De={class:`mt-1 text-xs text-slate-400 font-mono`},Oe={key:1,class:`flex items-center gap-2 pl-4 my-2`},ke=[`onClick`],Ae={class:`flex items-center justify-between`},je={class:`flex items-center gap-2`},Me={class:`text-xs text-slate-600`},Ne={__name:`FlowEventGroup`,props:{group:{type:Object,required:!0}},emits:[`event-click`],setup(e){let t=e,n=V(()=>t.group.payment?.eventType===`VAULT_ACTIVATED`?`ACTIVATED`:t.group.status||`PENDING`),r=V(()=>{switch(n.value){case`COMPLETED`:return`Settled`;case`FAILED`:return`Failed`;case`INITIATED`:return`Settling...`;case`ACTIVATED`:return`Active`;default:return`Pending`}}),i=V(()=>{switch(n.value){case`COMPLETED`:return m;case`FAILED`:return y;case`INITIATED`:return b;case`ACTIVATED`:return D;default:return s}}),o=V(()=>{switch(n.value){case`COMPLETED`:return`bg-blue-50/50 border-blue-200`;case`FAILED`:return`bg-orange-50/50 border-orange-200`;case`ACTIVATED`:return`bg-slate-50/50 border-slate-200`;default:return`bg-slate-50/50 border-slate-200`}}),c=V(()=>{switch(n.value){case`COMPLETED`:return`bg-blue-100 text-blue-600`;case`FAILED`:return`bg-orange-100 text-orange-600`;case`ACTIVATED`:return`bg-blue-100 text-blue-600`;default:return`bg-slate-100 text-slate-500`}}),u=V(()=>{switch(n.value){case`COMPLETED`:return`text-blue-600`;case`FAILED`:return`text-orange-600`;case`ACTIVATED`:return`text-blue-600`;default:return`text-slate-500`}}),f=V(()=>{let e=t.group.payment?.timestamp;return e?new Date(e).toLocaleDateString(`en-NG`,{day:`numeric`,month:`short`,hour:`2-digit`,minute:`2-digit`}):``}),p=V(()=>{let e=t.group.payment;return e?h(e.payload?.amount,e.payload?.currency):`—`}),h=(e,t=`NGN`)=>e?new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:t,minimumFractionDigits:0,maximumFractionDigits:2}).format(e):`—`,g=e=>e?e.length<=12?e:e.substring(0,6)+`...`+e.substring(e.length-4):``,S=e=>e.eventType===`SETTLEMENT_COMPLETED`?m:e.eventType===`SETTLEMENT_FAILED`?y:s,E=e=>e.eventType===`SETTLEMENT_COMPLETED`?`text-blue-500`:e.eventType===`SETTLEMENT_FAILED`?`text-orange-500`:`text-slate-400`,O=e=>e.eventType===`SETTLEMENT_COMPLETED`?`Settled to bank`:e.eventType===`SETTLEMENT_FAILED`?`Settlement failed`:`Settling...`,k=e=>e.eventType===`SETTLEMENT_COMPLETED`?`border-blue-200 bg-blue-50/50`:e.eventType===`SETTLEMENT_FAILED`?`border-orange-200 bg-orange-50/50`:`border-slate-200`,j=e=>e.eventType===`SETTLEMENT_COMPLETED`?`text-blue-600`:e.eventType===`SETTLEMENT_FAILED`?`text-orange-600`:`text-slate-600`;return(t,n)=>(A(),d(`div`,{class:l([`flow-event-group p-4 rounded-xl border`,o.value])},[_(`div`,ye,[_(`div`,be,[_(`div`,{class:l([`w-8 h-8 rounded-full flex items-center justify-center`,c.value])},[(A(),v(U(i.value),{class:`w-4 h-4`}))],2),_(`span`,{class:l([`text-xs font-medium uppercase tracking-wide`,u.value])},H(r.value),3)]),_(`span`,xe,H(f.value),1)]),e.group.payment?(A(),d(`div`,{key:0,class:`p-3 rounded-lg bg-white border cursor-pointer hover:bg-slate-50 transition-colors`,onClick:n[0]||=n=>t.$emit(`event-click`,e.group.payment)},[e.group.payment.eventType===`VAULT_ACTIVATED`?(A(),d(`div`,Se,[_(`div`,Ce,[w(T(D),{class:`w-4 h-4 text-blue-500`}),n[1]||=_(`span`,{class:`text-sm font-medium text-slate-700`},`Vault Activated`,-1)]),n[2]||=_(`span`,{class:`text-xs text-slate-500`},`System Event`,-1)])):(A(),d(`div`,we,[_(`div`,Te,[w(T(R),{class:`w-4 h-4 text-emerald-500`}),n[3]||=_(`span`,{class:`text-sm font-medium text-slate-700`},`Payment received`,-1)]),_(`span`,Ee,H(p.value),1)])),_(`div`,De,H(g(e.group.payment?.eventRef)),1)])):C(``,!0),e.group.settlements?.length?(A(),d(`div`,Oe,[n[4]||=_(`div`,{class:`w-0.5 h-4 bg-slate-200`},null,-1),w(T(I),{class:`w-3 h-3 text-slate-400`})])):C(``,!0),(A(!0),d(x,null,a(e.group.settlements,e=>(A(),d(`div`,{key:e.hash,class:l([`ml-6 p-2 rounded-lg border cursor-pointer hover:bg-slate-50 transition-colors`,k(e)]),onClick:n=>t.$emit(`event-click`,e)},[_(`div`,Ae,[_(`div`,je,[(A(),v(U(S(e)),{class:l([`w-3 h-3`,E(e)])},null,8,[`class`])),_(`span`,Me,H(O(e)),1)]),_(`span`,{class:l([`text-sm font-medium`,j(e)])},H(h(e.payload?.amount,e.payload?.currency)),3)])],10,ke))),128))],2))}},$={async getVaultStatus(){let e=await W.get(`/org/flow-vault`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e},async getTimeline(e=0,t=20){let n=await W.get(`/org/flow-vault/timeline`,{query:{page:e,size:t},authorizeRequest:!0,organisationAware:!0});return n?.data||n},async verifyChain(){let e=await W.get(`/org/flow-vault/verify`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e},async exportJsonl(){let e=await W.get(`/org/flow-vault/export/jsonl`,{responseType:`blob`,authorizeRequest:!0,organisationAware:!0}),t=window.URL.createObjectURL(new Blob([e])),n=document.createElement(`a`);n.href=t,n.setAttribute(`download`,`flowvault-${new Date().toISOString().split(`T`)[0]}.jsonl`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t)},async exportCsv(){let e=await W.get(`/org/flow-vault/export/csv`,{responseType:`blob`,authorizeRequest:!0,organisationAware:!0}),t=window.URL.createObjectURL(new Blob([e])),n=document.createElement(`a`);n.href=t,n.setAttribute(`download`,`flowvault-${new Date().toISOString().split(`T`)[0]}.csv`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t)},async getGroupedTimeline(){let e=await W.get(`/org/flow-vault/timeline/grouped`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e}},Pe={class:`flow-timeline`},Fe={class:`flex items-center justify-between mb-4`},Ie={class:`text-sm text-slate-500`},Le={key:0,class:`flex items-center justify-center py-12`},Re={key:1,class:`text-center py-12`},ze={class:`w-16 h-16 mx-auto mb-4 rounded-full bg-slate-100 flex items-center justify-center`},Be={key:2,class:`space-y-4`},Ve={key:3,class:`space-y-0`},He={__name:`FlowTimeline`,props:{pageSize:{type:Number,default:20}},emits:[`event-click`],setup(e,{expose:t,emit:n}){let r=e,i=n,o=Y([]),s=Y([]),c=Y(!0),u=Y(!1),f=Y(!1),m=Y(0),g=Y(null),y=Y(!0),S=null,D=V(()=>y.value?s.value.length===0:o.value.length===0),j=async()=>{try{c.value=!0;let e=await $.getTimeline(0,r.pageSize);o.value=e.content||[],f.value=!e.last,m.value=0}catch(e){console.error(`Failed to load timeline:`,e)}finally{c.value=!1}},M=async()=>{try{c.value=!0,s.value=await $.getGroupedTimeline()}catch(e){console.error(`Failed to load grouped timeline:`,e)}finally{c.value=!1}},F=async()=>{if(!(u.value||!f.value||y.value))try{u.value=!0,m.value++;let e=await $.getTimeline(m.value,r.pageSize);o.value.push(...e.content||[]),f.value=!e.last}catch(e){console.error(`Failed to load more events:`,e),m.value--}finally{u.value=!1}},I=()=>{y.value=!y.value,y.value?M():j()},L=e=>{i(`event-click`,e)},R=()=>{g.value&&(S=new IntersectionObserver(e=>{e[0].isIntersecting&&f.value&&!u.value&&!y.value&&F()},{threshold:.1}),S.observe(g.value))};return k(()=>{M(),setTimeout(R,500)}),O(()=>{S&&S.disconnect()}),t({refresh:()=>y.value?M():j()}),(e,t)=>(A(),d(`div`,Pe,[_(`div`,Fe,[_(`span`,Ie,H(y.value?`Grouped by payment`:`All events`),1),_(`button`,{onClick:I,class:l([`text-xs px-3 py-1 rounded-full border transition-colors`,y.value?`bg-blue-50 border-blue-200 text-blue-600`:`bg-slate-50 border-slate-200 text-slate-600`])},[w(T(p),{class:`w-3 h-3 inline mr-1`}),h(` `+H(y.value?`Show flat`:`Group by payment`),1)],2)]),c.value?(A(),d(`div`,Le,[w(T(b),{class:`w-6 h-6 animate-spin text-slate-400`})])):D.value?(A(),d(`div`,Re,[_(`div`,ze,[w(T(K),{class:`w-8 h-8 text-slate-400`})]),t[0]||=_(`h3`,{class:`text-lg font-medium text-slate-700 mb-2`},`No events yet`,-1),t[1]||=_(`p`,{class:`text-sm text-slate-500 max-w-sm mx-auto`},` Incoming payments and settlements will appear here as they flow through your vault. `,-1)])):y.value?(A(),d(`div`,Be,[w(N,{name:`timeline`},{default:P(()=>[(A(!0),d(x,null,a(s.value,e=>(A(),v(Ne,{key:e.payment?.hash||e.settlements?.[0]?.hash,group:e,onEventClick:L},null,8,[`group`]))),128))]),_:1})])):(A(),d(`div`,Ve,[w(N,{name:`timeline`},{default:P(()=>[(A(!0),d(x,null,a(o.value,(e,t)=>(A(),v(ve,{key:e.hash||e.index,event:e,"is-last":t===o.value.length-1,onClick:t=>L(e)},null,8,[`event`,`is-last`,`onClick`]))),128))]),_:1}),f.value?(A(),d(`div`,{key:0,ref_key:`loadMoreTrigger`,ref:g,class:`py-4 flex items-center justify-center`},[u.value?(A(),v(T(b),{key:1,class:`w-5 h-5 animate-spin text-slate-400`})):(A(),d(`button`,{key:0,onClick:F,class:`text-sm text-slate-500 hover:text-slate-700 flex items-center gap-2`},[w(T(E),{class:`w-4 h-4`}),t[2]||=h(` Load more `,-1)]))],512)):C(``,!0)]))]))}},Ue=z(He,[[`__scopeId`,`data-v-dea6f07d`]]),We={key:0,class:`flow-event-drawer fixed inset-y-0 right-0 w-full max-w-md bg-white shadow-xl z-50 flex flex-col`},Ge={class:`flex items-center justify-between p-4 border-b`},Ke={class:`text-sm text-slate-500`},qe={key:0,class:`flex-1 overflow-y-auto p-4 space-y-6`},Je={class:`text-2xl font-bold`},Ye={class:`space-y-4`},Xe={class:`text-slate-700`},Ze={key:0},Qe={class:`text-slate-700 font-mono text-sm`},$e={key:1},et={class:`text-slate-700`},tt={key:2},nt={class:`text-slate-700`},rt={key:3},it={class:`text-slate-700`},at={key:4},ot={class:`text-slate-700 font-mono`},st={key:5},ct={class:`text-orange-600`},lt={class:`space-y-3`},ut={class:`text-sm font-medium text-slate-700 flex items-center gap-2`},dt={class:`text-slate-700 font-mono`},ft={class:`text-slate-700 font-mono text-xs break-all bg-slate-50 p-2 rounded`},pt={class:`text-slate-700 font-mono text-xs break-all bg-slate-50 p-2 rounded`},mt={key:0,class:`space-y-3`},ht={class:`text-slate-700 font-mono text-sm`},gt={class:`p-4 border-t bg-slate-50`},_t={class:`flex items-center justify-between text-xs text-slate-500`},vt={class:`flex items-center gap-1 text-emerald-500`},yt={__name:`FlowEventDrawer`,props:{event:{type:Object,default:null},isOpen:{type:Boolean,default:!1}},emits:[`close`],setup(e,{emit:t}){let n=e,r=t,i=()=>r(`close`),a=V(()=>n.event?.eventType===`INCOMING_PAYMENT`),o=V(()=>n.event?.eventType===`SETTLEMENT_COMPLETED`),s=V(()=>{if(!n.event)return``;switch(n.event.eventType){case`INCOMING_PAYMENT`:return`Payment Received`;case`SETTLEMENT_INITIATED`:return`Settlement Initiated`;case`SETTLEMENT_COMPLETED`:return`Settled to Bank`;case`SETTLEMENT_FAILED`:return`Settlement Failed`;default:return n.event.eventType}}),c=V(()=>a.value?`bg-emerald-50 text-emerald-700`:o.value?`bg-blue-50 text-blue-700`:`bg-slate-50 text-slate-700`),u=V(()=>{if(!n.event?.payload?.amount)return`—`;let e=n.event.payload.currency||`NGN`;return new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:e,minimumFractionDigits:0,maximumFractionDigits:2}).format(n.event.payload.amount)}),f=V(()=>n.event?.timestamp?new Date(n.event.timestamp).toLocaleString(`en-NG`,{dateStyle:`full`,timeStyle:`short`}):``);return(t,n)=>(A(),d(x,null,[w(X,{name:`drawer`},{default:P(()=>[e.isOpen?(A(),d(`div`,We,[_(`div`,Ge,[_(`div`,null,[n[0]||=_(`h2`,{class:`text-lg font-semibold text-slate-800`},`Event Details`,-1),_(`p`,Ke,H(s.value),1)]),_(`button`,{onClick:i,class:`p-2 rounded-lg hover:bg-slate-100 transition-colors`},[w(T(J),{class:`w-5 h-5 text-slate-500`})])]),e.event?(A(),d(`div`,qe,[_(`div`,{class:l([`p-4 rounded-xl`,c.value])},[n[1]||=_(`div`,{class:`text-sm opacity-75 mb-1`},`Amount`,-1),_(`div`,Je,H(u.value),1)],2),_(`div`,Ye,[_(`div`,null,[n[2]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Timestamp`,-1),_(`p`,Xe,H(f.value),1)]),e.event.eventRef?(A(),d(`div`,Ze,[n[3]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Reference`,-1),_(`p`,Qe,H(e.event.eventRef),1)])):C(``,!0),e.event.payload?.payerName?(A(),d(`div`,$e,[n[4]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Payer`,-1),_(`p`,et,H(e.event.payload.payerName),1)])):C(``,!0),e.event.payload?.payerEmail?(A(),d(`div`,tt,[n[5]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Payer Email`,-1),_(`p`,nt,H(e.event.payload.payerEmail),1)])):C(``,!0),e.event.payload?.bankName?(A(),d(`div`,rt,[n[6]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Bank`,-1),_(`p`,it,H(e.event.payload.bankName),1)])):C(``,!0),e.event.payload?.accountNumber?(A(),d(`div`,at,[n[7]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Account`,-1),_(`p`,ot,H(e.event.payload.accountNumber),1)])):C(``,!0),e.event.payload?.failureReason?(A(),d(`div`,st,[n[8]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Failure Reason`,-1),_(`p`,ct,H(e.event.payload.failureReason),1)])):C(``,!0)]),n[15]||=_(`hr`,{class:`border-slate-100`},null,-1),_(`div`,lt,[_(`h3`,ut,[w(T(D),{class:`w-4 h-4 text-emerald-500`}),n[9]||=h(` Chain Verification `,-1)]),_(`div`,null,[n[10]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Block Index`,-1),_(`p`,dt,H(e.event.index),1)]),_(`div`,null,[n[11]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Block Hash`,-1),_(`p`,ft,H(e.event.hash),1)]),_(`div`,null,[n[12]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Previous Hash`,-1),_(`p`,pt,H(e.event.prevHash||`(genesis block)`),1)])]),e.event.payload?.flwRef?(A(),d(`div`,mt,[n[14]||=_(`h3`,{class:`text-sm font-medium text-slate-700`},`PSP Reference IDs`,-1),_(`div`,null,[n[13]||=_(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Flutterwave Ref`,-1),_(`p`,ht,H(e.event.payload.flwRef),1)])])):C(``,!0)])):C(``,!0),_(`div`,gt,[_(`div`,_t,[n[17]||=_(`span`,null,`Cryptographically verified`,-1),_(`div`,vt,[w(T(g),{class:`w-3.5 h-3.5`}),n[16]||=_(`span`,null,`Chain intact`,-1)])])])])):C(``,!0)]),_:1}),w(X,{name:`fade`},{default:P(()=>[e.isOpen?(A(),d(`div`,{key:0,class:`fixed inset-0 bg-black/20 z-40`,onClick:i})):C(``,!0)]),_:1})],64))}},bt=z(yt,[[`__scopeId`,`data-v-90a5feef`]]),xt={async getSettlementAccounts(){return(await W.get(`/org/settlement-accounts`,{authorizeRequest:!0,organisationAware:!0}))?.data||[]},async getSupportedBanks(){return(await W.get(`/org/settlement-accounts/banks`,{authorizeRequest:!0,organisationAware:!0}))?.data||[]},async validateBankAccount(e,t){let n=await W.post(`/org/settlement-accounts/validate`,{data:{bankCode:e,accountNumber:t},authorizeRequest:!0,organisationAware:!0});return n?.data||n},async createSettlementAccount(e){let t=await W.post(`/org/settlement-accounts`,{data:e,authorizeRequest:!0,organisationAware:!0});return t?.data||t},async setPrimaryAccount(e){let t=await W.patch(`/org/settlement-accounts/${e}`,{data:{primary:!0},authorizeRequest:!0,organisationAware:!0});return t?.data||t},async disableAccount(e){let t=await W.patch(`/org/settlement-accounts/${e}`,{data:{enabled:!1},authorizeRequest:!0,organisationAware:!0});return t?.data||t},async getPrimaryAccount(){return(await W.get(`/org/settlement-accounts/primary`,{authorizeRequest:!0,organisationAware:!0}))?.data||null}},St={class:`flex items-center justify-center min-h-screen p-4`},Ct={class:`p-6 space-y-4`},wt={class:`relative`},Tt={key:0,class:`py-3 text-center text-slate-500`},Et={key:0,class:`py-3 text-center text-slate-500 text-sm`},Dt={key:0,class:`flex items-center gap-2 text-slate-500`},Ot={key:1,class:`p-3 rounded-xl bg-emerald-50 border border-emerald-200`},kt={class:`flex items-center gap-2 text-emerald-700`},At={class:`text-sm font-medium`},jt={key:2,class:`p-3 rounded-xl bg-orange-50 border border-orange-200`},Mt={class:`flex items-center gap-2 text-orange-700`},Nt={class:`text-sm`},Pt={class:`flex items-center gap-2 py-4`},Ft={class:`p-6 border-t rounded-b-2xl flex items-center justify-end gap-3`},It={__name:`SettlementAccountDialog`,props:{isOpen:{type:Boolean,default:!1}},emits:[`close`,`created`],setup(o,{emit:s}){let c=s,l=j(),f=Y({accountNumber:``,makePrimary:!0}),p=Y([]),m=Y(!1),y=Y(``),S=Y(!1),E=Y(null),D=Y(null),O=Y(!1),k=V(()=>{let e=new Map;for(let t of p.value)e.set(t.name,t);return e}),M=V(()=>y.value?k.value.get(y.value):null),N=V(()=>p.value),F=V(()=>M.value&&f.value.accountNumber.length===10&&E.value&&!S.value),I=async()=>{if(!(m.value||p.value.length>0)){m.value=!0;try{let{data:e}=await se.getBanksByCountry(`NG`);p.value=(e||[]).sort((e,t)=>e.name.localeCompare(t.name))}catch(e){console.error(`Failed to load banks:`,e)}finally{m.value=!1}}},L=e=>{e&&p.value.length===0&&I()},R=e=>{let t=String(e).replace(/\D/g,``).slice(0,10);f.value.accountNumber=t,E.value=null,D.value=null,t.length===10&&M.value&&z()},z=async()=>{if(!(!M.value||f.value.accountNumber.length!==10)){S.value=!0,D.value=null,E.value=null;try{let e=await se.validateAccount(`NG`,M.value.code,f.value.accountNumber);E.value=e.data?.data||e.data}catch(e){D.value=e.response?.data?.message||e.response?.data||`Could not verify account`}finally{S.value=!1}}},B=async()=>{if(F.value){O.value=!0;try{let e=await xt.createSettlementAccount({name:E.value.account_name,bankCode:M.value.code,bankName:M.value.name,accountNumber:f.value.accountNumber,accountName:E.value.account_name,makePrimary:f.value.makePrimary});c(`created`,e),U()}catch(e){l.toast({title:e.response?.data?.message||`Failed to add settlement account`,variant:`error`})}finally{O.value=!1}}},U=()=>{f.value.accountNumber=``,f.value.makePrimary=!0,y.value=``,E.value=null,D.value=null,c(`close`)};return G(y,()=>{f.value.accountNumber.length===10&&z()}),(s,c)=>o.isOpen?(A(),d(`div`,{key:0,class:`fixed inset-0 bg-white/80 backdrop-blur-sm z-50 overflow-y-auto`,onClick:u(U,[`self`])},[_(`div`,St,[_(`div`,{class:`bg-stone-50 rounded-2xl shadow-2xl shadow-gray-300 border-4 border-white w-full max-w-md`,onClick:c[2]||=u(()=>{},[`stop`])},[c[8]||=_(`div`,{class:`p-6`},[_(`h2`,{class:`text-xl font-semibold text-slate-800`},`Add Settlement Account`),_(`p`,{class:`text-sm text-slate-500 mt-1`},` Payments will automatically settle to this bank account `)],-1),_(`div`,Ct,[_(`div`,wt,[c[3]||=_(`label`,{class:`block text-sm font-medium text-slate-700 mb-1`},`Bank`,-1),w(T(n),{modelValue:y.value,"onUpdate:modelValue":c[0]||=e=>y.value=e,class:`relative`,"onUpdate:open":L},{default:P(()=>[w(T(e),{class:`w-full`},{default:P(()=>[w(T(t),{class:`bg-stone-50 w-full`,placeholder:m.value?`Loading banks...`:`Select a bank...`},null,8,[`placeholder`])]),_:1}),w(T(r),{class:`absolute bg-stone-50 z-50 border border-solid border-slate-300 rounded-md mt-1 px-2 py-3 max-h-[250px] overflow-y-scroll w-full`,style:{"scrollbar-width":`none`}},{default:P(()=>[m.value?(A(),d(`div`,Tt,[w(T(b),{class:`w-4 h-4 animate-spin mx-auto`})])):(A(),d(x,{key:1},[N.value.length===0?(A(),d(`div`,Et,` No banks found `)):C(``,!0),(A(!0),d(x,null,a(N.value,e=>(A(),v(T(i),{key:e.code,value:e.name,class:`px-4 rounded-full cursor-pointer`},{default:P(()=>[h(H(e.name),1)]),_:2},1032,[`value`]))),128))],64))]),_:1})]),_:1},8,[`modelValue`])]),_(`div`,null,[c[4]||=_(`label`,{class:`block text-sm font-medium text-slate-700 mb-1`},`Account Number`,-1),w(T(ne),{"model-value":f.value.accountNumber,"onUpdate:modelValue":R,placeholder:`10-digit account number`,maxlength:`10`,inputmode:`numeric`,class:`rounded-full`},null,8,[`model-value`])]),S.value?(A(),d(`div`,Dt,[w(T(b),{class:`w-4 h-4 animate-spin`}),c[5]||=_(`span`,{class:`text-sm`},`Validating account...`,-1)])):E.value?(A(),d(`div`,Ot,[_(`div`,kt,[w(T(g),{class:`w-4 h-4`}),_(`span`,At,H(E.value.account_name),1)])])):D.value?(A(),d(`div`,jt,[_(`div`,Mt,[w(T(te),{class:`w-4 h-4`}),_(`span`,Nt,H(D.value),1)])])):C(``,!0),_(`div`,Pt,[w(T(ce),{checked:f.value.makePrimary,"onUpdate:checked":c[1]||=e=>f.value.makePrimary=e,id:`makePrimary`},null,8,[`checked`]),c[6]||=_(`label`,{for:`makePrimary`,class:`text-sm text-slate-700 cursor-pointer`},` Set as primary settlement account `,-1)])]),_(`div`,Ft,[w(T(Z),{variant:`outline`,onClick:U,class:`rounded-full`},{default:P(()=>[...c[7]||=[h(`Cancel`,-1)]]),_:1}),w(T(Z),{onClick:B,disabled:!F.value||O.value,class:`rounded-full`},{default:P(()=>[O.value?(A(),v(T(b),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):C(``,!0),h(` `+H(O.value?`Adding...`:`Add Account`),1)]),_:1},8,[`disabled`])])])])])):C(``,!0)}},Lt={class:`absolute w-full flow-vault-page min-h-screen bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-blue-300/80 to-sky-800 from-5% overflow-y-scroll h-screen`,style:{"scrollbar-width":`none`}},Rt={class:`relative container mx-auto py-16 px-4 max-w-4xl`},zt={class:`flex items-center justify-between`},Bt={class:`flex items-center gap-3`},Vt={class:`font-medium text-blue-950`},Ht={class:`text-sm text-blue-950`},Ut={key:0,class:`text-right`},Wt={class:`font-medium text-slate-700`},Gt={key:1,class:`flex items-center justify-center py-16`},Kt={key:2,class:`text-center py-16 px-4`},qt={class:`w-20 h-20 mx-auto mb-6 rounded-full backdrop-blur-lg bg-white/5 border border-white/50 flex items-center justify-center`},Jt={class:`flex items-center justify-between mb-6`},Yt={class:`flex items-center gap-2`},Xt={class:`text-sm text-slate-500`},Zt={class:`flex items-center gap-2`},Qt={class:`text-sm`},$t={class:`bg-white rounded-2xl border shadow-sm p-4`},en={__name:`FlowVault`,setup(e){let t=Y(!0),n=Y(null),r=Y(!1),i=Y(null),a=Y(null),s=Y(!1),u=Y(null),f=Y(!1),p=Y([]),m=V(()=>n.value?n.value.active?`bg-emerald-50 border-emerald-200`:`bg-amber-50 border-amber-200`:`bg-slate-50 border-slate-200`),y=V(()=>n.value?n.value.active?`bg-emerald-100 text-emerald-600`:`bg-amber-100 text-amber-600`:`bg-slate-100 text-slate-500`),E=V(()=>n.value?.active?M:c),O=V(()=>n.value?n.value.active?`Flow Vault Active`:n.value.state===`PENDING_VIRTUAL_ACCOUNT`?`Pending Virtual Account`:`Setup Required`:`Loading...`),j=V(()=>n.value?n.value.active?`Auto-settlement enabled`:n.value.state===`PENDING_VIRTUAL_ACCOUNT`?`Awaiting virtual account creation`:`Add a settlement account to get started`:``),N=async()=>{try{t.value=!0,n.value=await $.getVaultStatus()}catch(e){console.error(`Failed to load vault status:`,e),n.value={state:`NOT_SETUP`,active:!1}}finally{t.value=!1}},I=async()=>{try{r.value=!0,i.value=await $.verifyChain()}catch(e){i.value={valid:!1,message:`Verification failed: `+e.message}}finally{r.value=!1}},R=async()=>{await $.exportJsonl()},z=async()=>{await $.exportCsv()},W=()=>{f.value=!0},G=async()=>{try{p.value=await xt.getSettlementAccounts()}catch(e){console.error(`Failed to load settlement accounts:`,e),p.value=[]}},K=()=>{N(),G()},q=e=>{a.value=e,s.value=!0},X=()=>{s.value=!1,setTimeout(()=>{a.value=null},300)};return k(()=>{N(),G()}),(e,p)=>(A(),d(`div`,Lt,[w(oe),_(`div`,Rt,[p[10]||=_(`div`,{class:`mb-8`},[_(`h1`,{class:`text-2xl font-bold text-white mb-2`},`Flow Vault`),_(`p`,{class:`text-white`},`Payment flow timeline and settlement events`)],-1),n.value?(A(),d(`div`,{key:0,class:l([`mb-6 p-4 rounded-xl border`,m.value])},[_(`div`,zt,[_(`div`,Bt,[_(`div`,{class:l([`w-10 h-10 rounded-full flex items-center justify-center`,y.value])},[(A(),v(U(E.value),{class:`w-5 h-5`}))],2),_(`div`,null,[_(`h3`,Vt,H(O.value),1),_(`p`,Ht,H(j.value),1)])]),n.value.settlementConfigured?(A(),d(`div`,Ut,[p[2]||=_(`div`,{class:`text-xs text-slate-400`},`Settlement destination`,-1),_(`div`,Wt,H(n.value.settlementBank)+` `+H(n.value.settlementAccountMasked),1)])):C(``,!0)])],2)):C(``,!0),t.value?(A(),d(`div`,Gt,[w(T(b),{class:`w-8 h-8 animate-spin text-white`})])):n.value?.state===`NEEDS_SETTLEMENT_ACCOUNT`||n.value?.state===`NOT_SETUP`?(A(),d(`div`,Kt,[_(`div`,qt,[w(T(c),{class:`w-10 h-10 text-stone-100 animate-pulse`,style:{"animation-duration":`7s !important`}})]),p[4]||=_(`h2`,{class:`text-xl font-semibold text-white mb-3`},` Add a settlement account to activate your Flow Vault `,-1),p[5]||=_(`p`,{class:`text-white max-w-md mx-auto mb-6`},` Incoming payments will be routed and settled automatically to your bank account. `,-1),w(T(Z),{onClick:W,class:`rounded-full px-6`},{default:P(()=>[w(T(o),{class:`w-4 h-4 mr-2`}),p[3]||=h(` Add Settlement Account `,-1)]),_:1})])):n.value?.active?(A(),d(x,{key:3},[_(`div`,Jt,[_(`div`,Yt,[_(`span`,Xt,H(n.value.blockCount)+` events recorded `,1)]),_(`div`,Zt,[w(T(Z),{variant:`outline`,size:`sm`,onClick:W,class:`rounded-full`},{default:P(()=>[w(T(L),{class:`w-4 h-4 mr-1`}),p[6]||=h(` Add Account `,-1)]),_:1}),w(T(Z),{variant:`outline`,size:`sm`,onClick:I,disabled:r.value,class:`rounded-full`},{default:P(()=>[w(T(D),{class:`w-4 h-4 mr-1`}),h(` `+H(r.value?`Verifying...`:`Verify Chain`),1)]),_:1},8,[`disabled`]),w(T(re),null,{default:P(()=>[w(T(ae),{asChild:``},{default:P(()=>[w(T(Z),{variant:`outline`,size:`sm`,class:`rounded-full`},{default:P(()=>[w(T(ee),{class:`w-4 h-4 mr-1`}),p[7]||=h(` Export `,-1)]),_:1})]),_:1}),w(T(ie),null,{default:P(()=>[w(T(Q),{onClick:R},{default:P(()=>[w(T(F),{class:`w-4 h-4 mr-2`}),p[8]||=h(` Export JSONL `,-1)]),_:1}),w(T(Q),{onClick:z},{default:P(()=>[w(T(B),{class:`w-4 h-4 mr-2`}),p[9]||=h(` Export CSV `,-1)]),_:1})]),_:1})]),_:1})])]),i.value?(A(),d(`div`,{key:0,class:l([`mb-4 p-3 rounded-lg flex items-center gap-2`,i.value.valid?`bg-emerald-50 text-emerald-700`:`bg-orange-50 text-orange-700`])},[(A(),v(U(i.value.valid?T(g):T(S)),{class:`w-5 h-5`})),_(`span`,Qt,H(i.value.message),1),_(`button`,{onClick:p[0]||=e=>i.value=null,class:`ml-auto`},[w(T(J),{class:`w-4 h-4`})])],2)):C(``,!0),_(`div`,$t,[w(Ue,{ref_key:`timelineRef`,ref:u,onEventClick:q},null,512)])],64)):C(``,!0)]),w(bt,{event:a.value,"is-open":s.value,onClose:X},null,8,[`event`,`is-open`]),w(It,{"is-open":f.value,onClose:p[1]||=e=>f.value=!1,onCreated:K},null,8,[`is-open`])]))}};export{en as default};