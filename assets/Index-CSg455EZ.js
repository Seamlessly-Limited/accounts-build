import"./useArrowNavigation-siWGBYoD.js";import"./ConfigProvider-XiUduj9F.js";import"./useDirection-DfJQtSIT.js";import"./useId-NOzKS8cd.js";import"./VisuallyHiddenInput-BqN-V-XI.js";import"./Label-CzpRcmGL.js";import{n as e,r as t,t as n}from"./PinInputSlot-DshxhLJY.js";import{At as r,Cn as i,Ct as a,Dt as o,Gt as s,Mt as c,Nt as l,Yt as u,an as d,i as f,kt as p,o as m,qt as h,r as g,xt as _}from"./index-NPUXaZ2c.js";import{n as v}from"./button-CWY_tBUh.js";import{t as y}from"./Label-DUIN8-hw.js";import{t as b}from"./Input-CanObgFQ.js";import"./Label-BXGkeRHd.js";import{t as x}from"./Card-CkOm-d7D.js";import{t as S}from"./CardContent-C61S8eSA.js";import{t as C}from"./CardDescription-CUZvq1_G.js";import{n as w,t as T}from"./CardTitle-CpwCOUXx.js";import{t as E}from"./BackgroundAnimation-tOT7YDvJ.js";import{a as D,i as O,n as k,r as A,t as j}from"./form-BeEtWzCt.js";var M={name:`PasswordResetView`,components:{Card:x,CardHeader:w,CardTitle:T,CardDescription:C,CardContent:S,Button:v,Input:b,Label:y,BackgroundAnimation:E,FormField:D,FormItem:k,FormLabel:j,FormControl:O,PinInput:t,PinInputGroup:e,PinInputSlot:n,FormDescription:A},data(){return{email:``,token:[],loading:!1,message:``,requestingReset:!0,resendCount:0,resendWaitTime:0}},computed:{formDisabled(){return this.loading||void 0}},methods:{paste(e){let t=(e.clipboardData||window.clipboardData).getData(`text`).trim();this.token=[``,...t.split(``)],t.length===6&&this.completeVerification()},focusNext(e,t){let n=`${e.target.value}`.trim();if(t===6&&n)return this.completeVerification();n.length===1&&t<6&&this.$refs[`otpInput`+(t+1)][0].focus(),n.length===0&&t>1&&this.$refs[`otpInput`+(t-1)][0].focus()},countDown(){this.resendWaitTime=60+this.resendCount;let e=setInterval(()=>--this.resendWaitTime,998);setTimeout(()=>{clearInterval(e),this.resendWaitTime=0},this.resendWaitTime*1e3)},async requestPasswordReset(){if(!this.email)return;this.loading=!0;let e=f();try{if(this.resendCount>90)return;let{message:t}=await m.requestPasswordReset(this.email);this.requestingReset=!1,this.resendCount+=30,this.countDown(),this.message=t,e.toast({message:t,variant:`success`,duration:5e3})}catch(t){e.toast({message:t.message,duration:5e3,variant:`error`})}this.loading=!1},async completeVerification(){let e=f(),t=``;try{if(t=this.token.reduce((e,t)=>`${e}${t}`),t.length<6)throw Error(`Invalid code provided!`)}catch{e.toast({message:`Invalid code provided!`,duration:5e3,variant:`error`});return}this.loading=!0;try{await m.validatePasswordReset(t),this.$router.push(`/password-reset/complete`)}catch(t){e.toast({message:t.message,duration:5e3,variant:`error`})}this.loading=!1}}},N={class:`min-h-screen flex flex-col items-center justify-center bg-stone-100 relative overflow-hidden`},P={key:0,class:`space-y-2 my-5`},F={class:`flex items-center gap-2`},I={key:1,class:`grid grid-cols-1 gap-2 mt-4 w-full`},L={class:`text-sm text-muted-foreground w-full`},R=[`innerHTML`],z={class:`flex justify-end mt-3`},B={key:0},V={key:1},H={key:2,class:`mt-4 text-sm text-gray-700`},U={key:0},W={key:1};function G(e,t,n,f,m,g){let v=u(`BackgroundAnimation`),y=u(`CardTitle`),b=u(`CardDescription`),x=u(`CardHeader`),S=u(`Label`),C=u(`Input`),w=u(`PinInputSlot`),T=u(`PinInputGroup`),E=u(`PinInput`),D=u(`FormControl`),O=u(`FormItem`),k=u(`FormField`),A=u(`Button`),j=u(`CardContent`),M=u(`Card`);return s(),r(`div`,N,[l(v),l(M,{class:`relative z-10 w-full max-w-lg rounded-2xl shadow-md border-solid border-slate-50 backdrop-blur bg-white/80`},{default:d(()=>[l(x,{class:`space-y-2`},{default:d(()=>[l(y,{class:`text-2xl font-semibold`},{default:d(()=>[...t[4]||=[c(`Reset your password`,-1)]]),_:1}),l(b,null,{default:d(()=>[...t[5]||=[c(`Secure your account with a new password.`,-1)]]),_:1})]),_:1}),l(j,{class:``},{default:d(()=>[o(`form`,{onSubmit:t[3]||=_(e=>m.requestingReset?g.requestPasswordReset():g.completeVerification(),[`prevent`])},[m.requestingReset?(s(),r(`div`,P,[l(S,{for:`email`},{default:d(()=>[...t[6]||=[c(`Email Address`,-1)]]),_:1}),o(`div`,F,[l(C,{id:`email`,type:`email`,placeholder:`The email address linked to your account`,modelValue:m.email,"onUpdate:modelValue":t[0]||=e=>m.email=e,disabled:g.formDisabled,required:``,class:`flex-1 rounded-full`},null,8,[`modelValue`,`disabled`])])])):(s(),r(`div`,I,[l(k,null,{default:d(()=>[l(O,null,{default:d(()=>[l(D,null,{default:d(()=>[l(E,{class:`rounded-full`,id:`pin-input`,modelValue:m.token,"onUpdate:modelValue":t[1]||=e=>m.token=e,placeholder:`○`,onComplete:g.completeVerification},{default:d(()=>[l(T,null,{default:d(()=>[(s(),r(a,null,h(6,(e,t)=>l(w,{key:e,index:t},null,8,[`index`])),64))]),_:1})]),_:1},8,[`modelValue`,`onComplete`])]),_:1})]),_:1})]),_:1}),o(`div`,L,[o(`p`,{class:`text-xs`,innerHTML:m.message},null,8,R)])])),o(`div`,z,[l(A,{type:`submit`,disabled:m.loading,class:`bg-black text-white rounded-full hover:bg-gray-800`},{default:d(()=>[m.loading?(s(),r(`span`,V,`Processing...`)):(s(),r(`span`,B,`Continue`))]),_:1},8,[`disabled`])]),m.requestingReset?p(``,!0):(s(),r(`div`,H,[m.resendWaitTime==0?(s(),r(`span`,U,[t[7]||=c(` Didn’t get an email? `,-1),o(`span`,{class:`text-blue-600 font-semibold cursor-pointer`,onClick:t[2]||=(...e)=>g.requestPasswordReset&&g.requestPasswordReset(...e)},` Request another code `)])):(s(),r(`span`,W,`Try again in `+i(m.resendWaitTime)+`s`,1))]))],32)]),_:1})]),_:1}),t[8]||=o(`div`,{class:`mt-4 text-end w-full max-w-lg px-2`},[o(`p`,{class:`text-xs`},[c(` Can’t access your email? `),o(`a`,{href:`https://seamlessly.ng/contact`,class:`text-blue-600 font-semibold`},`Contact Us`)])],-1)])}var K=g(M,[[`render`,G]]);export{K as default};