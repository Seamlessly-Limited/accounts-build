import{Gi as e,Hi as t,Ki as n,Oa as r,Pa as i,Ra as a,Ui as o,Vi as s,Wi as c,a as l,i as u,ia as d,n as f,oa as p,r as m,zt as h}from"./index-CTHZVx0Q.js";import{t as g}from"./OrganisationService-CcVH0X3p.js";import{t as _}from"./icon-DOyG2O4c.js";var v={class:`min-h-screen flex items-center justify-center relative overflow-hidden`},y={class:`container mx-auto px-4 relative z-10`},b={class:`max-w-lg mx-auto`},x={class:`bg-white shadow-xl rounded-2xl p-10 flex flex-col items-center text-center animate-slide-up`},S={key:0},C={key:1},w={key:2},T={key:3},E={class:`text-gray-600 mb-4`},D={class:`font-semibold text-primary`},O={class:`italic`},k=[`disabled`],A=u({__name:`Invite`,setup(u){let _=l().toast,A=f(),j=m(),M=r(!0),N=r(!1),P=r(!1),F=r(!1),I=r(``),L=r(``),R=r(``),z=A.params.reference;d(async()=>{try{if(!JSON.parse(localStorage.getItem(`user`)||`{}`).name)return localStorage.setItem(`postAuthenticationPath`,j.currentRoute.value.path),j.push(`/login`);let{data:e}=await g.getMember(z);I.value=e.name,L.value=e.role,R.value=e.email,M.value=!1}catch(e){M.value=!1,e.response&&e.response.status===403?F.value=!0:(P.value=!0,setTimeout(()=>{j.push(`/`)},5e3))}});async function B(){if(!N.value){N.value=!0;try{let{data:e}=await g.updateMember(z,{acceptInvite:!0});e.status==`ACTIVE`&&(localStorage.setItem(`organisation`,JSON.stringify(e)),localStorage.setItem(`organisation.reference`,e.reference),window.location=`/`)}catch{_({duration:5e3,title:`Heads Up!`,message:`We encountered an error accepting this invitation. Please check your network `,variant:`error`}),N.value=!1}}}function V(){localStorage.clear(),window.location=`/login`}return(r,l)=>(p(),c(`div`,v,[l[8]||=s(`div`,{class:`absolute inset-0 bg-slate-950/10 animate-fade-in`},null,-1),s(`div`,y,[s(`div`,b,[s(`div`,x,[l[7]||=s(`div`,{class:`w-24 h-24 rounded-full bg-white shadow ring-1 ring-slate-200 flex items-center justify-center mb-6`},[s(`img`,{src:`/img/icon.png`,class:`w-16 h-16`,alt:`App Icon`})],-1),M.value?(p(),c(`div`,S,[...l[0]||=[s(`h2`,{class:`text-xl font-semibold mb-2`},`Checking your invitation...`,-1),s(`div`,{class:`flex justify-center pt-10`},[s(`div`,{class:`loader`})],-1)]])):P.value?(p(),c(`div`,C,[...l[1]||=[e(`<h2 class="text-xl font-semibold text-red-600 mb-2" data-v-fd3191f9> Invitation Invalid </h2><p class="text-gray-500" data-v-fd3191f9> This invitation link is no longer valid. Please request a new one from the organisation admin. </p><p class="text-gray-700 mt-3" data-v-fd3191f9> You are being redirected back in. </p><div class="flex justify-center pt-10" data-v-fd3191f9><div class="loader" data-v-fd3191f9></div></div>`,4)]])):F.value?(p(),c(`div`,w,[l[2]||=s(`h2`,{class:`text-xl font-semibold text-amber-600 mb-2`},` Wrong Account `,-1),l[3]||=s(`p`,{class:`text-gray-500`},` This invitation is intended for another email address. You are currently logged in as a different user. `,-1),s(`button`,{onClick:V,class:`inline-flex items-center justify-center rounded-full mt-6 px-5 pt-1 pb-1.5 border border-slate-300 bg-white text-slate-700 font-semibold hover:bg-slate-50 transition`},` Log Out & Switch Account `)])):(p(),c(`div`,T,[l[6]||=s(`h2`,{class:`text-2xl font-semibold mb-3`},`Youâ€™ve Been Invited`,-1),s(`p`,E,[l[4]||=n(` You have been invited to join `,-1),s(`span`,D,a(I.value),1),n(` as `+a([`MANAGER`,`MEMBER`].includes(L.value)?`a`:`an`)+` `,1),s(`span`,O,a(L.value),1),l[5]||=n(`. `,-1)]),s(`button`,{onClick:B,disabled:N.value,class:`inline-flex items-center justify-center rounded-full mt-6 px-5 pt-1 pb-1.5 bg-primary text-white font-semibold hover:bg-primary-dark transition disabled:opacity-70 disabled:cursor-not-allowed`},[N.value?(p(),t(i(h),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):o(``,!0),n(` `+a(N.value?`Accepting...`:`Accept Invitation`),1)],8,k)]))])])])]))}},[[`__scopeId`,`data-v-fd3191f9`]]);export{A as default};