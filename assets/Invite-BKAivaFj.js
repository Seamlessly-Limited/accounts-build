import{Aa as e,Bi as t,Hi as n,It as r,Li as i,Pa as a,Ri as o,Vi as s,a as c,ea as l,i as u,n as d,na as f,r as p,wa as m,zi as h}from"./index-BW6FH5S4.js";import{t as g}from"./OrganisationService-DlrS9wAG.js";import{t as _}from"./icon-DF1ERNnj.js";var v={class:`min-h-screen flex items-center justify-center relative overflow-hidden`},y={class:`container mx-auto px-4 relative z-10`},b={class:`max-w-lg mx-auto`},x={class:`bg-white shadow-xl rounded-2xl p-10 flex flex-col items-center text-center animate-slide-up`},S={key:0},C={key:1},w={key:2},T={key:3},E={class:`text-gray-600 mb-4`},D={class:`font-semibold text-primary`},O={class:`italic`},k=[`disabled`],A=u({__name:`Invite`,setup(u){let _=c().toast,A=d(),j=p(),M=m(!0),N=m(!1),P=m(!1),F=m(!1),I=m(``),L=m(``),R=m(``),z=A.params.reference;l(async()=>{try{if(!JSON.parse(localStorage.getItem(`user`)||`{}`).name)return localStorage.setItem(`postAuthenticationPath`,j.currentRoute.value.path),j.push(`/login`);let{data:e}=await g.getMember(z);I.value=e.name,L.value=e.role,R.value=e.email,M.value=!1}catch(e){M.value=!1,e.response&&e.response.status===403?F.value=!0:(P.value=!0,setTimeout(()=>{j.push(`/`)},5e3))}});async function B(){if(!N.value){N.value=!0;try{let{data:e}=await g.updateMember(z,{acceptInvite:!0});e.status==`ACTIVE`&&(localStorage.setItem(`organisation`,JSON.stringify(e)),localStorage.setItem(`organisation.reference`,e.reference),window.location=`/`)}catch(e){_({duration:5e3,title:`Heads Up!`,message:e.message||`We encountered an error accepting this invitation. Please check your network `,variant:`error`}),N.value=!1}}}function V(){localStorage.clear(),window.location=`/login`}return(c,l)=>(f(),t(`div`,v,[l[8]||=i(`div`,{class:`absolute inset-0 bg-slate-950/10 animate-fade-in`},null,-1),i(`div`,y,[i(`div`,b,[i(`div`,x,[l[7]||=i(`div`,{class:`w-24 h-24 rounded-full bg-white shadow ring-1 ring-slate-200 flex items-center justify-center mb-6`},[i(`img`,{src:`/img/icon.png`,class:`w-16 h-16`,alt:`App Icon`})],-1),M.value?(f(),t(`div`,S,[...l[0]||=[i(`h2`,{class:`text-xl font-semibold mb-2`},`Checking your invitation...`,-1),i(`div`,{class:`flex justify-center pt-10`},[i(`div`,{class:`loader`})],-1)]])):P.value?(f(),t(`div`,C,[...l[1]||=[s(`<h2 class="text-xl font-semibold text-red-600 mb-2" data-v-544f0499> Invitation Invalid </h2><p class="text-gray-500" data-v-544f0499> This invitation link is no longer valid. Please request a new one from the organisation admin. </p><p class="text-gray-700 mt-3" data-v-544f0499> You are being redirected back in. </p><div class="flex justify-center pt-10" data-v-544f0499><div class="loader" data-v-544f0499></div></div>`,4)]])):F.value?(f(),t(`div`,w,[l[2]||=i(`h2`,{class:`text-xl font-semibold text-amber-600 mb-2`},` Wrong Account `,-1),l[3]||=i(`p`,{class:`text-gray-500`},` This invitation is intended for another email address. You are currently logged in as a different user. `,-1),i(`button`,{onClick:V,class:`inline-flex items-center justify-center rounded-full mt-6 px-5 pt-1 pb-1.5 border border-slate-300 bg-white text-slate-700 font-semibold hover:bg-slate-50 transition`},` Log Out & Switch Account `)])):(f(),t(`div`,T,[l[6]||=i(`h2`,{class:`text-2xl font-semibold mb-3`},`Youâ€™ve Been Invited`,-1),i(`p`,E,[l[4]||=n(` You have been invited to join `,-1),i(`span`,D,a(I.value),1),n(` as `+a([`MANAGER`,`MEMBER`].includes(L.value)?`a`:`an`)+` `,1),i(`span`,O,a(L.value),1),l[5]||=n(`. `,-1)]),i(`button`,{onClick:B,disabled:N.value,class:`inline-flex items-center justify-center rounded-full mt-6 px-5 pt-1 pb-1.5 bg-primary text-white font-semibold hover:bg-primary-dark transition disabled:opacity-70 disabled:cursor-not-allowed`},[N.value?(f(),o(e(r),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):h(``,!0),n(` `+a(N.value?`Accepting...`:`Accept Invitation`),1)],8,k)]))])])])]))}},[[`__scopeId`,`data-v-544f0499`]]);export{A as default};