import { $i as e, Ea as t, Fi as n, Gn as r, Li as i, Mi as a, Ni as o, Nn as ee, Oi as s, Pi as c, Ri as l, Ta as u, Yi as d, Zi as f, a as p, ct as m, da as h, ji as g, ka as _, lt as v, wn as y, ya as b } from "./index-CHNvwQRL.js"; import { n as x, t as S } from "./DialogContent-BczLmPtx.js"; import { n as C, r as w, t as T } from "./DialogTitle-Dz9VmaLr.js"; import { t as E } from "./DialogFooter-DcKhuorP.js"; import { t as D } from "./button-BRhnnMH3.js"; import { t as O } from "./OrganisationService-DLV_nwEW.js"; import { t as k } from "./Card-BJPZ_LNY.js"; import { t as A } from "./CardContent-B3hEl7e8.js"; import { n as j, r as M, t as N } from "./CardTitle-Btl171BV.js"; import { t as P } from "./badge-BQsIJJpl.js"; var F = { class: `space-y-8` }, I = { class: `flex items-start justify-between` }, te = { class: `flex flex-col sm:flex-row gap-4` }, ne = { key: 0, class: `space-y-4` }, re = { class: `flex items-center justify-between` }, ie = { class: `flex items-start gap-4 flex-1` }, ae = { class: `p-3 rounded-full bg-slate-100 dark:bg-slate-900` }, oe = { class: `flex-1` }, se = { class: `flex items-center gap-2` }, ce = { class: `font-semibold text-gray-900 dark:text-white` }, le = { class: `text-sm text-gray-500 dark:text-gray-400 mt-1` }, ue = { key: 0, class: `text-xs text-gray-400 dark:text-gray-500 mt-1` }, de = { class: `text-right` }, fe = { class: `text-lg font-bold text-gray-900 dark:text-white` }, pe = { class: `flex justify-center my-6` }, me = { class: `rounded-full bg-stone-100 text-blue-950 px-0.5 py-0.5 w-fit inline-flex items-center` }, L = { class: `grid md:grid-cols-3 gap-6` }, R = { class: `mb-4` }, he = { class: `text-lg font-bold text-gray-900 dark:text-white` }, ge = { class: `text-xs text-gray-500 dark:text-gray-400 mt-1` }, _e = { class: `mb-4` }, ve = { class: `text-3xl font-bold text-gray-900 dark:text-white` }, ye = { class: `text-gray-500 dark:text-gray-400` }, be = { class: `space-y-2 mb-6 flex-1 text-sm` }, xe = { class: `text-xs text-gray-600 dark:text-gray-300` }, z = { __name: `ActiveSubscription`, props: { subscription: { type: Object, required: !0 }, payments: { type: Array, default: () => [] }, plans: { type: Array, required: !0 }, isYearly: { type: Boolean, default: !1 } }, emits: [`subscription-updated`, `subscription-cancelled`], setup(d, { emit: E }) { let z = p().toast, B = d, V = E, H = b(!1), U = b(!1), W = b(B.isYearly), G = g(() => B.subscription ? B.subscription.plan || B.subscription.planName || `Current Plan` : `No Plan`), K = g(() => B.subscription ? (B.subscription.duration || B.subscription.billingCycle) === `YEARLY` ? `Billed Yearly` : `Billed Monthly` : ``), q = g(() => { let e = B.subscription?.status?.toLowerCase(); return e === `active` ? `default` : e === `cancelled` || e === `expired` ? `destructive` : e === `expiring` ? `warning` : `secondary` }); function J(e) { return e ? Number(e).toLocaleString(`en-NG`, { minimumFractionDigits: 0, maximumFractionDigits: 0 }) : `0` } function Y(e) { return B.subscription ? (B.subscription.plan || B.subscription.planType) === e.planType : !1 } async function X(e) { H.value = !0; try { let t = W.value ? e.idYearly : e.idMonthly, n = W.value ? e.priceYearly : e.priceMonthly, r = W.value ? `YEARLY` : `MONTHLY`; window.FlutterwaveCheckout || await Z(); let i = JSON.parse(localStorage.getItem(`user`) || `{}`), a = i.email || `user@example.com`, o = i.name || `User`; window.FlutterwaveCheckout({ public_key: `FLWPUBK_TEST-SANDBOXDEMOKEY-X`, tx_ref: `SUB-CHANGE-${Date.now()}-${t}`, amount: n, currency: `NGN`, payment_plan: t, payment_options: `card,banktransfer,ussd`, customer: { email: a, name: o }, customizations: { title: `Change Subscription Plan`, description: `${e.name} - ${r}`, logo: `https://seamlessly.ng/logo.png` }, callback: async function (t) { if (t.status === `successful`) try { await O.setSubscription({ "payment.reference": `${t.transaction_id}`, "payment.provider": `FLUTTERWAVE`, plan: e.planType, duration: `${r}` }), z({ title: `Success`, message: `Subscription plan changed successfully!`, variant: `success` }), U.value = !1, V(`subscription-updated`) } catch (e) { z({ title: `Error`, message: e.message || `Failed to update subscription.`, variant: `error` }) } else z({ title: `Payment Failed`, message: `Your payment was not successful. Please try again.`, variant: `error` }); H.value = !1 }, onclose: function () { H.value = !1 } }) } catch (e) { z({ title: `Error`, message: e.message || `Failed to initiate plan change.`, variant: `error` }), H.value = !1 } } function Z() { return new Promise((e, t) => { if (window.FlutterwaveCheckout) { e(); return } let n = document.createElement(`script`); n.src = `https://checkout.flutterwave.com/v3.js`, n.onload = e, n.onerror = t, document.head.appendChild(n) }) } async function Q() { if (confirm(`Are you sure you want to cancel your subscription? You'll lose access to premium features at the end of your billing period.`)) { H.value = !0; try { await O.cancelSubscription(), z({ title: `Cancelled`, message: `Subscription cancelled successfully. You'll retain access until the end of your billing period.`, variant: `success` }), V(`subscription-cancelled`), window.location.reload() } catch (e) { z({ title: `Error`, message: e.message || `Failed to cancel subscription.`, variant: `error` }) } finally { H.value = !1 } } } async function $(e) { try { let t = await O.downloadReceipt(e); t.data && t.data.url ? window.open(t.data.url, `_blank`) : z({ title: `Error`, message: `Receipt download link not found.`, variant: `error` }) } catch { z({ title: `Error`, message: `Failed to download receipt.`, variant: `error` }) } } return (p, g) => (f(), n(`div`, F, [l(k, { class: `overflow-hidden` }, { default: h(() => [l(j, { class: `bg-gradient-to-r from-primary-50 to-primary-100 dark:from-gray-800 dark:to-gray-700` }, { default: h(() => [a(`div`, I, [a(`div`, null, [l(N, { class: `text-2xl` }, { default: h(() => [i(_(G.value), 1)]), _: 1 }), l(M, { class: `mt-2` }, { default: h(() => [i(_(K.value), 1)]), _: 1 })]), l(P, { variant: q.value, class: `text-sm` }, { default: h(() => [i(_(d.subscription?.status || `Active`), 1)]), _: 1 }, 8, [`variant`])])]), _: 1 }), l(A, { class: `pt-6` }, { default: h(() => [a(`div`, te, [l(D, { onClick: g[0] ||= e => U.value = !0, class: `flex-1 rounded-full bg-black dark:bg-white dark:text-black text-white hover:bg-gray-800 dark:hover:bg-gray-100`, disabled: H.value }, { default: h(() => [l(u(y), { class: `mr-2 h-4 w-4` }), g[4] ||= i(` Change Plan `, -1)]), _: 1 }, 8, [`disabled`]), l(D, { onClick: Q, variant: `outline`, class: `flex-1 rounded-full border-gray-300 text-gray-600 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-950`, disabled: H.value }, { default: h(() => [l(u(ee), { class: `mr-2 h-4 w-4` }), g[5] ||= i(` Cancel Subscription `, -1)]), _: 1 }, 8, [`disabled`])])]), _: 1 })]), _: 1 }), a(`div`, null, [g[7] ||= a(`h2`, { class: `text-2xl font-bold text-gray-900 dark:text-white mb-4` }, `Payment History`, -1), d.payments && d.payments.length > 0 ? (f(), n(`div`, ne, [(f(!0), n(s, null, e(d.payments, e => (f(), o(k, { key: e.id, class: `hover:shadow-md transition-shadow` }, { default: h(() => [l(A, { class: `pt-6` }, { default: h(() => [a(`div`, re, [a(`div`, ie, [a(`div`, ae, [l(u(v), { class: `h-5 w-5 text-blue-600 dark:text-blue-400` })]), a(`div`, oe, [a(`div`, se, [a(`h3`, ce, _(e.plan || `Subscription Payment`), 1), l(P, { variant: `outline`, class: `text-xs` }, { default: h(() => [i(_(e.status || `Completed`), 1)]), _: 2 }, 1024)]), a(`p`, le, ` Completed on ` + _(e.timeCompleted), 1), e.reference ? (f(), n(`p`, ue, ` Ref: ` + _(e.reference), 1)) : c(``, !0)])]), a(`div`, de, [a(`p`, fe, ` ₦` + _(J(e.amountPaid)), 1), e.id ? (f(), o(D, { key: 0, onClick: t => $(e.id), variant: `ghost`, size: `sm`, class: `mt-2 text-xs` }, null, 8, [`onClick`])) : c(``, !0)])])]), _: 2 }, 1024)]), _: 2 }, 1024))), 128))])) : (f(), o(k, { key: 1, class: `shadow-md` }, { default: h(() => [l(A, { class: `pt-12 pb-12 text-center` }, { default: h(() => [l(u(m), { class: `h-12 w-12 text-gray-400 mx-auto mb-4` }), g[6] ||= a(`p`, { class: `text-gray-500 dark:text-gray-400` }, `No payment history yet`, -1)]), _: 1 })]), _: 1 }))]), l(x, { open: U.value, "onUpdate:open": g[3] ||= e => U.value = e }, { default: h(() => [l(S, { class: `max-w-5xl max-h-[90vh] overflow-y-auto` }, { default: h(() => [l(C, null, { default: h(() => [l(T, { class: `text-2xl` }, { default: h(() => [...g[8] ||= [i(`Change Your Plan`, -1)]]), _: 1 }), l(w, null, { default: h(() => [...g[9] ||= [i(` Select a new plan to upgrade or downgrade your subscription `, -1)]]), _: 1 })]), _: 1 }), a(`div`, pe, [a(`div`, me, [a(`button`, { onClick: g[1] ||= e => W.value = !1, class: t([`rounded-full px-4 py-0.5 w-fit font-medium transition-all`, W.value ? `text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white` : `bg-stone-50 dark:bg-gray-700 shadow-sm text-gray-900 dark:text-white`]) }, ` Monthly `, 2), a(`button`, { onClick: g[2] ||= e => W.value = !0, class: t([`rounded-full bg-stone-100 text-blue-950 px-4 py-0.5 w-fit font-medium transition-all`, W.value ? `bg-stone-50 dark:bg-gray-700 shadow-sm text-gray-900 dark:text-white` : `text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white`]) }, [...g[10] ||= [i(` Yearly `, -1), a(`span`, { class: `ml-2 text-xs text-green-600 font-bold` }, `-17%`, -1)]], 2)])]), a(`div`, L, [(f(!0), n(s, null, e(d.plans, o => (f(), n(`div`, { key: o.name, class: `relative flex flex-col p-6 bg-white dark:bg-gray-800 rounded-sm border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow` }, [a(`div`, R, [a(`h3`, he, _(o.name), 1), a(`p`, ge, _(o.description), 1)]), a(`div`, _e, [a(`span`, ve, ` ₦` + _(J(W.value ? o.priceYearly : o.priceMonthly)), 1), a(`span`, ye, `/` + _(W.value ? `year` : `month`), 1)]), a(`ul`, be, [(f(!0), n(s, null, e(o.features.slice(0, 6), e => (f(), n(`li`, { key: e, class: `flex items-start` }, [l(u(r), { class: `h-4 w-4 text-green-500 mr-2 flex-shrink-0 mt-0.5` }), a(`span`, xe, _(e), 1)]))), 128))]), l(D, { onClick: e => X(o), disabled: H.value || Y(o), class: t([`w-full rounded-full font-semibold transition-colors`, Y(o) ? `bg-gray-100 dark:bg-gray-700 text-gray-400 cursor-not-allowed` : `bg-black hover:bg-gray-800 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100`]) }, { default: h(() => [i(_(Y(o) ? `Current Plan` : `Select Plan`), 1)]), _: 2 }, 1032, [`onClick`, `disabled`, `class`])]))), 128))])]), _: 1 })]), _: 1 }, 8, [`open`])])) } }, B = { class: `container mx-auto py-10 px-4 max-w-7xl` }, V = { key: 1 }, H = { class: `flex justify-center mb-10` }, U = { class: `rounded-full bg-stone-100 text-blue-950 px-0.5 py-0.5 w-fit inline-flex items-center` }, W = { class: `grid md:grid-cols-3 gap-8 mb-20` }, G = { class: `mb-6` }, K = { class: `text-xl font-bold text-gray-900 dark:text-white` }, q = { class: `text-sm text-gray-500 dark:text-gray-400 mt-2` }, J = { class: `mb-6` }, Y = { class: `text-4xl font-bold text-gray-900 dark:text-white` }, X = { class: `text-gray-500 dark:text-gray-400` }, Z = { class: `space-y-4 mb-8 flex-1` }, Q = { class: `text-sm text-gray-600 dark:text-gray-300` }, $ = { __name: `Billing`, setup(ee) { let c = p().toast, m = b(!1), g = b(!1), v = b(null), y = b([]), k = b(!1), A = [{ name: `Basic`, message: `Good for starters and mom-&-pop shops.`, priceMonthly: 14500, priceYearly: 145e3, idMonthly: 227736, idYearly: 227736, planType: `BASIC`, features: [`Transactions categorization`, `Financial statements`, `Custom dashboards`, `AI assisted planning`, `Human support`, `1 Bank account sync (NG)`, `Single user access`, `500 transactions per month`, `Bulk data export`, `Third Party integration`, `Cashflow forecast`, `Monthly Budget`, `Tax forms completion`] }, { name: `SME/NGO`, message: `Perfect for growing businesses.`, priceMonthly: 44500, priceYearly: 445e3, idMonthly: 227738, idYearly: 227739, planType: `SME_NGO`, features: [`Transactions categorization`, `Financial statements`, `Custom dashboards`, `AI assisted planning`, `Live human support`, `5 Bank account sync (NG)`, `Infinite user access`, `1,000 transactions per month`, `Bulk data export`, `Third party integration`, `Cashflow forecast`, `Monthly Budget`, `Tax forms completion`] }, { name: `Business`, message: `Deploy large-scale reconciliations.`, priceMonthly: 1e5, priceYearly: 1e6, idMonthly: 227740, idYearly: 227741, planType: `BUSINESS`, features: [`Transactions categorization`, `Financial statements`, `Custom dashboards`, `AI assisted planning`, `Live support`, `15 Bank account sync (NG)`, `Infinite user access`, `4,500 transactions per month`, `Bulk data export`, `Third party integration`, `Cashflow forecast`, `Monthly Budget`, `Tax forms completion`] }]; d(async () => { await j() }); async function j() { try { let [e, t] = await Promise.all([O.getSubscription().catch(() => null), O.getPayments().catch(() => [])]); e && e.data && (v.value = e.data), t && t.data ? y.value = t.data : Array.isArray(t) && (y.value = t) } catch { } } async function M(e) { g.value = !0; try { let t = m.value ? e.idYearly : e.idMonthly, n = m.value ? e.priceYearly : e.priceMonthly, r = m.value ? `YEARLY` : `MONTHLY`; window.FlutterwaveCheckout || await N(); let i = JSON.parse(localStorage.getItem(`user`) || `{}`), a = i.email || `user@example.com`, o = i.name || `User`; window.FlutterwaveCheckout({ public_key: `FLWPUBK_TEST-SANDBOXDEMOKEY-X`, tx_ref: `SUB-${Date.now()}-${t}`, amount: n, currency: `NGN`, payment_plan: t, payment_options: `card,banktransfer,ussd`, customer: { email: a, name: o }, customizations: { title: `Seamlessly Subscription`, message: `${e.name} - ${r}`, logo: `https://seamlessly.ng/logo.png` }, callback: async function (t) { if (t.status === `successful`) try { await O.setSubscription({ "payment.reference": `${t.transaction_id}`, "payment.provider": `FLUTTERWAVE`, plan: e.planType, duration: `${r}` }), c({ title: `Welcome!`, message: `Your subscription has been activated successfully!`, variant: `success` }), setTimeout(() => { window.location.reload() }, 5e3) } catch (e) { c({ title: `Error`, message: e.message || `Failed to activate subscription.`, variant: `error` }) } else c({ title: `Payment Failed`, message: `Your payment was not successful. Please try again.`, variant: `error` }); g.value = !1 }, onclose: function () { g.value = !1 } }) } catch (e) { c({ title: `Subscription Error`, message: e.message || `Failed to initiate subscription.`, variant: `error` }), g.value = !1 } } function N() { return new Promise((e, t) => { if (window.FlutterwaveCheckout) { e(); return } let n = document.createElement(`script`); n.src = `https://checkout.flutterwave.com/v3.js`, n.onload = e, n.onerror = t, document.head.appendChild(n) }) } async function P() { g.value = !0; try { await O.cancelSubscription(), c({ title: `Cancelled`, message: `Subscription cancelled successfully.`, variant: `success` }), v.value = null, await j(), k.value = !1 } catch (e) { c({ title: `Error`, message: e.message || `Failed to cancel subscription.`, variant: `error` }) } finally { g.value = !1 } } function F(e) { return Number(e).toLocaleString(`en-NG`, { minimumFractionDigits: 0, maximumFractionDigits: 0 }) } function I(e) { if (!v.value) return !1; let t = m.value ? e.idYearly : e.idMonthly; return v.value.planId === t || v.value.planName === e.name } return (ee, c) => (f(), n(s, null, [a(`div`, B, [v.value ? (f(), o(z, { key: 0, subscription: v.value, payments: y.value, plans: A, "is-yearly": m.value, onSubscriptionUpdated: j, onSubscriptionCancelled: j }, null, 8, [`subscription`, `payments`, `is-yearly`])) : (f(), n(`div`, V, [c[5] ||= a(`div`, { class: `text-center mb-8` }, [a(`h1`, { class: `text-4xl font-bold tracking-tight text-gray-900 dark:text-white mb-4` }, ` Simple Pricing - Zero Exclusion `), a(`p`, { class: `text-lg text-gray-600 dark:text-gray-400` }, [i(` Every plan is premium and gives access to `), a(`strong`, null, `SIMI`), i(` (your consultant). `)])], -1), a(`div`, H, [a(`div`, U, [a(`button`, { onClick: c[0] ||= e => m.value = !1, class: t([`rounded-full px-4 py-0.5 w-fit font-medium transition-all`, m.value ? `text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white` : `bg-stone-50 dark:bg-gray-700 shadow-sm text-gray-900 dark:text-white`]) }, ` Monthly `, 2), a(`button`, { onClick: c[1] ||= e => m.value = !0, class: t([`rounded-full bg-stone-100 text-blue-950 px-4 py-0.5 w-fit font-medium transition-all`, m.value ? `bg-stone-50 dark:bg-gray-700 shadow-sm text-gray-900 dark:text-white` : `text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white`]) }, [...c[4] ||= [i(` Yearly `, -1), a(`span`, { class: `ml-2 text-xs text-green-600 font-bold` }, `-17%`, -1)]], 2)])]), a(`div`, W, [(f(), n(s, null, e(A, o => a(`div`, { key: o.name, class: `relative flex flex-col p-8 bg-white dark:bg-gray-800 rounded-sm border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow` }, [a(`div`, G, [a(`h3`, K, _(o.name), 1), a(`p`, q, _(o.message), 1)]), a(`div`, J, [a(`span`, Y, `₦` + _(F(m.value ? o.priceYearly : o.priceMonthly)), 1), a(`span`, X, `/` + _(m.value ? `year` : `month`), 1)]), a(`ul`, Z, [(f(!0), n(s, null, e(o.features, e => (f(), n(`li`, { key: e, class: `flex items-start` }, [l(u(r), { class: `h-5 w-5 text-green-500 mr-3 flex-shrink-0` }), a(`span`, Q, _(e), 1)]))), 128))]), l(D, { onClick: e => M(o), disabled: g.value || I(o), class: t([`w-full rounded-full font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500`, I(o) ? `bg-gray-100 dark:bg-gray-700 text-gray-400 cursor-not-allowed` : `bg-primary-600 hover:bg-primary-700 text-white bg-black dark:bg-white dark:text-black`]) }, { default: h(() => [i(_(I(o) ? `Current Plan` : `Subscribe`), 1)]), _: 2 }, 1032, [`onClick`, `disabled`, `class`])])), 64))])]))]), l(u(x), { open: k.value, "onUpdate:open": c[3] ||= e => k.value = e }, { default: h(() => [l(u(S), { class: `sm:max-w-md bg-white` }, { default: h(() => [l(u(C), null, { default: h(() => [l(u(T), null, { default: h(() => [...c[6] ||= [i(`Cancel Subscription`, -1)]]), _: 1 }), l(u(w), null, { default: h(() => [...c[7] ||= [i(` Are you sure you want to cancel your subscription? You will lose access to premium features at the end of your billing period. `, -1)]]), _: 1 })]), _: 1 }), l(u(E), { class: `gap-2 sm:gap-0` }, { default: h(() => [l(D, { variant: `outline`, onClick: c[2] ||= e => k.value = !1 }, { default: h(() => [...c[8] ||= [i(`Keep Subscription`, -1)]]), _: 1 }), l(D, { variant: `destructive`, onClick: P, disabled: g.value }, { default: h(() => [i(_(g.value ? `Cancelling...` : `Confirm Cancellation`), 1)]), _: 1 }, 8, [`disabled`])]), _: 1 })]), _: 1 })]), _: 1 }, 8, [`open`])], 64)) } }; export { $ as t };