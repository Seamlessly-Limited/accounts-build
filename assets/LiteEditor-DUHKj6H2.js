import{Bi as e,G as t,Hi as n,Ki as r,Li as i,Mi as a,Oa as o,Pa as s,Ra as c,Ui as l,Vi as u,Wi as d,ca as f,h as p,ia as m,o as h,oa as g,qi as _,xa as v,zt as y}from"./index-CTHZVx0Q.js";import{t as b}from"./WorkspaceStore-gf1m868h.js";var x={class:`h-full flex flex-col`},S={class:`flex-none px-6 py-4 border-b border-gray-100 flex items-center justify-between`},C={class:`flex items-center space-x-4`},w={class:`p-2 rounded-lg bg-blue-50`},T={class:`text-sm text-gray-500`},E={class:`flex-1 overflow-auto p-6 bg-gray-50`},D={class:`max-w-2xl mx-auto bg-white rounded-xl border border-gray-200 shadow-sm p-6`},O={key:0,class:`flex justify-center py-12`},k={key:1,class:`text-red-600 py-8 text-center`},A={key:2,class:`space-y-6`},j={class:`border-b border-gray-100 pb-4`},M={class:`text-2xl font-bold text-gray-900`},N={class:`text-sm text-gray-500 mt-1`},P={class:`space-y-4`},F={class:`text-sm font-medium text-gray-700`},I=[`onUpdate:modelValue`],L={key:0,class:`text-center py-8 text-gray-400`},R={key:0,class:`flex justify-end pt-4 border-t border-gray-100`},z=[`disabled`],B={__name:`LiteEditor`,props:{doctype:{type:String,required:!0},name:{type:String,required:!0}},setup(B){let V=B,{toast:H}=p(),U=b(),W=o(!0),G=o(!1),K=o(null),q=o({}),J=o({}),Y=e(()=>J.value.fields?J.value.fields.filter(e=>[`DATA`,`TEXT`,`SMALL_TEXT`].includes(e.fieldtype)&&!e.read_only).slice(0,5):[]);m(async()=>{await X()});async function X(){W.value=!0,K.value=null;try{let e=await h.get(`/org/doc/${encodeURIComponent(V.doctype)}/${encodeURIComponent(V.name)}`,{authorizeRequest:!0,organisationAware:!0});q.value=e.data||e;let t=await h.get(`/org/doctypes/${encodeURIComponent(V.doctype)}`,{authorizeRequest:!0,organisationAware:!0});J.value=t.data||t}catch(e){console.error(`Lite editor fetch error:`,e),K.value=`Failed to load document: `+e.message}finally{W.value=!1}}async function Z(){G.value=!0;try{await h.patch(`/org/doc/${encodeURIComponent(V.doctype)}/${encodeURIComponent(V.name)}`,{data:q.value,authorizeRequest:!0,organisationAware:!0}),H({title:`Saved`,description:`Document updated successfully.`,variant:`success`}),U.notifyDocSaved(V.doctype,V.name)}catch(e){console.error(`Save error:`,e),H({title:`Save Failed`,description:e.message,variant:`destructive`})}finally{G.value=!1}}function Q(){U.openTab({id:`doctype-form-${V.doctype}-${V.name}`,title:V.name,icon:`FileText`,type:`doctype-form`,doctype:V.doctype,docName:V.name,isNew:!1,closable:!0})}function $(e){return e?new Date(e).toLocaleDateString(void 0,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`}):`Unknown`}return(e,o)=>(g(),d(`div`,x,[u(`header`,S,[u(`div`,C,[u(`div`,w,[_(s(t),{class:`w-6 h-6 text-blue-600`})]),u(`div`,null,[o[0]||=u(`h1`,{class:`text-xl font-bold text-gray-900`},`Lite Editor`,-1),u(`p`,T,c(B.doctype)+` • `+c(B.name),1)])]),u(`div`,{class:`flex items-center space-x-3`},[u(`button`,{onClick:Q,class:`px-4 py-2 bg-black text-white rounded-full text-sm font-medium hover:bg-gray-900 transition-colors`},` Open Full Editor `)])]),u(`div`,E,[u(`div`,D,[W.value?(g(),d(`div`,O,[...o[1]||=[u(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-black`},null,-1)]])):K.value?(g(),d(`div`,k,c(K.value),1)):(g(),d(`div`,A,[u(`div`,j,[u(`h2`,M,c(q.value.title||q.value.name||B.name),1),u(`p`,N,`Last updated: `+c($(q.value.modified||q.value.updated_at)),1)]),u(`div`,P,[o[3]||=u(`p`,{class:`text-sm font-medium text-gray-500 uppercase tracking-wide`},`Quick Edit`,-1),(g(!0),d(i,null,f(Y.value,e=>(g(),d(`div`,{key:e.fieldname,class:`space-y-1`},[u(`label`,F,c(e.label),1),v(u(`input`,{"onUpdate:modelValue":t=>q.value[e.fieldname]=t,type:`text`,class:`w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-black focus:border-transparent outline-none transition-all`},null,8,I),[[a,q.value[e.fieldname]]])]))),128)),Y.value.length===0?(g(),d(`div`,L,[_(s(t),{class:`w-12 h-12 mx-auto mb-4 opacity-30`}),o[2]||=u(`p`,null,`No quick edit fields configured for this document type.`,-1),u(`button`,{onClick:Q,class:`mt-4 text-blue-600 hover:text-blue-700 text-sm font-medium`},` Open Full Editor → `)])):l(``,!0)]),Y.value.length>0?(g(),d(`div`,R,[u(`button`,{onClick:Z,disabled:G.value,class:`px-6 py-2 bg-black text-white rounded-full text-sm font-medium hover:bg-gray-900 disabled:opacity-50 flex items-center gap-2 transition-colors`},[G.value?(g(),n(s(y),{key:0,class:`w-4 h-4 animate-spin`})):l(``,!0),r(` `+c(G.value?`Saving...`:`Save Changes`),1)],8,z)])):l(``,!0)]))])])]))}};export{B as default};