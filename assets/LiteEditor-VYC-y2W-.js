import{Ai as e,At as t,Di as n,Gi as r,Ni as i,Oi as a,Pi as o,Ta as s,V as c,Yi as l,ca as u,h as d,ha as f,ji as p,ki as m,o as h,qi as g,wi as _,xa as v,yi as y}from"./index-DUz5oLRf.js";import{t as b}from"./WorkspaceStore-DloGvRxv.js";var x={class:`h-full flex flex-col`},S={class:`flex-none px-6 py-4 border-b border-gray-100 flex items-center justify-between`},C={class:`flex items-center space-x-4`},w={class:`p-2 rounded-lg bg-blue-50`},T={class:`text-sm text-gray-500`},E={class:`flex-1 overflow-auto p-6 bg-gray-50`},D={class:`max-w-2xl mx-auto bg-white rounded-xl border border-gray-200 shadow-sm p-6`},O={key:0,class:`flex justify-center py-12`},k={key:1,class:`text-red-600 py-8 text-center`},A={key:2,class:`space-y-6`},j={class:`border-b border-gray-100 pb-4`},M={class:`text-2xl font-bold text-gray-900`},N={class:`text-sm text-gray-500 mt-1`},P={class:`space-y-4`},F={class:`text-sm font-medium text-gray-700`},I=[`onUpdate:modelValue`],L={key:0,class:`text-center py-8 text-gray-400`},R={key:0,class:`flex justify-end pt-4 border-t border-gray-100`},z=[`disabled`],B={__name:`LiteEditor`,props:{doctype:{type:String,required:!0},name:{type:String,required:!0}},setup(B){let V=B,{toast:H}=d(),U=b(),W=f(!0),G=f(!1),K=f(null),q=f({}),J=f({}),Y=n(()=>J.value.fields?J.value.fields.filter(e=>[`DATA`,`TEXT`,`SMALL_TEXT`].includes(e.fieldtype)&&!e.read_only).slice(0,5):[]);r(async()=>{await X()});async function X(){W.value=!0,K.value=null;try{let e=await h.get(`/org/doc/${encodeURIComponent(V.doctype)}/${encodeURIComponent(V.name)}`,{authorizeRequest:!0,organisationAware:!0});q.value=e.data||e;let t=await h.get(`/org/doctypes/${encodeURIComponent(V.doctype)}`,{authorizeRequest:!0,organisationAware:!0});J.value=t.data||t}catch(e){console.error(`Lite editor fetch error:`,e),K.value=`Failed to load document: `+e.message}finally{W.value=!1}}async function Z(){G.value=!0;try{await h.patch(`/org/doc/${encodeURIComponent(V.doctype)}/${encodeURIComponent(V.name)}`,{data:q.value,authorizeRequest:!0,organisationAware:!0}),H({title:`Saved`,description:`Document updated successfully.`,variant:`success`}),U.notifyDocSaved(V.doctype,V.name)}catch(e){console.error(`Save error:`,e),H({title:`Save Failed`,description:e.message,variant:`destructive`})}finally{G.value=!1}}function Q(){U.openTab({id:`doctype-form-${V.doctype}-${V.name}`,title:V.name,icon:`FileText`,type:`doctype-form`,doctype:V.doctype,docName:V.name,isNew:!1,closable:!0})}function $(e){return e?new Date(e).toLocaleDateString(void 0,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`}):`Unknown`}return(n,r)=>(g(),p(`div`,x,[a(`header`,S,[a(`div`,C,[a(`div`,w,[o(v(c),{class:`w-6 h-6 text-blue-600`})]),a(`div`,null,[r[0]||=a(`h1`,{class:`text-xl font-bold text-gray-900`},`Lite Editor`,-1),a(`p`,T,s(B.doctype)+` • `+s(B.name),1)])]),a(`div`,{class:`flex items-center space-x-3`},[a(`button`,{onClick:Q,class:`px-4 py-2 bg-black text-white rounded-full text-sm font-medium hover:bg-gray-900 transition-colors`},` Open Full Editor `)])]),a(`div`,E,[a(`div`,D,[W.value?(g(),p(`div`,O,[...r[1]||=[a(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-black`},null,-1)]])):K.value?(g(),p(`div`,k,s(K.value),1)):(g(),p(`div`,A,[a(`div`,j,[a(`h2`,M,s(q.value.title||q.value.name||B.name),1),a(`p`,N,`Last updated: `+s($(q.value.modified||q.value.updated_at)),1)]),a(`div`,P,[r[3]||=a(`p`,{class:`text-sm font-medium text-gray-500 uppercase tracking-wide`},`Quick Edit`,-1),(g(!0),p(_,null,l(Y.value,e=>(g(),p(`div`,{key:e.fieldname,class:`space-y-1`},[a(`label`,F,s(e.label),1),u(a(`input`,{"onUpdate:modelValue":t=>q.value[e.fieldname]=t,type:`text`,class:`w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-black focus:border-transparent outline-none transition-all`},null,8,I),[[y,q.value[e.fieldname]]])]))),128)),Y.value.length===0?(g(),p(`div`,L,[o(v(c),{class:`w-12 h-12 mx-auto mb-4 opacity-30`}),r[2]||=a(`p`,null,`No quick edit fields configured for this document type.`,-1),a(`button`,{onClick:Q,class:`mt-4 text-blue-600 hover:text-blue-700 text-sm font-medium`},` Open Full Editor → `)])):e(``,!0)]),Y.value.length>0?(g(),p(`div`,R,[a(`button`,{onClick:Z,disabled:G.value,class:`px-6 py-2 bg-black text-white rounded-full text-sm font-medium hover:bg-gray-900 disabled:opacity-50 flex items-center gap-2 transition-colors`},[G.value?(g(),m(v(t),{key:0,class:`w-4 h-4 animate-spin`})):e(``,!0),i(` `+s(G.value?`Saving...`:`Save Changes`),1)],8,z)])):e(``,!0)]))])])]))}};export{B as default};