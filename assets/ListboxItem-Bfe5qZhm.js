import{n as e,t}from"./useFormControl-Dnp3iC5X.js";import{t as n}from"./useDirection-B1kSZwKq.js";import{t as r}from"./useId-Da-MS2me.js";import{t as i}from"./useKbd-BvGB3m10.js";import{t as a}from"./useTypeahead---iVCXRs.js";import{i as o}from"./utils-BFR0tnUV.js";import{t as s}from"./VisuallyHiddenInput-B3HVdvGc.js";import{Ar as c,Bi as l,Ca as u,Ei as d,Ki as f,Kr as p,Lr as m,Ni as h,Pi as g,Qr as _,Ri as v,Ta as y,Ti as b,Wr as x,Xi as S,Yi as C,Zi as w,da as T,ea as E,ii as D,ji as O,jr as k,la as A,oa as ee,oi as j,pa as M,qi as N,xr as P,ya as F}from"./index-CHNvwQRL.js";function te(t,n,r){let i=t.findIndex(t=>e(t,n)),a=t.findIndex(t=>e(t,r));if(i===-1||a===-1)return[];let[o,s]=[i,a].sort((e,t)=>e-t);return t.slice(o,s+1)}function I(e){let t=O(()=>y(e)),n=O(()=>new Intl.Collator(`en`,{usage:`search`,...t.value}));return{startsWith:(e,t)=>t.length===0?!0:(e=e.normalize(`NFC`),t=t.normalize(`NFC`),n.value.compare(e.slice(0,t.length),t)===0),endsWith:(e,t)=>t.length===0?!0:(e=e.normalize(`NFC`),t=t.normalize(`NFC`),n.value.compare(e.slice(-t.length),t)===0),contains:(e,t)=>{if(t.length===0)return!0;e=e.normalize(`NFC`),t=t.normalize(`NFC`);let r=0,i=t.length;for(;r+i<=e.length;r++){let a=e.slice(r,r+i);if(n.value.compare(t,a)===0)return!0}return!1}}}function L(e,t,n){return e===void 0?!1:Array.isArray(e)?e.some(e=>R(e,t,n)):R(e,t,n)}function R(t,n,r){return t===void 0||n===void 0?!1:typeof t==`string`?t===n:typeof r==`function`?r(t,n):typeof r==`string`?t?.[r]===n?.[r]:e(t,n)}var[z,ne]=j(`ListboxRoot`),B=l({__name:`ListboxRoot`,props:{modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},multiple:{type:Boolean,required:!1},orientation:{type:String,required:!1,default:`vertical`},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},selectionBehavior:{type:String,required:!1,default:`toggle`},highlightOnHover:{type:Boolean,required:!1},by:{type:[String,Function],required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:[`update:modelValue`,`highlight`,`entryFocus`,`leave`],setup(e,{expose:r,emit:l}){let d=e,f=l,{multiple:m,highlightOnHover:_,orientation:v,disabled:b,selectionBehavior:S,dir:C}=u(d),{getItems:D}=P({isProvider:!0}),{handleTypeaheadSearch:O}=a(),{primitiveElement:A,currentElement:j}=c(),M=i(),I=n(C),L=t(j),z=F(),B=F(!1),V=F(!0),H=x(d,`modelValue`,f,{defaultValue:d.defaultValue??(m.value?[]:void 0),passive:d.modelValue===void 0,deep:!0});function U(e){if(B.value=!0,d.multiple){let t=Array.isArray(H.value)?[...H.value]:[],n=t.findIndex(t=>R(t,e,d.by));d.selectionBehavior===`toggle`?(n===-1?t.push(e):t.splice(n,1),H.value=t):(H.value=[e],z.value=e)}else d.selectionBehavior===`toggle`&&R(H.value,e,d.by)?H.value=void 0:H.value=e;setTimeout(()=>{B.value=!1},1)}let W=F(null),G=F(null),K=F(!1),q=F(!1),J=p(),Y=p(),X=p();function Z(){return D().map(e=>e.ref).filter(e=>e.dataset.disabled!==``)}function Q(e,t=!0){if(!e)return;W.value=e,V.value&&W.value.focus(),t&&W.value.scrollIntoView({block:`nearest`});let n=D().find(t=>t.ref===e);f(`highlight`,n)}function re(e){if(K.value)X.trigger(e);else{let t=D().find(t=>R(t.value,e,d.by));t&&(W.value=t.ref,Q(t.ref))}}function ie(e){W.value&&W.value.isConnected&&(e.preventDefault(),e.stopPropagation(),q.value||W.value.click())}function ae(e){if(V.value){if(B.value=!0,K.value)Y.trigger(e);else{let t=e.altKey||e.ctrlKey||e.metaKey;if(t&&e.key===`a`&&m.value){let t=D();H.value=[...t.map(e=>e.value)],e.preventDefault(),Q(t[t.length-1].ref)}else if(!t){let t=O(e.key,D());t&&Q(t)}}setTimeout(()=>{B.value=!1},1)}}function oe(){q.value=!0}function se(){N(()=>{q.value=!1})}function ce(){N(()=>{let e=new KeyboardEvent(`keydown`,{key:`PageUp`});ue(e)})}function $(e){let t=W.value;t?.isConnected&&(G.value=t),W.value=null,f(`leave`,e)}function le(e){let t=new CustomEvent(`listbox.entryFocus`,{bubbles:!1,cancelable:!0});if(e.currentTarget?.dispatchEvent(t),f(`entryFocus`,t),!t.defaultPrevented)if(G.value)Q(G.value);else{let e=Z()?.[0];Q(e)}}function ue(e){let t=o(e,v.value,I.value);if(!t)return;let n=Z();if(W.value){if(t===`last`)n.reverse();else if(t===`prev`||t===`next`){t===`prev`&&n.reverse();let e=n.indexOf(W.value);n=n.slice(e+1)}de(e,n[0])}if(n.length){let e=!W.value&&t===`prev`?n.length-1:0;Q(n[e])}if(K.value)return Y.trigger(e)}function de(e,t){if(!(K.value||d.selectionBehavior!==`replace`||!m.value||!Array.isArray(H.value))&&!((e.altKey||e.ctrlKey||e.metaKey)&&!e.shiftKey)&&e.shiftKey){let n=D().filter(e=>e.ref.dataset.disabled!==``),r=n.find(e=>e.ref===t)?.value;if(e.key===M.END?r=n[n.length-1].value:e.key===M.HOME&&(r=n[0].value),!r||!z.value)return;H.value=te(n.map(e=>e.value),z.value,r)}}async function fe(e){if(await N(),K.value)J.trigger(e);else{let e=Z(),t=e.find(e=>e.dataset.state===`checked`);t?Q(t):e.length&&Q(e[0])}}return ee(H,()=>{B.value||N(()=>{fe()})},{immediate:!0,deep:!0}),r({highlightedElement:W,highlightItem:re,highlightFirstItem:ce,highlightSelected:fe,getItems:D}),ne({modelValue:H,onValueChange:U,multiple:m,orientation:v,dir:I,disabled:b,highlightOnHover:_,highlightedElement:W,isVirtual:K,virtualFocusHook:J,virtualKeydownHook:Y,virtualHighlightHook:X,by:d.by,firstValue:z,selectionBehavior:S,focusable:V,onLeave:$,onEnter:le,changeHighlight:Q,onKeydownEnter:ie,onKeydownNavigation:ue,onKeydownTypeAhead:ae,onCompositionStart:oe,onCompositionEnd:se,highlightFirstItem:ce}),(e,t)=>(w(),h(y(k),{ref_key:`primitiveElement`,ref:A,as:e.as,"as-child":e.asChild,dir:y(I),"data-disabled":y(b)?``:void 0,onPointerleave:$,onFocusout:t[0]||=async e=>{let t=e.relatedTarget||e.target;await N(),W.value&&y(j)&&!y(j).contains(t)&&$(e)}},{default:T(()=>[E(e.$slots,`default`,{modelValue:y(H)}),y(L)&&e.name?(w(),h(y(s),{key:0,name:e.name,value:y(H),disabled:y(b),required:e.required},null,8,[`name`,`value`,`disabled`,`required`])):g(`v-if`,!0)]),_:3},8,[`as`,`as-child`,`dir`,`data-disabled`]))}}),V=l({__name:`ListboxContent`,props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(e){let{CollectionSlot:t}=P(),n=z(),r=_(!1,10);return(e,i)=>(w(),h(y(t),null,{default:T(()=>[v(y(k),{role:`listbox`,as:e.as,"as-child":e.asChild,tabindex:y(n).focusable.value?y(n).highlightedElement.value?`-1`:`0`:`-1`,"aria-orientation":y(n).orientation.value,"aria-multiselectable":!!y(n).multiple.value,"data-orientation":y(n).orientation.value,onMousedown:i[0]||=d(e=>r.value=!0,[`left`]),onFocus:i[1]||=e=>{y(r)||y(n).onEnter(e)},onKeydown:[i[2]||=b(e=>{y(n).orientation.value===`vertical`&&(e.key===`ArrowLeft`||e.key===`ArrowRight`)||y(n).orientation.value===`horizontal`&&(e.key===`ArrowUp`||e.key===`ArrowDown`)||(e.preventDefault(),y(n).focusable.value&&y(n).onKeydownNavigation(e))},[`down`,`up`,`left`,`right`,`home`,`end`]),b(y(n).onKeydownEnter,[`enter`]),y(n).onKeydownTypeAhead]},{default:T(()=>[E(e.$slots,`default`)]),_:3},8,[`as`,`as-child`,`tabindex`,`aria-orientation`,`aria-multiselectable`,`data-orientation`,`onKeydown`])]),_:3}))}}),H=l({__name:`ListboxFilter`,props:{modelValue:{type:String,required:!1},autoFocus:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:`input`}},emits:[`update:modelValue`],setup(e,{emit:t}){let n=e,r=x(n,`modelValue`,t,{defaultValue:``,passive:n.modelValue===void 0}),i=z(),{primitiveElement:a,currentElement:o}=c(),s=O(()=>n.disabled||i.disabled.value||!1),l=F();return A(()=>l.value=i.highlightedElement.value?.id),C(()=>{i.focusable.value=!1,setTimeout(()=>{n.autoFocus&&o.value?.focus()},1)}),S(()=>{i.focusable.value=!0}),(e,t)=>(w(),h(y(k),{ref_key:`primitiveElement`,ref:a,as:e.as,"as-child":e.asChild,value:y(r),disabled:s.value?``:void 0,"data-disabled":s.value?``:void 0,"aria-disabled":s.value??void 0,"aria-activedescendant":l.value,type:`text`,onKeydown:[b(d(y(i).onKeydownNavigation,[`prevent`]),[`down`,`up`,`home`,`end`]),b(y(i).onKeydownEnter,[`enter`])],onInput:t[0]||=e=>{r.value=e.target.value,y(i).highlightFirstItem()},onCompositionstart:y(i).onCompositionStart,onCompositionend:y(i).onCompositionEnd},{default:T(()=>[E(e.$slots,`default`,{modelValue:y(r)})]),_:3},8,[`as`,`as-child`,`value`,`disabled`,`data-disabled`,`aria-disabled`,`aria-activedescendant`,`onKeydown`,`onCompositionstart`,`onCompositionend`]))}}),[U,W]=j(`ListboxGroup`),G=l({__name:`ListboxGroup`,props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(e){let t=e,n=r(void 0,`reka-listbox-group`);return W({id:n}),(e,r)=>(w(),h(y(k),f({role:`group`},t,{"aria-labelledby":y(n)}),{default:T(()=>[E(e.$slots,`default`)]),_:3},16,[`aria-labelledby`]))}}),K=`listbox.select`,[q,J]=j(`ListboxItem`),Y=l({__name:`ListboxItem`,props:{value:{type:null,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:`div`}},emits:[`select`],setup(e,{emit:t}){let n=e,i=t,a=r(void 0,`reka-listbox-item`),{CollectionItem:o}=P(),{forwardRef:s,currentElement:c}=m(),l=z(),u=O(()=>c.value===l.highlightedElement.value),p=O(()=>L(l.modelValue.value,n.value,l.by)),g=O(()=>l.disabled.value||n.disabled);async function _(e){i(`select`,e),!e?.defaultPrevented&&!g.value&&e&&(l.onValueChange(n.value),l.changeHighlight(c.value))}function x(e){let t={originalEvent:e,value:n.value};D(K,_,t)}return J({isSelected:p}),(e,t)=>(w(),h(y(o),{value:e.value},{default:T(()=>[M([u.value,p.value],()=>v(y(k),f({id:y(a)},e.$attrs,{ref:y(s),role:`option`,tabindex:y(l).focusable.value?u.value?`0`:`-1`:-1,"aria-selected":p.value,as:e.as,"as-child":e.asChild,disabled:g.value?``:void 0,"data-disabled":g.value?``:void 0,"data-highlighted":u.value?``:void 0,"data-state":p.value?`checked`:`unchecked`,onClick:x,onKeydown:b(d(x,[`prevent`]),[`space`]),onPointermove:t[0]||=()=>{y(l).highlightedElement.value!==y(c)&&y(l).highlightOnHover.value&&!y(l).focusable.value&&y(l).changeHighlight(y(c),!1)}}),{default:T(()=>[E(e.$slots,`default`)]),_:3},16,[`id`,`tabindex`,`aria-selected`,`as`,`as-child`,`disabled`,`data-disabled`,`data-highlighted`,`data-state`,`onKeydown`]),t,1)]),_:3},8,[`value`]))}});export{V as a,I as c,H as i,G as n,B as o,U as r,z as s,Y as t};