import{A as e,D as t,I as n,O as r,Y as i,dt as a,ht as o,v as s,z as c}from"./index-BbbjTprl.js";import{i as l}from"./dist-rCl7Sutb.js";import{h as u,i as d,n as f}from"./useForwardExpose-Bmr5sraL.js";function p(e,t){let n=a(e);function r(e){return t[n.value][e]??n.value}return{state:n,dispatch:e=>{n.value=r(e)}}}function m(e,t){let r=a({}),o=a(`none`),l=a(e),d=e.value?`mounted`:`unmounted`,m,g=t.value?.ownerDocument.defaultView??f,{state:_,dispatch:v}=p(d,{mounted:{UNMOUNT:`unmounted`,ANIMATION_OUT:`unmountSuspended`},unmountSuspended:{MOUNT:`mounted`,ANIMATION_END:`unmounted`},unmounted:{MOUNT:`mounted`}}),y=e=>{if(u){let n=new CustomEvent(e,{bubbles:!1,cancelable:!1});t.value?.dispatchEvent(n)}};i(e,async(e,i)=>{let a=i!==e;if(await n(),a){let n=o.value,a=h(t.value);e?(v(`MOUNT`),y(`enter`),a===`none`&&y(`after-enter`)):a===`none`||a===`undefined`||r.value?.display===`none`?(v(`UNMOUNT`),y(`leave`),y(`after-leave`)):i&&n!==a?(v(`ANIMATION_OUT`),y(`leave`)):(v(`UNMOUNT`),y(`after-leave`))}},{immediate:!0});let b=e=>{let n=h(t.value),r=n.includes(CSS.escape(e.animationName)),i=_.value===`mounted`?`enter`:`leave`;if(e.target===t.value&&r&&(y(`after-${i}`),v(`ANIMATION_END`),!l.value)){let e=t.value.style.animationFillMode;t.value.style.animationFillMode=`forwards`,m=g?.setTimeout(()=>{t.value?.style.animationFillMode===`forwards`&&(t.value.style.animationFillMode=e)})}e.target===t.value&&n===`none`&&v(`ANIMATION_END`)},x=e=>{e.target===t.value&&(o.value=h(t.value))},S=i(t,(e,t)=>{e?(r.value=getComputedStyle(e),e.addEventListener(`animationstart`,x),e.addEventListener(`animationcancel`,b),e.addEventListener(`animationend`,b)):(v(`ANIMATION_END`),m!==void 0&&g?.clearTimeout(m),t?.removeEventListener(`animationstart`,x),t?.removeEventListener(`animationcancel`,b),t?.removeEventListener(`animationend`,b))},{immediate:!0}),C=i(_,()=>{let e=h(t.value);o.value=_.value===`mounted`?e:`none`});return c(()=>{S(),C()}),{isPresent:s(()=>[`mounted`,`unmountSuspended`].includes(_.value))}}function h(e){return e&&getComputedStyle(e).animationName||`none`}var g=t({name:`Presence`,props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(t,{slots:n,expose:i}){let{present:s,forceMount:c}=o(t),u=a(),{isPresent:f}=m(s,u);i({present:f});let p=n.default({present:f.value});p=l(p||[]);let h=r();if(p&&p?.length>1){let e=h?.parent?.type.name?`<${h.parent.type.name} />`:`component`;throw Error([`Detected an invalid children for \`${e}\` for  \`Presence\` component.`,``,"Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.",`You can apply a few solutions:`,["Provide a single child element so that `presence` directive attach correctly.",`Ensure the first child is an actual element instead of a raw text node or comment node.`].map(e=>`  - ${e}`).join(`
`)].join(`
`))}return()=>c.value||s.value||f.value?e(n.default({present:f.value})[0],{ref:e=>{let t=d(e);return t?.hasAttribute===void 0||(t?.hasAttribute(`data-reka-popper-content-wrapper`)?u.value=t.firstElementChild:u.value=t),t}}):null}});export{g as t};