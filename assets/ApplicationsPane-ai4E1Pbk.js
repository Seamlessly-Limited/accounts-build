import{Bi as e,C as t,D as n,Dt as r,E as i,Er as a,Et as ee,Fn as o,H as te,Hi as s,Hn as ne,In as re,It as ie,J as ae,L as oe,Li as c,Ln as se,M as ce,Mi as le,Mn as ue,Nt as de,Oa as l,Ot as fe,P as pe,Pa as u,Q as me,Ra as d,Rn as he,S as f,Si as p,T as ge,Ti as _e,Ui as m,Vi as h,Vn as ve,Vt as ye,Wi as g,Wt as be,X as _,Xt as v,Y as y,Z as b,_i as x,_n as S,_t as C,ar as w,at as T,bn as E,ca as D,da as O,dn as k,dt as A,er as j,fn as M,fr as N,ft as xe,gn as Se,gr as Ce,ha as we,hn as Te,hr as Ee,i as P,ia as De,ir as Oe,it as F,jn as ke,nr as Ae,o as I,oa as L,on as je,or as Me,pn as Ne,pr as Pe,pt as Fe,qi as R,qt as Ie,r as Le,rt as z,sn as Re,sr as ze,tn as Be,tt as Ve,un as He,ur as Ue,ut as We,vn as Ge,x as Ke,xa as qe,y as Je,yn as Ye,z as Xe,zt as Ze}from"./index-Caanq2Pw.js";import{t as Qe}from"./WorkspaceStore-c1j8aQzy.js";function B(e){let t=e.map(e=>{let t=e.apps.map(e=>e.name).sort().join(`,`);return`${e.name}:[${t}]`}).sort().join(`|`),n=5381;for(let e=0;e<t.length;e++)n=(n<<5)+n+t.charCodeAt(e),n&=n;return Math.abs(n).toString(36)}var V={getDocTypes:async()=>{try{return(await I.get(`/org/doctypes`,{authorizeRequest:!0,organisationAware:!0}))?.data||[]}catch(e){return console.warn(`Failed to fetch doc types:`,e),[]}},getAllApplications:async()=>{let e=await V.getDocTypes(),t={Stock:`Package`,Inventory:`Package`,Selling:`TrendingUp`,Sales:`TrendingUp`,Administration:`ShieldCheck`,Billing:`Receipt`,CRM:`Users`,Buying:`ShoppingBag`,Purchases:`ShoppingBag`,Accounting:`Calculator`,Finance:`Landmark`,System:`Settings`,Core:`Cog`,Notifications:`Bell`,Setup:`Settings`},n=[`File`,`Brand Settings`,`Application`,`Application Group`,`Doc Event Type`],r={};e.forEach(e=>{if(e.is_child||n.includes(e.name)||!e.module)return;let i=e.module;r[i]||(r[i]={id:`module-${i.toLowerCase().replace(/\s+/g,`-`)}`,name:i,type:`group`,icon:t[i]||`Folder`,apps:[]}),r[i].apps.push({id:`doctype-${e.name.toLowerCase().replace(/\s+/g,`-`)}`,name:e.name,icon:e.icon||`FileText`,background:`bg-slate-950`,route:`/app/${encodeURIComponent(e.name)}`,type:`doctype-app`,doctype:e.name})});let i=Object.values(r);i.sort((e,t)=>e.name.localeCompare(t.name)),i.forEach(e=>{e.apps.sort((e,t)=>e.name.localeCompare(t.name))});let a=B(i);return{groups:i,structureHash:a}}},$e=V,et={key:0,class:`absolute inset-0 z-[100] flex flex-col`},tt={class:`relative z-10 flex flex-col h-full w-full max-w-7xl mx-auto p-4 md:p-8 pointer-events-auto`},nt={class:`flex justify-start mb-6 mt-2`},rt={class:`relative w-full pointer-events-auto`},it={class:`flex items-center gap-4 mb-4 ml-2`},at={class:`text-xl font-semibold text-slate-600`},ot={class:`grid grid-cols-3 md:grid-cols-5 lg:grid-cols-7 gap-4 justify-items-center`},st=[`onClick`],ct={class:`w-14 h-14 md:w-16 md:h-16 rounded-2xl flex items-center justify-center shadow-md transition-shadow group-hover:shadow-lg duration-200 opacity-80 group-hover:opacity-100 bg-stone-50`},lt={class:`text-gray-500 text-xs md:text-sm font-medium text-center line-clamp-3 shadow-black drop-shadow-sm opacity-90 group-hover:opacity-100`},ut={key:0,class:`flex flex-col items-center justify-center h-64 text-slate-500`},H={__name:`ApplicationsPane`,props:{isOpen:Boolean},emits:[`close`],setup(P,{emit:I}){let B=P,V=I,H=Le(),U=Qe(),W={TicketCheck:oe,GitMerge:Re,Package:r,Box:Ue,SlidersHorizontal:y,Truck:ce,LockKeyhole:Ze,TrendingUp:pe,Users:t,UserPlus:i,FileText:Ne,FileQuestion:Te,Receipt:xe,Bookmark:N,ClipboardList:he,Banknote:Ce,FileMinus:S,RefreshCw:We,CreditCard:ue,ReceiptText:Fe,ShoppingCart:_,Store:te,Vault:f,FileInput:Ge,CalendarClock:Oe,ShoppingBag:b,PackageCheck:fe,Send:z,FilePlus:Se,RefreshCcw:A,Landmark:v,Scale:T,Link:be,BookOpen:Pe,Library:Ie,Folder:He,FolderOpen:k,Clock:se,User:ge,Building:Me,Building2:ze,Pin:C,File:M,Code:re,FileCode:Ye,Database:ke,Settings:Ve,BarChart:j,HelpCircle:ne,Sparkles:ae,Mail:ie,AppWindow:a,UserCheck:n,Camera:Ae,CircleUserRound:ve,History:Be,Zap:Je,Globe:je,Palette:ee,Wallet:Ke,List:ye,Bell:Ee,ShieldCheck:me,Terminal:Xe,FileJson:E,Megaphone:de,Calculator:w,Cog:o};function dt(){try{let e=JSON.parse(localStorage.getItem(`organisation`)||`{}`),t=JSON.parse(localStorage.getItem(`user`)||`{}`);return e.creatorId===t.id||e.creator?.id===t.id}catch{return!1}}function G(e){return e.type===`group`?{...e,apps:e.apps.map(e=>({...e}))}:{...e}}function K(e,t){let n=new Map;t.forEach(e=>{n.set(e.id,e)});let r=new Set(e.map(e=>e.id)),i=[];return e.forEach(e=>{let t=n.get(e.id);if(t)if(t.type===`group`&&e.type===`group`){let n=G(t);n.apps=K(e.apps||[],t.apps||[]),i.push(n)}else i.push(G(t))}),t.forEach(e=>{r.has(e.id)||i.push(G(e))}),i}let q=p(`flow-applications-order`,null),J=p(`flow-cached-apps`,[]),Y=p(`flow-apps-hash`,``),X=l(!0),Z=l([]);De(async()=>{J.value&&J.value.length>0&&(Z.value=J.value,X.value=!1);try{let{groups:e,structureHash:t}=await $e.getAllApplications();t===Y.value?q.value&&Array.isArray(q.value)?Z.value=K(q.value,e):Z.value=e.map(G):(console.log(`Applications structure changed, resetting order`),q.value=null,Z.value=e.map(G)),J.value=e,Y.value=t}catch(e){console.error(`Failed to load applications:`,e)}finally{X.value=!1}}),_e(Z,e=>{q.value=e},{deep:!0,debounce:500});let Q=l(``),$=e(()=>{let e=dt(),t=t=>{if(!Q.value)return t.filter(t=>!t.ownerOnly||e);let n=Q.value.toLowerCase();return t.filter(t=>t.ownerOnly&&!e?!1:t.name.toLowerCase().includes(n))},n=[],r=[],i=[`System`,`Tax`];return Z.value.forEach(a=>{if(!a.ownerOnly||e)if(a.type===`group`){if(i.includes(a.name))return;let e=t(a.apps||[]);e.length>0&&n.push({...a,apps:e})}else (!Q.value||a.name.toLowerCase().includes(Q.value.toLowerCase()))&&r.push(a)}),{groups:n,looseApps:r}}),ft=e=>{try{if(e.doctype){let t={id:e.id||`doctype-${e.doctype.toLowerCase().replace(/\s+/g,`-`)}`,title:e.name,icon:e.icon,type:`doctype`,doctype:e.doctype,props:e.props||{},closable:!0};U.openTab(t),V(`close`),H.push({path:`/workspace`,hash:`#${t.id}`})}else V(`close`),H.push(e.route)}catch(e){console.error(`Failed to open app:`,e)}};return we(()=>B.isOpen,e=>{e||setTimeout(()=>{Q.value=``},300)}),x(`Escape`,()=>{B.isOpen&&V(`close`)}),(e,t)=>P.isOpen?(L(),g(`div`,et,[h(`div`,{class:`absolute inset-0 bg-white/40 backdrop-blur-xl`,onClick:t[0]||=t=>e.$emit(`close`)}),h(`div`,tt,[h(`div`,nt,[h(`div`,rt,[R(u(F),{class:`absolute left-3 top-1/2 -translate-y-1/2 text-black/60 h-5 w-5`}),qe(h(`input`,{"onUpdate:modelValue":t[1]||=e=>Q.value=e,type:`text`,placeholder:`Type to search...`,class:`w-full bg-white/90 border-4 border-gray-200 rounded-full py-1.5 pl-10 pr-4 text-slate-600 placeholder-slate-400 focus:outline-none focus:bg-white/20 focus:border-stone-100/80 transition-all`},null,512),[[le,Q.value]])])]),h(`div`,{class:`flex-1 relative overflow-y-auto px-4 pb-20 pt-10`,onClick:t[2]||=t=>e.$emit(`close`),style:{"scrollbar-width":`none`}},[(L(!0),g(c,null,D($.value.groups,e=>(L(),g(`div`,{key:e.id,class:`mb-20`},[h(`div`,it,[(L(),s(O(W[e.icon]),{class:`h-5 w-5 text-slate-400`})),h(`h3`,at,d(e.name),1)]),h(`div`,ot,[(L(!0),g(c,null,D(e.apps,e=>(L(),g(`div`,{key:e.id,class:`flex flex-col items-center gap-2 group cursor-pointer pointer-events-auto w-20 md:w-24 transition-transform hover:-translate-y-1 duration-200`,onClick:t=>ft(e)},[h(`div`,ct,[(L(),s(O(W[e.icon]),{class:`text-slate-800 h-7 w-7 md:h-8 md:w-8`}))]),h(`span`,lt,d(e.name),1)],8,st))),128))])]))),128)),$.value.groups.length===0&&$.value.looseApps.length===0?(L(),g(`div`,ut,[R(u(F),{class:`h-12 w-12 mb-4 opacity-50`}),t[3]||=h(`p`,null,`No applications found`,-1)])):m(``,!0)])])])):m(``,!0)}},U=P(H,[[`__scopeId`,`data-v-826250f6`]]);export{U as default};