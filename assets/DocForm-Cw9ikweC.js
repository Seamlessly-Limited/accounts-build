import{a as e,i as t,n,o as r,r as i}from"./sheet-BQZlRCZC.js";import{t as a}from"./SelectGroup-D40CeBwS.js";import{Aa as o,Bi as s,Bt as c,Ei as l,Hi as u,I as d,Ii as f,It as ee,Jn as te,Li as p,Na as m,Ni as h,Oi as g,Pa as _,Ri as v,Ui as y,V as ne,Vi as b,Wi as re,Yn as x,_a as S,da as ie,ea as ae,ft as C,g as oe,ga as w,gr as se,i as T,ia as E,ja as D,jt as ce,l as O,lr as k,n as le,na as A,o as j,r as ue,sa as de,st as fe,ta as pe,u as me,wa as M,x as N,zi as P,zn as he}from"./index-BW6FH5S4.js";import{t as F}from"./purify.es-C6pmr44S.js";import{n as I,t as L}from"./DialogContent-DzO0B1dQ.js";import{n as R,r as z,t as ge}from"./DialogTitle-BAO4s_Rj.js";import{t as _e}from"./DialogFooter-BGPl6WoG.js";import{t as ve}from"./WorkspaceStore-DkbvTQrR.js";import{t as B}from"./Input-AKTRhZx5.js";import{t as V}from"./button-BIS6kOZQ.js";import{t as H}from"./DynamicIcon-D5-EdDm3.js";import{t as U}from"./viewRegistry-B23Q0QQW.js";import{t as ye}from"./Label-CWz-ReQU.js";import{t as be}from"./LinkField-C2IIEkLF.js";import{t as xe}from"./DateField-CuEp_QeT.js";import{a as Se,i as Ce,n as we,r as Te,t as Ee}from"./SelectValue-CvGnKkl4.js";import{t as De}from"./Textarea-DDsE0ukV.js";import{t as W}from"./badge-DeOd_cPn.js";import{t as G}from"./marked.esm-DidRfey3.js";var K={class:`px-4 py-3 bg-stone-50/80 border-b border-stone-200 flex justify-between items-center sticky top-0 z-10`},q={class:`flex items-center gap-3`},J={class:`p-1.5 bg-stone-100 rounded-lg`},Oe={class:`font-semibold text-stone-900 text-sm tracking-tight`},ke={class:`flex items-center gap-2`},Ae={key:0,class:`p-12 text-center text-stone-400`},Y={class:`w-16 h-16 bg-stone-50 rounded-full flex items-center justify-center mx-auto mb-4 border border-stone-100 group-hover:scale-110 transition-transform duration-300`},je={class:`w-full text-sm border-collapse table-fixed min-w-[800px]`},Me={class:`bg-stone-50/50 text-stone-500 text-left border-b border-stone-100`},Ne={class:`flex items-center gap-1.5`},Pe={key:0,class:`text-red-500`},X={class:`divide-y divide-stone-100`},Fe={class:`px-4 py-3 text-stone-400 font-mono text-[10px] text-center align-middle`},Ie={key:0},Z={key:1},Le={class:`relative group/input`},Q={key:0,class:`absolute left-2 top-1/2 -translate-y-1/2 text-[10px] text-stone-400 font-bold opacity-0 group-focus-within/input:opacity-100 transition-opacity`},Re={key:2},ze={key:3},Be={key:4},Ve={key:5,class:`absolute inset-0 pointer-events-none`},He={key:6},Ue={class:`text-stone-400 text-xs truncate block italic px-2`},We={class:`px-4 py-3 text-center align-middle`},$={class:`flex items-center justify-center gap-1`},Ge={key:3,class:`px-4 py-2 bg-stone-50/30 border-t border-stone-100 flex items-center justify-between`},Ke={key:0,class:`text-xs font-semibold text-stone-600`},qe={class:`grid grid-cols-2 gap-6 py-4 max-h-[60vh] overflow-y-auto px-1`},Je={key:0,class:`text-red-500`},Ye={key:0},Xe={key:1},Ze={key:2},Qe={key:3},$e={key:4},et={key:5},tt={__name:`ChildTableEditor`,props:{fieldname:{type:String,required:!0},options:{type:String,required:!0},label:{type:String,default:`Items`},modelValue:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},defaultTaxPolicy:{type:String,default:null}},emits:[`update:modelValue`,`totalsChanged`],setup(e,{emit:t}){let n=e,r=t,i=M(!1),a=M([]),c=M([]),l=M({}),te=M(!1),g=M(!1),re=M(-1),x=M({}),S=0,oe=()=>`new-${++S}`,se=f(()=>{let e=a.value.filter(e=>![`parent`,`parenttype`,`parentfield`,`idx`,`name`,`owner`,`docstatus`].includes(e.fieldname)&&!e.hidden&&![`SECTION_BREAK`,`COLUMN_BREAK`,`TAB_BREAK`,`TABLE`].includes(e.fieldtype)),t=e.filter(e=>e.in_list_view);return t.length>0?t:e.slice(0,6)}),T=f(()=>n.options===`InvoiceItem`),O=e=>e.read_only||T.value&&[`amount`,`tax_amount`,`tax_rate`,`net_amount`].includes(e.fieldname),k=e=>e.options?e.options.split(`
`).map(e=>e.trim()).filter(Boolean):[],le=e=>[`SMALL_TEXT`,`LONG_TEXT`,`TABLE`,`HTML`].includes(e.fieldtype),ue=e=>{let t={qty:`80px`,rate:`120px`,amount:`120px`,unit:`80px`,idx:`40px`,item_code:`160px`};return t[e.fieldname]?t[e.fieldname]:[`CURRENCY`,`FLOAT`,`INT`].includes(e.fieldtype)?`110px`:e.fieldtype===`DATE`?`160px`:e.fieldtype===`LINK`?`180px`:`1% auto`};function de(){return c.value.reduce((e,t)=>e+(parseFloat(t.amount)||0),0)}function fe(e){return new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:`NGN`}).format(e||0)}async function pe(e){if(!e)return 0;if(l.value[e]!==void 0)return l.value[e];try{let t=(await j.get(`/org/doc/TaxPolicy/${encodeURIComponent(e)}`)).data?.rate||0;return l.value[e]=t,t}catch{return 0}}async function me(e){if(!T.value)return;let t=parseFloat(e.qty)||0,n=parseFloat(e.rate)||0,r=parseFloat(e.discount_percent)||0;e.amount=t*n,e.tax_policy?e.tax_rate=await pe(e.tax_policy):e.tax_rate=0,e.tax_amount=e.amount*(e.tax_rate/100);let i=e.amount*(r/100);e.net_amount=e.amount+e.tax_amount-i}function N(){if(!T.value)return;let e=c.value.reduce((e,t)=>e+(parseFloat(t.amount)||0),0),t=c.value.reduce((e,t)=>e+(parseFloat(t.tax_amount)||0),0),n=c.value.reduce((e,t)=>e+(parseFloat(t.net_amount)||0),0);r(`totalsChanged`,{grandTotal:e,totalTax:t,totalNet:n})}function he(){let e={_id:oe()};for(let t of a.value)t.default_value!==void 0&&t.default_value!==null&&(e[t.fieldname]=t.default_value);n.defaultTaxPolicy&&T.value&&(e.tax_policy=n.defaultTaxPolicy),c.value.push(e),U()}function F(e){c.value.splice(e,1),U(),N()}function ve(){confirm(`Are you sure you want to remove all rows?`)&&(c.value=[],U(),N())}async function H(e,t){if(T.value&&t===`product`&&e.product)try{let t=await j.get(`/org/doc/Product/${encodeURIComponent(e.product)}`);t.data&&(e.description=t.data.product_name||t.data.description,e.rate=t.data.standard_rate||0,e.uom=t.data.uom||`Unit`,e.qty||=1)}catch(e){console.warn(`Product master lookup failed`,e)}T.value&&[`qty`,`rate`,`discount_percent`,`tax_policy`,`product`].includes(t)&&(await me(e),N()),U()}function U(){let e=c.value.map(e=>{let{_id:t,...n}=e;return n});r(`update:modelValue`,e)}function G(e){re.value=e,x.value=c.value[e],g.value=!0}function tt(){g.value=!1,U(),N()}ie(()=>n.modelValue,e=>{Array.isArray(e)&&e.length!==c.value.length&&(c.value=e.map((e,t)=>({...e,_id:e.name||e._id||`existing-${t}`})))},{immediate:!0,deep:!0});async function nt(){if(n.options){i.value=!0;try{a.value=(await j.get(`/org/doctypes/${encodeURIComponent(n.options)}`)).data?.fields||[]}catch(e){console.error(`Failed to load child schema:`,e)}finally{i.value=!1}}}return ae(()=>{nt()}),(t,n)=>(A(),s(`div`,{class:D([`border border-stone-200 rounded-xl overflow-hidden bg-white shadow-sm transition-all duration-200`,{"ring-1 ring-stone-900 border-stone-900":te.value}])},[p(`div`,K,[p(`div`,q,[p(`div`,J,[y(o(ne),{class:`w-4 h-4 text-stone-600`})]),p(`h4`,Oe,_(e.label),1),y(o(W),{variant:`secondary`,class:`rounded-full px-2 py-0 h-5 text-[10px] font-bold bg-stone-200/50 text-stone-600`},{default:w(()=>[u(_(c.value.length)+` `+_(c.value.length===1?`row`:`rows`),1)]),_:1})]),p(`div`,ke,[c.value.length>0&&!e.disabled?(A(),v(o(V),{key:0,onClick:ve,type:`button`,variant:`ghost`,size:`sm`,class:`h-8 text-stone-500 hover:text-red-600 rounded-full text-xs font-medium px-3`},{default:w(()=>[y(o(d),{class:`w-3.5 h-3.5 mr-1`}),n[3]||=u(` Clear All `,-1)]),_:1})):P(``,!0),y(o(V),{onClick:he,type:`button`,size:`sm`,disabled:e.disabled,class:`h-8 bg-stone-900 hover:bg-stone-800 text-white rounded-full text-xs font-semibold px-4 shadow-sm transition-transform active:scale-95`},{default:w(()=>[y(o(C),{class:`w-3.5 h-3.5 mr-1`}),n[4]||=u(` Add Row `,-1)]),_:1},8,[`disabled`])])]),i.value?(A(),s(`div`,Ae,[y(o(ee),{class:`w-6 h-6 animate-spin mx-auto mb-3`}),n[5]||=p(`p`,{class:`text-xs font-medium uppercase tracking-widest opacity-50`},`Initializing Table...`,-1)])):c.value.length?(A(),s(`div`,{key:2,class:`overflow-x-auto relative min-h-[100px]`,onFocusin:n[0]||=e=>te.value=!0,onFocusout:n[1]||=e=>te.value=!1},[p(`table`,je,[p(`thead`,Me,[p(`tr`,null,[n[8]||=p(`th`,{class:`px-4 py-2.5 font-bold uppercase tracking-wider text-[10px] w-12 text-center`},`#`,-1),(A(!0),s(h,null,E(se.value,e=>(A(),s(`th`,{key:e.fieldname,class:`px-2 py-2.5 font-bold uppercase tracking-wider text-[10px]`,style:m({width:ue(e)})},[p(`div`,Ne,[u(_(e.label)+` `,1),e.reqd?(A(),s(`span`,Pe,`*`)):P(``,!0)])],4))),128)),n[9]||=p(`th`,{class:`px-4 py-2.5 w-24 text-center font-bold uppercase tracking-wider text-[10px]`},`Actions `,-1)])]),p(`tbody`,X,[(A(!0),s(h,null,E(c.value,(t,n)=>(A(),s(`tr`,{key:t._id||n,class:`group hover:bg-stone-50/80 transition-colors`},[p(`td`,Fe,_(n+1),1),(A(!0),s(h,null,E(se.value,n=>(A(),s(`td`,{key:n.fieldname,class:`px-2 py-3 align-middle`},[n.fieldtype===`DATA`||n.fieldtype===`TEXT`||n.fieldtype===`SMALL_TEXT`?(A(),s(`div`,Ie,[y(o(B),{modelValue:t[n.fieldname],"onUpdate:modelValue":e=>t[n.fieldname]=e,placeholder:n.label,disabled:e.disabled||O(n),class:`h-8 text-xs bg-transparent border-stone-200/50 hover:border-stone-400 focus:bg-white shadow-none rounded-lg`},null,8,[`modelValue`,`onUpdate:modelValue`,`placeholder`,`disabled`])])):[`CURRENCY`,`FLOAT`,`INT`,`PERCENT`].includes(n.fieldtype)?(A(),s(`div`,Z,[p(`div`,Le,[y(o(B),{type:`number`,modelValue:t[n.fieldname],"onUpdate:modelValue":e=>t[n.fieldname]=e,modelModifiers:{number:!0},onInput:e=>H(t,n.fieldname),disabled:e.disabled||O(n),class:`h-8 text-xs text-right pr-2 bg-transparent border-stone-200/50 hover:border-stone-400 focus:bg-white shadow-none rounded-lg [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none`},null,8,[`modelValue`,`onUpdate:modelValue`,`onInput`,`disabled`]),n.fieldtype===`CURRENCY`?(A(),s(`span`,Q,`₦`)):P(``,!0)])])):n.fieldtype===`DATE`?(A(),s(`div`,Re,[y(xe,{modelValue:t[n.fieldname],"onUpdate:modelValue":e=>t[n.fieldname]=e,compact:``,pill:``,disabled:e.disabled||O(n)},null,8,[`modelValue`,`onUpdate:modelValue`,`disabled`])])):n.fieldtype===`SELECT`?(A(),s(`div`,ze,[y(o(Se),{modelValue:t[n.fieldname],"onUpdate:modelValue":e=>t[n.fieldname]=e,disabled:e.disabled||O(n)},{default:w(()=>[y(o(we),{class:`h-8 text-xs rounded-lg shadow-none bg-transparent border-stone-200/50`},{default:w(()=>[y(o(Ee),{placeholder:n.label},null,8,[`placeholder`])]),_:2},1024),y(o(Ce),null,{default:w(()=>[(A(!0),s(h,null,E(k(n),e=>(A(),v(o(Te),{key:e,value:e},{default:w(()=>[u(_(e),1)]),_:2},1032,[`value`]))),128))]),_:2},1024)]),_:2},1032,[`modelValue`,`onUpdate:modelValue`,`disabled`])])):n.fieldtype===`LINK`?(A(),s(`div`,Be,[y(be,{modelValue:t[n.fieldname],"onUpdate:modelValue":[e=>t[n.fieldname]=e,e=>H(t,n.fieldname)],doctype:n.options,placeholder:n.label,compact:``,disabled:e.disabled||O(n)},null,8,[`modelValue`,`onUpdate:modelValue`,`doctype`,`placeholder`,`disabled`])])):P(``,!0),T.value&&n.fieldname===`product`?(A(),s(`div`,Ve)):[`DATA`,`TEXT`,`SMALL_TEXT`,`CURRENCY`,`FLOAT`,`INT`,`PERCENT`,`DATE`,`SELECT`,`LINK`].includes(n.fieldtype)?P(``,!0):(A(),s(`div`,He,[p(`span`,Ue,_(t[n.fieldname]||`—`),1)]))]))),128)),p(`td`,We,[p(`div`,$,[y(o(V),{variant:`ghost`,size:`sm`,onClick:e=>G(n),class:`h-7 w-7 p-0 rounded-full text-stone-400 hover:text-stone-900 hover:bg-stone-100`},{default:w(()=>[y(o(ce),{class:`w-3.5 h-3.5`})]),_:1},8,[`onClick`]),y(o(V),{variant:`ghost`,size:`sm`,onClick:e=>F(n),disabled:e.disabled,class:`h-7 w-7 p-0 rounded-full text-stone-300 hover:text-red-500 hover:bg-red-50`},{default:w(()=>[y(o(d),{class:`w-3.5 h-3.5`})]),_:1},8,[`onClick`,`disabled`])])])]))),128))])])],32)):(A(),s(h,{key:1},[e.disabled?P(``,!0):(A(),s(`div`,{key:0,class:`p-16 text-center group cursor-pointer`,onClick:he},[p(`div`,Y,[y(o(C),{class:`w-8 h-8 text-stone-300 group-hover:text-stone-900 px-0`})]),n[6]||=p(`p`,{class:`text-sm font-medium text-stone-500`},`No items found.`,-1),n[7]||=p(`p`,{class:`text-xs text-stone-400 mt-1`},`Click to add your first row.`,-1)]))],64)),c.value.length>0?(A(),s(`div`,Ge,[n[10]||=b(`<div class="flex items-center gap-4 text-[10px] text-stone-400 font-medium" data-v-1f61ae3b><div class="flex items-center gap-1.5" data-v-1f61ae3b><kbd class="px-1.5 py-0.5 bg-white border border-stone-200 rounded-md text-stone-500" data-v-1f61ae3b>TAB</kbd> Next Field </div><div class="flex items-center gap-1.5" data-v-1f61ae3b><kbd class="px-1.5 py-0.5 bg-white border border-stone-200 rounded-md text-stone-500" data-v-1f61ae3b>ENTER</kbd> New Row </div></div>`,1),T.value?(A(),s(`div`,Ke,` Subtotal: `+_(fe(de())),1)):P(``,!0)])):P(``,!0),y(o(I),{open:g.value,"onUpdate:open":n[2]||=e=>g.value=e},{default:w(()=>[y(o(L),{class:`max-w-2xl`},{default:w(()=>[y(o(R),null,{default:w(()=>[y(o(ge),null,{default:w(()=>[u(`Edit Row #`+_(re.value+1),1)]),_:1}),y(o(z),null,{default:w(()=>[...n[11]||=[u(`Enter detailed information for this line item.`,-1)]]),_:1})]),_:1}),p(`div`,qe,[(A(!0),s(h,null,E(a.value,e=>(A(),s(`div`,{key:e.fieldname,class:D([`space-y-2`,{"col-span-2":le(e)}])},[y(o(ye),{class:`text-xs font-bold uppercase tracking-wider text-stone-500`},{default:w(()=>[u(_(e.label)+` `,1),e.reqd?(A(),s(`span`,Je,`*`)):P(``,!0)]),_:2},1024),e.fieldtype===`DATA`||e.fieldtype===`TEXT`?(A(),s(`div`,Ye,[y(o(B),{modelValue:x.value[e.fieldname],"onUpdate:modelValue":t=>x.value[e.fieldname]=t,disabled:O(e)},null,8,[`modelValue`,`onUpdate:modelValue`,`disabled`])])):e.fieldtype===`SMALL_TEXT`||e.fieldtype===`LONG_TEXT`?(A(),s(`div`,Xe,[y(o(De),{modelValue:x.value[e.fieldname],"onUpdate:modelValue":t=>x.value[e.fieldname]=t,rows:`3`,disabled:O(e)},null,8,[`modelValue`,`onUpdate:modelValue`,`disabled`])])):[`CURRENCY`,`FLOAT`,`INT`].includes(e.fieldtype)?(A(),s(`div`,Ze,[y(o(B),{type:`number`,modelValue:x.value[e.fieldname],"onUpdate:modelValue":t=>x.value[e.fieldname]=t,modelModifiers:{number:!0},onInput:t=>H(x.value,e.fieldname),disabled:O(e)},null,8,[`modelValue`,`onUpdate:modelValue`,`onInput`,`disabled`])])):e.fieldtype===`DATE`?(A(),s(`div`,Qe,[y(xe,{modelValue:x.value[e.fieldname],"onUpdate:modelValue":t=>x.value[e.fieldname]=t,disabled:O(e)},null,8,[`modelValue`,`onUpdate:modelValue`,`disabled`])])):e.fieldtype===`SELECT`?(A(),s(`div`,$e,[y(o(Se),{modelValue:x.value[e.fieldname],"onUpdate:modelValue":t=>x.value[e.fieldname]=t,disabled:O(e)},{default:w(()=>[y(o(we),null,{default:w(()=>[y(o(Ee),{placeholder:`Select...`})]),_:1}),y(o(Ce),null,{default:w(()=>[(A(!0),s(h,null,E(k(e),e=>(A(),v(o(Te),{key:e,value:e},{default:w(()=>[u(_(e),1)]),_:2},1032,[`value`]))),128))]),_:2},1024)]),_:2},1032,[`modelValue`,`onUpdate:modelValue`,`disabled`])])):e.fieldtype===`LINK`?(A(),s(`div`,et,[y(be,{modelValue:x.value[e.fieldname],"onUpdate:modelValue":[t=>x.value[e.fieldname]=t,t=>H(x.value,e.fieldname)],doctype:e.options,disabled:O(e)},null,8,[`modelValue`,`onUpdate:modelValue`,`doctype`,`disabled`])])):P(``,!0)],2))),128))]),y(o(_e),null,{default:w(()=>[y(o(V),{onClick:tt,class:`rounded-full bg-stone-900`},{default:w(()=>[...n[12]||=[u(`Done Editing`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`open`])],2))}},nt=T(tt,[[`__scopeId`,`data-v-1f61ae3b`]]),rt=[`innerHTML`],it={__name:`DocumentationSheet`,props:{open:{type:Boolean,default:!1},title:{type:String,default:`Documentation`},content:{type:String,default:``}},emits:[`update:open`],setup(a,{emit:s}){let c=a,l=s,d=f(()=>{if(!c.content)return`<p class="text-gray-400 italic">No documentation available.</p>`;let e=G.parse(c.content);return F.sanitize(e)});return(s,c)=>(A(),v(o(r),{open:a.open,"onUpdate:open":c[0]||=e=>l(`update:open`,e)},{default:w(()=>[y(o(e),{side:`right`,class:`w-[400px] sm:w-[540px] overflow-y-auto`},{default:w(()=>[y(o(i),null,{default:w(()=>[y(o(n),{class:`flex items-center gap-2`},{default:w(()=>[y(o(k),{class:`w-5 h-5`}),u(` `+_(a.title),1)]),_:1}),y(o(t),null,{default:w(()=>[...c[1]||=[u(` Reference documentation for this document type. `,-1)]]),_:1})]),_:1}),p(`div`,{class:`mt-6 prose prose-sm max-w-none`,innerHTML:d.value},null,8,rt)]),_:1})]),_:1},8,[`open`]))}},at=T(it,[[`__scopeId`,`data-v-ac8cb5c0`]]),ot={key:1,class:`h-full flex flex-col bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] to-slate-100/50 from-stone-100/60 from-5%`},st={class:`flex-none px-6 py-4 bg-white border-b border-gray-200 flex items-center justify-between sticky top-0 z-10`},ct={class:`flex items-center space-x-4`},lt={class:`flex items-center gap-2`},ut={class:`text-sm font-medium text-gray-500 uppercase tracking-wider`},dt={class:`text-xl font-bold text-gray-900 mt-1`},ft={class:`flex items-center space-x-3`},pt={key:0,class:`absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-20`},mt=[`disabled`],ht=[`disabled`],gt={key:3,class:`border-t border-gray-100 my-1`},_t=[`disabled`],vt=[`disabled`],yt=[`disabled`],bt={class:`flex items-center gap-3`},xt={key:0,class:`flex items-center gap-2`},St=[`disabled`],Ct=[`disabled`],wt={key:1,class:`fixed inset-0 bg-black/50 flex items-center justify-center z-50`},Tt={class:`bg-white rounded-xl shadow-xl w-full max-w-md p-6 m-4`},Et={class:`flex justify-end gap-2 mt-4`},Dt=[`disabled`],Ot={class:`flex-1 overflow-auto p-6`},kt={key:0,class:`flex justify-center items-center h-64`},At={key:1,class:`max-w-5xl mx-auto space-y-6`},jt={class:`rounded-sm p-6 pt-8`},Mt={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},Nt={class:`block text-sm font-medium text-gray-700`},Pt={key:0,class:`text-red-500`},Ft={key:0},It={key:1},Lt={key:2},Rt={key:3},zt={key:4},Bt=[`onUpdate:modelValue`,`placeholder`,`disabled`],Vt={key:5},Ht={class:`flex items-center space-x-2 cursor-pointer mt-1`},Ut=[`onUpdate:modelValue`,`disabled`],Wt={class:`text-sm text-gray-600`},Gt={key:6},Kt={key:7},qt={class:`flex items-center gap-2`},Jt=[`onUpdate:modelValue`,`disabled`],Yt=[`onUpdate:modelValue`,`disabled`],Xt={key:8},Zt={class:`flex items-center gap-2`},Qt={class:`h-10 w-10 flex items-center justify-center rounded border border-gray-300 bg-gray-50`},$t=[`onUpdate:modelValue`,`disabled`,`placeholder`],en={key:9,class:`p-2 bg-gray-50 border border-gray-100 rounded text-sm text-gray-600`},tn={key:10,class:`p-2 bg-gray-50 border border-gray-200 rounded text-xs text-gray-500`},nn={key:11,class:`text-[11px] text-gray-400 mt-1 italic px-1`},rn={__name:`DocForm`,props:{doctype:{type:String,default:null},name:{type:String,default:null},isNew:{type:Boolean,default:void 0},isEmbedded:{type:Boolean,default:!1}},emits:[`saved`],setup(e,{emit:t}){let{toast:n}=oe(),r=ve(),i=e,m=le(),ne=ue(),b=f(()=>i.doctype||m.params.doctype),C=f(()=>i.name||m.params.name),T=f(()=>i.isNew===void 0?C.value===`new`:i.isNew),ce=f(()=>{if(!b.value)return null;let e=U(b.value,`form`);return e?re(e):null}),k=M({}),F=M({}),I=M(!0),L=M(!1),R=M(!1),z=M(!1),ge=M(!1),_e=M(!1),V=M(!1),ye=M(null),De=M(!1),W=M(null),G=M(!1),K=M(!1),q=M(!1),J=M(``),Oe=new Set([`DATA`,`CURRENCY`,`FLOAT`,`INT`,`PERCENT`,`PHONE`,`EMAIL`,`PASSWORD`,`ATTACH`,`ATTACH_IMAGE`,`URL`]),ke=new Set([`CURRENCY`,`FLOAT`,`PERCENT`]),Ae=new Set([`TABLE`,`SECTION_BREAK`,`COLUMN_BREAK`]),Y=f(()=>(k.value.fields||[]).map(e=>({...e,_isDataType:Oe.has(e.fieldtype),_isNumericType:ke.has(e.fieldtype),_inputType:Fe(e.fieldtype),_parsedOptions:e.options?e.options.split(`
`):[],_step:ke.has(e.fieldtype)?`0.01`:`1`,_placeholder:e.placeholder||`Select ${e.label}...`}))),je=f(()=>Y.value.filter(e=>!Ae.has(e.fieldtype)&&!e.hidden)),Me=f(()=>Y.value.filter(e=>e.fieldtype===`TABLE`&&!e.hidden)),Ne=f(()=>{let e=new Map;for(let t of Y.value)e.set(t.fieldname,t);return e}),Pe=f(()=>{let e=new Set,t=F.value.docstatus||0;for(let n of Y.value)(n.read_only||t>0&&!n.allow_on_submit)&&e.add(n.fieldname);return e}),X=e=>Pe.value.has(e.fieldname),Fe=e=>e===`INT`||e===`FLOAT`||e===`CURRENCY`?`number`:e===`DATE`?`date`:e===`PASSWORD`?`password`:`text`,Ie=e=>({Draft:`bg-gray-100 text-gray-800`,Submitted:`bg-blue-100 text-blue-800`,Paid:`bg-green-100 text-green-800`})[e]||`bg-gray-100 text-gray-800`,Z=async()=>{I.value=!0;try{if(k.value=(await j.get(`/org/doctypes/${b.value}`,{authorizeRequest:!0,organisationAware:!0})).data||{},T.value){let e={};k.value.fields&&k.value.fields.forEach(t=>{t.default_value&&(e[t.fieldname]=t.default_value)}),F.value=e}else{if(!C.value){console.warn(`Cannot fetch document: docName is undefined`);return}F.value=(await j.get(`/org/doc/${b.value}/${C.value}`,{authorizeRequest:!0,organisationAware:!0})).data||{}}}catch(e){console.error(e);let t=e.response?.data?.message||e.message;n({title:`Failed to load`,description:t,variant:`destructive`}),F.value||={}}finally{I.value=!1}T.value||Le()};async function Le(){if(!(T.value||!b.value||!C.value))try{let e=(await j.get(`/org/doc/Approval Pipeline`,{params:{filters:JSON.stringify({target_doctype:b.value,target_document:C.value,status:`Pending`}),limit:1}})).data?.data||[];if(e.length>0){let t=e[0],n=(t.items||[]).find(e=>e.status===`Pending`);W.value=n?{...n,pipeline_name:t.name,target_doctype:t.target_doctype,target_document:t.target_document}:null}else W.value=null}catch(e){console.error(`Failed to fetch pending approval:`,e)}}let Q=f(()=>{if(!W.value)return!1;let e=me();return W.value.assigned_to===e.email});async function Re(){if(!(!W.value||G.value)){G.value=!0;try{await j.patch(`/org/doc/Approval Pipeline/${W.value.pipeline_name}`,{data:{items:[{name:W.value.name,status:`Approved`,approver:$.email,decision_time:new Date().toISOString()}]}}),n({title:`Approved`,description:`Document has been approved successfully.`,variant:`success`}),W.value=null,await Z()}catch(e){console.error(`Failed to approve:`,e),n({title:`Approval Failed`,description:e.response?.data?.message||e.message,variant:`destructive`})}finally{G.value=!1}}}async function ze(){if(!(!W.value||K.value)){K.value=!0;try{await j.patch(`/org/doc/Approval Pipeline/${W.value.pipeline_name}`,{data:{items:[{name:W.value.name,status:`Rejected`,approver:$.email,comments:J.value,decision_time:new Date().toISOString()}]}}),n({title:`Rejected`,description:`Document has been rejected.`,variant:`success`}),W.value=null,q.value=!1,J.value=``,await Z()}catch(e){console.error(`Failed to reject:`,e),n({title:`Rejection Failed`,description:e.response?.data?.message||e.message,variant:`destructive`})}finally{K.value=!1}}}function Be(e){b.value===`Sales Invoice`&&(F.value.grand_total=e.totalNet,F.value.total_tax=e.totalTax,T.value&&(F.value.outstanding_amount=e.totalNet))}let Ve=M(null);function He(){!T.value||!b.value||(Ve.value&&clearTimeout(Ve.value),Ve.value=setTimeout(()=>{r.saveFormData(b.value,F.value,!0,null)},500))}ie(F,()=>{He()},{deep:!0});let Ue=t,We=async()=>{L.value=!0;try{let e,t={data:F.value,authorizeRequest:!0,organisationAware:!0};e=T.value?await j.post(`/org/doc/${b.value}`,t):await j.patch(`/org/doc/${b.value}/${C.value}`,t);let a=e?.data;if(!a)throw Error(`Server returned empty data`);F.value=a,Ue(`saved`,a),n({title:T.value?`Created`:`Saved`,description:`${k.value.name} has been ${T.value?`created`:`saved`} successfully.`,variant:`success`}),b.value&&r.clearFormData(b.value,T.value,T.value?null:C.value),r.notifyDocSaved(b.value,a.name),T.value&&!i.name&&!i.isEmbedded&&ne.replace(`/app/${b.value}/${a.name}`)}catch(e){console.error(e);let t=e.response?.data?.message||e.message;n({title:`Error saving`,description:t,variant:`destructive`})}finally{L.value=!1}};ie(()=>m.params.name,Z),ie(C,(e,t)=>{e&&e!==t&&Z()}),ae(()=>{if(T.value&&b.value){let e=r.getFormData(b.value,!0,null);e&&e.data&&(F.value={...e.data})}Z()});let $=O(),Ge=f(()=>{if(!k.value.is_submittable||F.value.docstatus!==0)return!1;let e=k.value.config?.workflow;return e?!(e.submit_roles&&e.submit_roles.length>0&&(!$.role||!e.submit_roles.includes($.role))):!0}),Ke=async()=>{z.value=!0,R.value=!1;try{let e=(await j.patch(`/org/doc/${b.value}/${C.value}`,{data:{docstatus:1},authorizeRequest:!0,organisationAware:!0})).data?.data||{};F.value=e,Ue(`saved`,e),n({title:`Submitted`,description:`Document has been submitted successfully.`,variant:`success`})}catch(e){console.error(e);let t=e.response?.data?.message||e.message;n({title:`Result`,description:t,variant:t.includes(`submitted`)?`success`:`destructive`})}finally{z.value=!1}},qe=async()=>{try{let e=crypto.randomUUID();await j.post(`/org/doc/Public Document Access`,{data:{doctype:b.value,doc_name:C.value,token:e,access_type:`View`,max_views:0},authorizeRequest:!0,organisationAware:!0});let t=`${window.location.origin}/public/d/${e}`;navigator.clipboard.writeText(t),n({title:`Link Copied`,description:`Public link has been copied to clipboard.`,variant:`success`}),R.value=!1}catch(e){console.error(e),n({title:`Failed`,description:e.message,variant:`destructive`})}},Je=async()=>{if(confirm(`Are you sure you want to cancel this document?`)){ge.value=!0,R.value=!1;try{let e=(await j.patch(`/org/doc/${b.value}/${C.value}`,{data:{docstatus:2},authorizeRequest:!0,organisationAware:!0})).data?.data||{};F.value=e,Ue(`saved`,e),n({title:`Cancelled`,description:`Document has been cancelled.`,variant:`default`})}catch(e){console.error(e);let t=e.response?.data?.message||e.message;n({title:`Error cancelling`,description:t,variant:`destructive`})}finally{ge.value=!1}}},Ye=async()=>{if(confirm(`Are you sure you want to delete this document? This cannot be undone.`)){_e.value=!0,R.value=!1;try{await j.delete(`/org/doc/${b.value}/${C.value}`,{authorizeRequest:!0,organisationAware:!0}),n({title:`Deleted`,description:`Document has been deleted.`,variant:`default`}),ne.back()}catch(e){console.error(e);let t=e.response?.data?.message||e.message;n({title:`Error deleting`,description:t,variant:`destructive`})}finally{_e.value=!1}}},Xe=async()=>{V.value=!0;try{F.value.status=`Queued`,F.value.error_log=``,await j.patch(`/org/doc/Notification/${C.value}`,{data:{status:`Queued`,error_log:``},authorizeRequest:!0,organisationAware:!0}),n({title:`Retry Queued`,description:`Notification has been queued for retry.`,variant:`default`})}catch(e){console.error(e),n({title:`Retry Failed`,description:e.response?.data?.message||e.message,variant:`destructive`})}finally{V.value=!1}},Ze=e=>{ye.value&&!ye.value.contains(e.target)&&(R.value=!1)};return ae(()=>document.addEventListener(`click`,Ze)),pe(()=>document.removeEventListener(`click`,Ze)),(t,n)=>(A(),s(h,null,[ce.value?(A(),v(de(ce.value),{key:0,doctype:b.value,name:C.value,isNew:T.value},null,8,[`doctype`,`name`,`isNew`])):(A(),s(`div`,ot,[p(`header`,st,[p(`div`,ct,[e.isEmbedded?P(``,!0):(A(),s(`button`,{key:0,onClick:n[0]||=e=>t.$router.back(),class:`p-2 hover:bg-gray-100 rounded-full text-gray-500`},[y(o(se),{class:`w-5 h-5`})])),p(`div`,{class:D({"pl-0":e.isEmbedded})},[p(`div`,lt,[p(`span`,ut,_(k.value.name),1),F.value.status?(A(),s(`span`,{key:0,class:D([`px-2 py-0.5 rounded text-xs font-bold`,Ie(F.value.status)])},_(F.value.status),3)):P(``,!0)]),p(`h1`,dt,_(T.value?`New `+k.value.name:F.value[k.value.title_field]||F.value.name),1)],2)]),p(`div`,ft,[k.value.documentation?(A(),s(`button`,{key:0,onClick:n[1]||=e=>De.value=!0,class:`p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors`,title:`View Documentation`},[y(o(he),{class:`w-5 h-5`})])):P(``,!0),T.value?P(``,!0):(A(),s(`div`,{key:1,class:`relative`,ref_key:`actionsDropdownRef`,ref:ye},[p(`button`,{onClick:n[2]||=e=>R.value=!R.value,class:`px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-full text-sm font-medium transition-colors flex items-center gap-1`},[n[7]||=u(` Actions `,-1),y(o(te),{class:`w-4 h-4`})]),R.value?(A(),s(`div`,pt,[Ge.value?(A(),s(`button`,{key:0,onClick:Ke,disabled:z.value,class:`w-full text-left px-4 py-2 text-sm text-green-700 hover:bg-green-50 flex items-center gap-2`},[y(o(x),{class:`w-4 h-4`}),n[8]||=u(` Submit `,-1)],8,mt)):P(``,!0),k.value.is_submittable&&F.value.docstatus===1?(A(),s(`button`,{key:1,onClick:Je,disabled:ge.value,class:`w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50 flex items-center gap-2`},[y(o(N),{class:`w-4 h-4`}),n[9]||=u(` Cancel `,-1)],8,ht)):P(``,!0),T.value?P(``,!0):(A(),s(`button`,{key:2,onClick:qe,class:`w-full text-left px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 flex items-center gap-2`},[y(o(c),{class:`w-4 h-4`}),n[10]||=u(` Get Public Link `,-1)])),k.value.is_submittable&&(F.value.docstatus===0||F.value.docstatus===1)?(A(),s(`div`,gt)):P(``,!0),p(`button`,{onClick:Ye,disabled:_e.value,class:`w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2`},[y(o(d),{class:`w-4 h-4`}),n[11]||=u(` Delete `,-1)],8,_t)])):P(``,!0)],512)),b.value===`Notification`&&F.value.status===`Failed`?(A(),s(`button`,{key:2,onClick:Xe,disabled:V.value,class:`px-5 py-2 bg-amber-500 text-white rounded-full text-sm font-medium hover:bg-amber-600 transition-colors flex items-center gap-2 shadow-sm`},[V.value?(A(),v(o(ee),{key:1,class:`w-4 h-4 animate-spin`})):(A(),v(o(fe),{key:0,class:`w-4 h-4`})),n[12]||=u(` Retry `,-1)],8,vt)):P(``,!0),p(`button`,{onClick:We,disabled:L.value,class:`px-6 py-2 bg-black text-white rounded-full text-sm font-medium hover:bg-gray-900 transition-colors flex items-center gap-2 shadow-sm`},[L.value?(A(),v(o(ee),{key:0,class:`w-4 h-4 animate-spin`})):P(``,!0),u(` `+_(T.value?`Create`:`Save`),1)],8,yt)])]),W.value?(A(),s(`div`,{key:0,class:D([`mx-6 mt-4 p-4 rounded-xl border flex items-center justify-between gap-4`,Q.value?`bg-amber-50 border-amber-200`:`bg-gray-50 border-gray-200`])},[p(`div`,bt,[p(`div`,{class:D([`w-10 h-10 rounded-full flex items-center justify-center`,Q.value?`bg-amber-500`:`bg-gray-400`])},[y(o(x),{class:`w-5 h-5 text-white`})],2),p(`div`,null,[p(`h3`,{class:D([`font-semibold`,Q.value?`text-amber-900`:`text-gray-700`])},_(Q.value?`Approval Required`:`Pending Approval`),3),p(`p`,{class:D([`text-sm`,Q.value?`text-amber-700`:`text-gray-500`])},_(W.value.stage_name||`Approval`)+` • Assigned to `+_(W.value.assigned_to),3)])]),Q.value?(A(),s(`div`,xt,[p(`button`,{onClick:Re,disabled:G.value,class:`px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-1`},[y(o(x),{class:`w-4 h-4`}),n[13]||=u(` Approve `,-1)],8,St),p(`button`,{onClick:n[3]||=e=>q.value=!0,disabled:K.value,class:`px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-1`},[y(o(N),{class:`w-4 h-4`}),n[14]||=u(` Reject `,-1)],8,Ct)])):P(``,!0)],2)):P(``,!0),q.value?(A(),s(`div`,wt,[p(`div`,Tt,[n[15]||=p(`h3`,{class:`text-lg font-semibold text-gray-900 mb-4`},`Reject Document`,-1),S(p(`textarea`,{"onUpdate:modelValue":n[4]||=e=>J.value=e,rows:`3`,placeholder:`Reason for rejection (optional)`,class:`w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-red-500`},null,512),[[g,J.value]]),p(`div`,Et,[p(`button`,{onClick:n[5]||=e=>{q.value=!1,J.value=``},class:`px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors`},` Cancel `),p(`button`,{onClick:ze,disabled:K.value,class:`px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors`},` Reject `,8,Dt)])])])):P(``,!0),p(`div`,Ot,[I.value?(A(),s(`div`,kt,[...n[16]||=[p(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-black`},null,-1)]])):(A(),s(`div`,At,[p(`div`,jt,[p(`div`,Mt,[(A(!0),s(h,null,E(je.value,e=>(A(),s(`div`,{key:e.fieldname,class:D([`space-y-1`,{"col-span-2":e.fieldtype===`TEXT`||e.fieldtype===`LONG_TEXT`||e.fieldtype===`TABLE`||e.fieldtype===`HTML`}])},[p(`label`,Nt,[u(_(e.label)+` `,1),e.reqd?(A(),s(`span`,Pt,`*`)):P(``,!0)]),e._isDataType?(A(),s(`div`,Ft,[y(B,{class:`bg-white/40`,type:e._inputType,modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,placeholder:e.placeholder,disabled:X(e),step:e._step},null,8,[`type`,`modelValue`,`onUpdate:modelValue`,`placeholder`,`disabled`,`step`])])):e.fieldtype===`SELECT`?(A(),s(`div`,It,[y(o(Se),{modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:X(e)},{default:w(()=>[y(o(we),{class:`bg-white/40`},{default:w(()=>[y(o(Ee),{placeholder:e._placeholder},null,8,[`placeholder`])]),_:2},1024),y(o(Ce),null,{default:w(()=>[y(o(a),null,{default:w(()=>[(A(!0),s(h,null,E(e._parsedOptions,e=>(A(),v(o(Te),{key:e,value:e},{default:w(()=>[u(_(e),1)]),_:2},1032,[`value`]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,[`modelValue`,`onUpdate:modelValue`,`disabled`])])):e.fieldtype===`DATE`?(A(),s(`div`,Lt,[y(xe,{modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,placeholder:e.placeholder,disabled:X(e)},null,8,[`modelValue`,`onUpdate:modelValue`,`placeholder`,`disabled`])])):[`DATETIME`,`TIME`].includes(e.fieldtype)?(A(),s(`div`,Rt,[y(B,{class:`bg-white/40`,type:e.fieldtype===`TIME`?`time`:`datetime-local`,modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:X(e)},null,8,[`type`,`modelValue`,`onUpdate:modelValue`,`disabled`])])):[`TEXT`,`SMALL_TEXT`,`LONG_TEXT`,`HTML`,`JSON`].includes(e.fieldtype)?(A(),s(`div`,zt,[S(p(`textarea`,{class:`flex min-h-[80px] w-full rounded-xl border border-input bg-white/40 px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all focus:ring-black/5`,"onUpdate:modelValue":t=>F.value[e.fieldname]=t,placeholder:e.placeholder,disabled:X(e),rows:`3`},null,8,Bt),[[g,F.value[e.fieldname]]])])):e.fieldtype===`CHECKBOX`?(A(),s(`div`,Vt,[p(`label`,Ht,[S(p(`input`,{type:`checkbox`,"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:X(e),class:`w-4 h-4 text-black rounded border-gray-300 focus:ring-black`},null,8,Ut),[[l,F.value[e.fieldname]]]),p(`span`,Wt,_(e.label),1)])])):e.fieldtype===`LINK`?(A(),s(`div`,Gt,[e.meta?.link_doctype_field?(A(),s(h,{key:0},[F.value[e.meta.link_doctype_field]?(A(),v(be,{modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,doctype:F.value[e.meta.link_doctype_field],label:e.label,placeholder:e._placeholder,disabled:X(e),key:`${e.fieldname}-${F.value[e.meta.link_doctype_field]}`},null,8,[`modelValue`,`onUpdate:modelValue`,`doctype`,`label`,`placeholder`,`disabled`])):(A(),v(B,{key:1,type:`text`,disabled:``,placeholder:`Select ${Ne.value.get(e.meta.link_doctype_field)?.label||`DocType`} first...`,class:`w-full bg-gray-100 border border-gray-200 rounded-full text-gray-400 cursor-not-allowed`},null,8,[`placeholder`]))],64)):(A(),v(be,{key:1,modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,doctype:e.options,label:e.label,placeholder:e._placeholder,disabled:X(e)},null,8,[`modelValue`,`onUpdate:modelValue`,`doctype`,`label`,`placeholder`,`disabled`]))])):e.fieldtype===`COLOR`?(A(),s(`div`,Kt,[p(`div`,qt,[S(p(`input`,{type:`color`,"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:X(e),class:`h-10 w-10 p-1 rounded border border-gray-300 shadow-sm`},null,8,Jt),[[g,F.value[e.fieldname]]]),S(p(`input`,{type:`text`,"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:X(e),class:`flex-1 px-4 py-2 border border-gray-300 rounded-full focus:ring-2 focus:ring-black outline-none transition-all`},null,8,Yt),[[g,F.value[e.fieldname]]])])])):e.fieldtype===`ICON`?(A(),s(`div`,Xt,[p(`div`,Zt,[p(`div`,Qt,[y(H,{name:F.value[e.fieldname]||`Layers`,class:`size-5 text-gray-600`},null,8,[`name`])]),S(p(`input`,{type:`text`,"onUpdate:modelValue":t=>F.value[e.fieldname]=t,disabled:X(e),placeholder:e.placeholder||`Enter Lucide icon name (e.g., Bell, FileText)`,class:`flex-1 px-4 py-2 border border-gray-300 rounded-full focus:ring-2 focus:ring-black outline-none transition-all`},null,8,$t),[[g,F.value[e.fieldname]]])])])):e.fieldtype===`READ_ONLY`?(A(),s(`div`,en,_(F.value[e.fieldname]||`-`),1)):(A(),s(`div`,tn,` Unsupported field: `+_(e.fieldtype),1)),e.description?(A(),s(`p`,nn,_(e.description),1)):P(``,!0)],2))),128))])]),(A(!0),s(h,null,E(Me.value,e=>(A(),s(`div`,{key:e.fieldname,class:`bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden p-4`},[y(nt,{fieldname:e.fieldname,options:e.options,label:e.label,modelValue:F.value[e.fieldname],"onUpdate:modelValue":t=>F.value[e.fieldname]=t,onTotalsChanged:Be,disabled:t.isLocked},null,8,[`fieldname`,`options`,`label`,`modelValue`,`onUpdate:modelValue`,`disabled`])]))),128))]))])])),y(at,{open:De.value,"onUpdate:open":n[6]||=e=>De.value=e,title:k.value.name,content:k.value.documentation},null,8,[`open`,`title`,`content`])],64))}};export{rn as t};