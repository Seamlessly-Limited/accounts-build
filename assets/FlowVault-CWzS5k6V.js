import"./useFormControl-BoSoz5bk.js";import"./ListboxItem-CrspQUEb.js";import"./nullish-CfjOSA4G.js";import"./CheckboxIndicator-Cu1vLZmL.js";import"./useArrowNavigation-siWGBYoD.js";import"./ConfigProvider-BeNpEDZu.js";import"./useHideOthers-8j3pZZC2.js";import"./useDirection-CkCaHLjJ.js";import"./PopperAnchor-DePKnfPt.js";import"./useId-C9uHTJK1.js";import"./useKbd-BvGB3m10.js";import"./PopperContent-CkzV4Efh.js";import"./useTypeahead-J2lSWUJi.js";import"./Teleport-CO7T90ZX.js";import"./utils-1j6W-LC4.js";import"./utils-d0L3vlW4.js";import"./RovingFocusGroup-Dae6_7oN.js";import"./RovingFocusItem-h4PGPL5z.js";import"./VisuallyHiddenInput-Cr3vcfNb.js";import{i as e,n as t,r as n,s as r,t as i}from"./ComboboxItem-BV80ucMH.js";import"./DropdownMenuTrigger-EYKS1OZz.js";import{Aa as a,Bi as o,Bn as s,C as c,Cn as l,Gt as u,Hi as d,Ii as f,It as p,Jn as m,Kn as h,Li as g,Ln as _,Ni as v,P as y,Pa as b,Pn as x,Ri as S,Ti as C,Ui as w,Un as T,Vn as E,Z as D,_r as O,a as k,b as A,br as j,cn as M,da as N,ea as P,ft as F,ga as I,hn as L,hr as R,i as z,ia as B,ja as V,ji as H,mr as U,na as W,o as G,rr as ee,sa as K,ta as q,wa as J,wi as Y,x as X,zi as Z}from"./index-BW6FH5S4.js";import{t as te}from"./Input-AKTRhZx5.js";import{t as Q}from"./button-BIS6kOZQ.js";import{i as ne,n as re,r as ie,t as ae}from"./DropdownMenuTrigger-B4m7ovRB.js";import{t as oe}from"./BackgroundAnimation-D58OrQ52.js";import{t as se}from"./BankAccountService-CD5xD1o7.js";import{t as ce}from"./Checkbox-x25APZEJ.js";var le={class:`flex flex-col items-center`},ue={class:`flex-1 min-w-0`},de={class:`flex items-center justify-between gap-2 mb-1`},fe={class:`font-medium text-slate-800`},pe={class:`text-xs text-slate-400`},me={class:`flex items-center gap-2 mt-2 text-sm text-slate-500`},he={key:0},ge={key:1,class:`text-xs text-slate-400 font-mono`},_e={__name:`FlowEventCard`,props:{event:{type:Object,required:!0},isLast:{type:Boolean,default:!1}},emits:[`click`],setup(e){let t=e,n=f(()=>t.event.eventType===`INCOMING_PAYMENT`),r=f(()=>t.event.eventType===`SETTLEMENT_COMPLETED`),i=f(()=>t.event.eventType===`SETTLEMENT_FAILED`),c=f(()=>t.event.eventType===`SETTLEMENT_INITIATED`),l=f(()=>n.value?j:r.value?s:i.value?_:c.value?x:U),u=f(()=>{switch(t.event.eventType){case`INCOMING_PAYMENT`:return`Payment received`;case`SETTLEMENT_INITIATED`:return`Settlement initiated`;case`SETTLEMENT_COMPLETED`:return`Settled to bank`;case`SETTLEMENT_FAILED`:return`Settlement failed`;default:return t.event.eventType}}),d=f(()=>n.value?`animate-slide-in-left`:`animate-slide-in-right`),p=f(()=>n.value?`bg-emerald-100 text-emerald-600`:r.value?`bg-blue-100 text-blue-600`:i.value?`bg-orange-100 text-orange-600`:(c.value,`bg-slate-100 text-slate-600`)),m=f(()=>n.value?`from-emerald-200 to-transparent`:r.value?`from-blue-200 to-transparent`:`from-slate-200 to-transparent`),v=f(()=>n.value?`text-emerald-600`:r.value?`text-blue-600`:i.value?`text-orange-600`:`text-slate-700`),y=f(()=>{let e=t.event.payload?.amount,n=t.event.payload?.currency||`NGN`;return e?new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:n,minimumFractionDigits:0,maximumFractionDigits:2}).format(e):`—`}),C=f(()=>{if(!t.event.timestamp)return``;let e=new Date(t.event.timestamp),n=new Date-e,r=Math.floor(n/6e4),i=Math.floor(n/36e5),a=Math.floor(n/864e5);return r<1?`Just now`:r<60?`${r}m ago`:i<24?`${i}h ago`:a<7?`${a}d ago`:e.toLocaleDateString(`en-NG`,{day:`numeric`,month:`short`})}),T=e=>e?e.length<=12?e:e.substring(0,6)+`...`+e.substring(e.length-4):``;return(t,n)=>(W(),o(`div`,{class:V([`flow-event-card group relative flex items-start gap-4 p-4 rounded-xl transition-all duration-300 hover:bg-slate-50/50 cursor-pointer`,d.value]),onClick:n[0]||=n=>t.$emit(`click`,e.event)},[g(`div`,le,[g(`div`,{class:V([`w-10 h-10 rounded-full flex items-center justify-center shrink-0 transition-all duration-300`,p.value])},[(W(),S(K(l.value),{class:`w-5 h-5`}))],2),e.isLast?Z(``,!0):(W(),o(`div`,{key:0,class:V([`w-0.5 h-full min-h-[40px] mt-2 rounded-full bg-gradient-to-b`,m.value])},null,2))]),g(`div`,ue,[g(`div`,de,[g(`span`,fe,b(u.value),1),g(`span`,pe,b(C.value),1)]),g(`div`,{class:V([`text-lg font-semibold`,v.value])},b(y.value),3),g(`div`,me,[e.event.payload?.payerName||e.event.payload?.bankName?(W(),o(`span`,he,b(e.event.payload?.payerName||e.event.payload?.bankName),1)):Z(``,!0),e.event.eventRef?(W(),o(`span`,ge,b(T(e.event.eventRef)),1)):Z(``,!0)])]),w(a(h),{class:`w-4 h-4 text-slate-300 group-hover:text-slate-500 transition-colors shrink-0 mt-1`})],2))}},ve=z(_e,[[`__scopeId`,`data-v-245f882a`]]),ye={class:`flex items-center justify-between mb-3`},be={class:`flex items-center gap-2`},xe={class:`text-xs text-slate-400`},Se={key:0,class:`flex items-center justify-between`},Ce={class:`flex items-center gap-2`},we={key:1,class:`flex items-center justify-between`},Te={class:`flex items-center gap-2`},Ee={class:`text-lg font-semibold text-emerald-600`},De={class:`mt-1 text-xs text-slate-400 font-mono`},Oe={key:1,class:`flex items-center gap-2 pl-4 my-2`},ke=[`onClick`],Ae={class:`flex items-center justify-between`},je={class:`flex items-center gap-2`},Me={class:`text-xs text-slate-600`},Ne={__name:`FlowEventGroup`,props:{group:{type:Object,required:!0}},emits:[`event-click`],setup(e){let t=e,n=f(()=>t.group.payment?.eventType===`VAULT_ACTIVATED`?`ACTIVATED`:t.group.status||`PENDING`),r=f(()=>{switch(n.value){case`COMPLETED`:return`Settled`;case`FAILED`:return`Failed`;case`INITIATED`:return`Settling...`;case`ACTIVATED`:return`Active`;default:return`Pending`}}),i=f(()=>{switch(n.value){case`COMPLETED`:return s;case`FAILED`:return _;case`INITIATED`:return p;case`ACTIVATED`:return D;default:return x}}),c=f(()=>{switch(n.value){case`COMPLETED`:return`bg-blue-50/50 border-blue-200`;case`FAILED`:return`bg-orange-50/50 border-orange-200`;case`ACTIVATED`:return`bg-slate-50/50 border-slate-200`;default:return`bg-slate-50/50 border-slate-200`}}),l=f(()=>{switch(n.value){case`COMPLETED`:return`bg-blue-100 text-blue-600`;case`FAILED`:return`bg-orange-100 text-orange-600`;case`ACTIVATED`:return`bg-blue-100 text-blue-600`;default:return`bg-slate-100 text-slate-500`}}),u=f(()=>{switch(n.value){case`COMPLETED`:return`text-blue-600`;case`FAILED`:return`text-orange-600`;case`ACTIVATED`:return`text-blue-600`;default:return`text-slate-500`}}),d=f(()=>{let e=t.group.payment?.timestamp;return e?new Date(e).toLocaleDateString(`en-NG`,{day:`numeric`,month:`short`,hour:`2-digit`,minute:`2-digit`}):``}),m=f(()=>{let e=t.group.payment;return e?h(e.payload?.amount,e.payload?.currency):`—`}),h=(e,t=`NGN`)=>e?new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:t,minimumFractionDigits:0,maximumFractionDigits:2}).format(e):`—`,y=e=>e?e.length<=12?e:e.substring(0,6)+`...`+e.substring(e.length-4):``,C=e=>e.eventType===`SETTLEMENT_COMPLETED`?s:e.eventType===`SETTLEMENT_FAILED`?_:x,T=e=>e.eventType===`SETTLEMENT_COMPLETED`?`text-blue-500`:e.eventType===`SETTLEMENT_FAILED`?`text-orange-500`:`text-slate-400`,E=e=>e.eventType===`SETTLEMENT_COMPLETED`?`Settled to bank`:e.eventType===`SETTLEMENT_FAILED`?`Settlement failed`:`Settling...`,O=e=>e.eventType===`SETTLEMENT_COMPLETED`?`border-blue-200 bg-blue-50/50`:e.eventType===`SETTLEMENT_FAILED`?`border-orange-200 bg-orange-50/50`:`border-slate-200`,k=e=>e.eventType===`SETTLEMENT_COMPLETED`?`text-blue-600`:e.eventType===`SETTLEMENT_FAILED`?`text-orange-600`:`text-slate-600`;return(t,n)=>(W(),o(`div`,{class:V([`flow-event-group p-4 rounded-xl border`,c.value])},[g(`div`,ye,[g(`div`,be,[g(`div`,{class:V([`w-8 h-8 rounded-full flex items-center justify-center`,l.value])},[(W(),S(K(i.value),{class:`w-4 h-4`}))],2),g(`span`,{class:V([`text-xs font-medium uppercase tracking-wide`,u.value])},b(r.value),3)]),g(`span`,xe,b(d.value),1)]),e.group.payment?(W(),o(`div`,{key:0,class:`p-3 rounded-lg bg-white border cursor-pointer hover:bg-slate-50 transition-colors`,onClick:n[0]||=n=>t.$emit(`event-click`,e.group.payment)},[e.group.payment.eventType===`VAULT_ACTIVATED`?(W(),o(`div`,Se,[g(`div`,Ce,[w(a(D),{class:`w-4 h-4 text-blue-500`}),n[1]||=g(`span`,{class:`text-sm font-medium text-slate-700`},`Vault Activated`,-1)]),n[2]||=g(`span`,{class:`text-xs text-slate-500`},`System Event`,-1)])):(W(),o(`div`,we,[g(`div`,Te,[w(a(j),{class:`w-4 h-4 text-emerald-500`}),n[3]||=g(`span`,{class:`text-sm font-medium text-slate-700`},`Payment received`,-1)]),g(`span`,Ee,b(m.value),1)])),g(`div`,De,b(y(e.group.payment?.eventRef)),1)])):Z(``,!0),e.group.settlements?.length?(W(),o(`div`,Oe,[n[4]||=g(`div`,{class:`w-0.5 h-4 bg-slate-200`},null,-1),w(a(R),{class:`w-3 h-3 text-slate-400`})])):Z(``,!0),(W(!0),o(v,null,B(e.group.settlements,e=>(W(),o(`div`,{key:e.hash,class:V([`ml-6 p-2 rounded-lg border cursor-pointer hover:bg-slate-50 transition-colors`,O(e)]),onClick:n=>t.$emit(`event-click`,e)},[g(`div`,Ae,[g(`div`,je,[(W(),S(K(C(e)),{class:V([`w-3 h-3`,T(e)])},null,8,[`class`])),g(`span`,Me,b(E(e)),1)]),g(`span`,{class:V([`text-sm font-medium`,k(e)])},b(h(e.payload?.amount,e.payload?.currency)),3)])],10,ke))),128))],2))}},$={async getVaultStatus(){let e=await G.get(`/org/flow-vault`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e},async getTimeline(e=0,t=20){let n=await G.get(`/org/flow-vault/timeline`,{query:{page:e,size:t},authorizeRequest:!0,organisationAware:!0});return n?.data||n},async verifyChain(){let e=await G.get(`/org/flow-vault/verify`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e},async exportJsonl(){let e=await G.get(`/org/flow-vault/export/jsonl`,{responseType:`blob`,authorizeRequest:!0,organisationAware:!0}),t=window.URL.createObjectURL(new Blob([e])),n=document.createElement(`a`);n.href=t,n.setAttribute(`download`,`flowvault-${new Date().toISOString().split(`T`)[0]}.jsonl`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t)},async exportCsv(){let e=await G.get(`/org/flow-vault/export/csv`,{responseType:`blob`,authorizeRequest:!0,organisationAware:!0}),t=window.URL.createObjectURL(new Blob([e])),n=document.createElement(`a`);n.href=t,n.setAttribute(`download`,`flowvault-${new Date().toISOString().split(`T`)[0]}.csv`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t)},async getGroupedTimeline(){let e=await G.get(`/org/flow-vault/timeline/grouped`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e}},Pe={class:`flow-timeline`},Fe={class:`flex items-center justify-between mb-4`},Ie={class:`text-sm text-slate-500`},Le={key:0,class:`flex items-center justify-center py-12`},Re={key:1,class:`text-center py-12`},ze={class:`w-16 h-16 mx-auto mb-4 rounded-full bg-slate-100 flex items-center justify-center`},Be={key:2,class:`space-y-4`},Ve={key:3,class:`space-y-0`},He={__name:`FlowTimeline`,props:{pageSize:{type:Number,default:20}},emits:[`event-click`],setup(e,{expose:t,emit:n}){let r=e,i=n,s=J([]),c=J([]),l=J(!0),h=J(!1),_=J(!1),y=J(0),x=J(null),T=J(!0),E=null,D=f(()=>T.value?c.value.length===0:s.value.length===0),k=async()=>{try{l.value=!0;let e=await $.getTimeline(0,r.pageSize);s.value=e.content||[],_.value=!e.last,y.value=0}catch(e){console.error(`Failed to load timeline:`,e)}finally{l.value=!1}},A=async()=>{try{l.value=!0,c.value=await $.getGroupedTimeline()}catch(e){console.error(`Failed to load grouped timeline:`,e)}finally{l.value=!1}},j=async()=>{if(!(h.value||!_.value||T.value))try{h.value=!0,y.value++;let e=await $.getTimeline(y.value,r.pageSize);s.value.push(...e.content||[]),_.value=!e.last}catch(e){console.error(`Failed to load more events:`,e),y.value--}finally{h.value=!1}},M=()=>{T.value=!T.value,T.value?A():k()},N=e=>{i(`event-click`,e)},F=()=>{x.value&&(E=new IntersectionObserver(e=>{e[0].isIntersecting&&_.value&&!h.value&&!T.value&&j()},{threshold:.1}),E.observe(x.value))};return P(()=>{A(),setTimeout(F,500)}),q(()=>{E&&E.disconnect()}),t({refresh:()=>T.value?A():k()}),(e,t)=>(W(),o(`div`,Pe,[g(`div`,Fe,[g(`span`,Ie,b(T.value?`Grouped by payment`:`All events`),1),g(`button`,{onClick:M,class:V([`text-xs px-3 py-1 rounded-full border transition-colors`,T.value?`bg-blue-50 border-blue-200 text-blue-600`:`bg-slate-50 border-slate-200 text-slate-600`])},[w(a(u),{class:`w-3 h-3 inline mr-1`}),d(` `+b(T.value?`Show flat`:`Group by payment`),1)],2)]),l.value?(W(),o(`div`,Le,[w(a(p),{class:`w-6 h-6 animate-spin text-slate-400`})])):D.value?(W(),o(`div`,Re,[g(`div`,ze,[w(a(O),{class:`w-8 h-8 text-slate-400`})]),t[0]||=g(`h3`,{class:`text-lg font-medium text-slate-700 mb-2`},`No events yet`,-1),t[1]||=g(`p`,{class:`text-sm text-slate-500 max-w-sm mx-auto`},` Incoming payments and settlements will appear here as they flow through your vault. `,-1)])):T.value?(W(),o(`div`,Be,[w(C,{name:`timeline`},{default:I(()=>[(W(!0),o(v,null,B(c.value,e=>(W(),S(Ne,{key:e.payment?.hash||e.settlements?.[0]?.hash,group:e,onEventClick:N},null,8,[`group`]))),128))]),_:1})])):(W(),o(`div`,Ve,[w(C,{name:`timeline`},{default:I(()=>[(W(!0),o(v,null,B(s.value,(e,t)=>(W(),S(ve,{key:e.hash||e.index,event:e,"is-last":t===s.value.length-1,onClick:t=>N(e)},null,8,[`event`,`is-last`,`onClick`]))),128))]),_:1}),_.value?(W(),o(`div`,{key:0,ref_key:`loadMoreTrigger`,ref:x,class:`py-4 flex items-center justify-center`},[h.value?(W(),S(a(p),{key:1,class:`w-5 h-5 animate-spin text-slate-400`})):(W(),o(`button`,{key:0,onClick:j,class:`text-sm text-slate-500 hover:text-slate-700 flex items-center gap-2`},[w(a(m),{class:`w-4 h-4`}),t[2]||=d(` Load more `,-1)]))],512)):Z(``,!0)]))]))}},Ue=z(He,[[`__scopeId`,`data-v-dea6f07d`]]),We={key:0,class:`flow-event-drawer fixed inset-y-0 right-0 w-full max-w-md bg-white shadow-xl z-50 flex flex-col`},Ge={class:`flex items-center justify-between p-4 border-b`},Ke={class:`text-sm text-slate-500`},qe={key:0,class:`flex-1 overflow-y-auto p-4 space-y-6`},Je={class:`text-2xl font-bold`},Ye={class:`space-y-4`},Xe={class:`text-slate-700`},Ze={key:0},Qe={class:`text-slate-700 font-mono text-sm`},$e={key:1},et={class:`text-slate-700`},tt={key:2},nt={class:`text-slate-700`},rt={key:3},it={class:`text-slate-700`},at={key:4},ot={class:`text-slate-700 font-mono`},st={key:5},ct={class:`text-orange-600`},lt={class:`space-y-3`},ut={class:`text-sm font-medium text-slate-700 flex items-center gap-2`},dt={class:`text-slate-700 font-mono`},ft={class:`text-slate-700 font-mono text-xs break-all bg-slate-50 p-2 rounded`},pt={class:`text-slate-700 font-mono text-xs break-all bg-slate-50 p-2 rounded`},mt={key:0,class:`space-y-3`},ht={class:`text-slate-700 font-mono text-sm`},gt={class:`p-4 border-t bg-slate-50`},_t={class:`flex items-center justify-between text-xs text-slate-500`},vt={class:`flex items-center gap-1 text-emerald-500`},yt={__name:`FlowEventDrawer`,props:{event:{type:Object,default:null},isOpen:{type:Boolean,default:!1}},emits:[`close`],setup(e,{emit:t}){let n=e,r=t,i=()=>r(`close`),s=f(()=>n.event?.eventType===`INCOMING_PAYMENT`),c=f(()=>n.event?.eventType===`SETTLEMENT_COMPLETED`),l=f(()=>{if(!n.event)return``;switch(n.event.eventType){case`INCOMING_PAYMENT`:return`Payment Received`;case`SETTLEMENT_INITIATED`:return`Settlement Initiated`;case`SETTLEMENT_COMPLETED`:return`Settled to Bank`;case`SETTLEMENT_FAILED`:return`Settlement Failed`;default:return n.event.eventType}}),u=f(()=>s.value?`bg-emerald-50 text-emerald-700`:c.value?`bg-blue-50 text-blue-700`:`bg-slate-50 text-slate-700`),p=f(()=>{if(!n.event?.payload?.amount)return`—`;let e=n.event.payload.currency||`NGN`;return new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:e,minimumFractionDigits:0,maximumFractionDigits:2}).format(n.event.payload.amount)}),m=f(()=>n.event?.timestamp?new Date(n.event.timestamp).toLocaleString(`en-NG`,{dateStyle:`full`,timeStyle:`short`}):``);return(t,n)=>(W(),o(v,null,[w(Y,{name:`drawer`},{default:I(()=>[e.isOpen?(W(),o(`div`,We,[g(`div`,Ge,[g(`div`,null,[n[0]||=g(`h2`,{class:`text-lg font-semibold text-slate-800`},`Event Details`,-1),g(`p`,Ke,b(l.value),1)]),g(`button`,{onClick:i,class:`p-2 rounded-lg hover:bg-slate-100 transition-colors`},[w(a(X),{class:`w-5 h-5 text-slate-500`})])]),e.event?(W(),o(`div`,qe,[g(`div`,{class:V([`p-4 rounded-xl`,u.value])},[n[1]||=g(`div`,{class:`text-sm opacity-75 mb-1`},`Amount`,-1),g(`div`,Je,b(p.value),1)],2),g(`div`,Ye,[g(`div`,null,[n[2]||=g(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Timestamp`,-1),g(`p`,Xe,b(m.value),1)]),e.event.eventRef?(W(),o(`div`,Ze,[n[3]||=g(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Reference`,-1),g(`p`,Qe,b(e.event.eventRef),1)])):Z(``,!0),e.event.payload?.payerName?(W(),o(`div`,$e,[n[4]||=g(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Payer`,-1),g(`p`,et,b(e.event.payload.payerName),1)])):Z(``,!0),e.event.payload?.payerEmail?(W(),o(`div`,tt,[n[5]||=g(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Payer Email`,-1),g(`p`,nt,b(e.event.payload.payerEmail),1)])):Z(``,!0),e.event.payload?.bankName?(W(),o(`div`,rt,[n[6]||=g(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Bank`,-1),g(`p`,it,b(e.event.payload.bankName),1)])):Z(``,!0),e.event.payload?.accountNumber?(W(),o(`div`,at,[n[7]||=g(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Account`,-1),g(`p`,ot,b(e.event.payload.accountNumber),1)])):Z(``,!0),e.event.payload?.failureReason?(W(),o(`div`,st,[n[8]||=g(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Failure Reason`,-1),g(`p`,ct,b(e.event.payload.failureReason),1)])):Z(``,!0)]),n[15]||=g(`hr`,{class:`border-slate-100`},null,-1),g(`div`,lt,[g(`h3`,ut,[w(a(D),{class:`w-4 h-4 text-emerald-500`}),n[9]||=d(` Chain Verification `,-1)]),g(`div`,null,[n[10]||=g(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Block Index`,-1),g(`p`,dt,b(e.event.index),1)]),g(`div`,null,[n[11]||=g(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Block Hash`,-1),g(`p`,ft,b(e.event.hash),1)]),g(`div`,null,[n[12]||=g(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Previous Hash`,-1),g(`p`,pt,b(e.event.prevHash||`(genesis block)`),1)])]),e.event.payload?.flwRef?(W(),o(`div`,mt,[n[14]||=g(`h3`,{class:`text-sm font-medium text-slate-700`},`PSP Reference IDs`,-1),g(`div`,null,[n[13]||=g(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Flutterwave Ref`,-1),g(`p`,ht,b(e.event.payload.flwRef),1)])])):Z(``,!0)])):Z(``,!0),g(`div`,gt,[g(`div`,_t,[n[17]||=g(`span`,null,`Cryptographically verified`,-1),g(`div`,vt,[w(a(E),{class:`w-3.5 h-3.5`}),n[16]||=g(`span`,null,`Chain intact`,-1)])])])])):Z(``,!0)]),_:1}),w(Y,{name:`fade`},{default:I(()=>[e.isOpen?(W(),o(`div`,{key:0,class:`fixed inset-0 bg-black/20 z-40`,onClick:i})):Z(``,!0)]),_:1})],64))}},bt=z(yt,[[`__scopeId`,`data-v-90a5feef`]]),xt={async getSettlementAccounts(){return(await G.get(`/org/settlement-accounts`,{authorizeRequest:!0,organisationAware:!0}))?.data||[]},async getSupportedBanks(){return(await G.get(`/org/settlement-accounts/banks`,{authorizeRequest:!0,organisationAware:!0}))?.data||[]},async validateBankAccount(e,t){let n=await G.post(`/org/settlement-accounts/validate`,{data:{bankCode:e,accountNumber:t},authorizeRequest:!0,organisationAware:!0});return n?.data||n},async createSettlementAccount(e){let t=await G.post(`/org/settlement-accounts`,{data:e,authorizeRequest:!0,organisationAware:!0});return t?.data||t},async setPrimaryAccount(e){let t=await G.patch(`/org/settlement-accounts/${e}`,{data:{primary:!0},authorizeRequest:!0,organisationAware:!0});return t?.data||t},async disableAccount(e){let t=await G.patch(`/org/settlement-accounts/${e}`,{data:{enabled:!1},authorizeRequest:!0,organisationAware:!0});return t?.data||t},async getPrimaryAccount(){return(await G.get(`/org/settlement-accounts/primary`,{authorizeRequest:!0,organisationAware:!0}))?.data||null}},St={class:`flex items-center justify-center min-h-screen p-4`},Ct={class:`p-6 space-y-4`},wt={class:`relative`},Tt={key:0,class:`py-3 text-center text-slate-500`},Et={key:0,class:`py-3 text-center text-slate-500 text-sm`},Dt={key:0,class:`flex items-center gap-2 text-slate-500`},Ot={key:1,class:`p-3 rounded-xl bg-emerald-50 border border-emerald-200`},kt={class:`flex items-center gap-2 text-emerald-700`},At={class:`text-sm font-medium`},jt={key:2,class:`p-3 rounded-xl bg-orange-50 border border-orange-200`},Mt={class:`flex items-center gap-2 text-orange-700`},Nt={class:`text-sm`},Pt={class:`flex items-center gap-2 py-4`},Ft={class:`p-6 border-t rounded-b-2xl flex items-center justify-end gap-3`},It={__name:`SettlementAccountDialog`,props:{isOpen:{type:Boolean,default:!1}},emits:[`close`,`created`],setup(s,{emit:c}){let l=c,u=k(),m=J({accountNumber:``,makePrimary:!0}),h=J([]),_=J(!1),y=J(``),x=J(!1),C=J(null),D=J(null),O=J(!1),A=f(()=>{let e=new Map;for(let t of h.value)e.set(t.name,t);return e}),j=f(()=>y.value?A.value.get(y.value):null),M=f(()=>h.value),P=f(()=>j.value&&m.value.accountNumber.length===10&&C.value&&!x.value),F=async()=>{if(!(_.value||h.value.length>0)){_.value=!0;try{let{data:e}=await se.getBanksByCountry(`NG`);h.value=(e||[]).sort((e,t)=>e.name.localeCompare(t.name))}catch(e){console.error(`Failed to load banks:`,e)}finally{_.value=!1}}},L=e=>{e&&h.value.length===0&&F()},R=e=>{let t=String(e).replace(/\D/g,``).slice(0,10);m.value.accountNumber=t,C.value=null,D.value=null,t.length===10&&j.value&&z()},z=async()=>{if(!(!j.value||m.value.accountNumber.length!==10)){x.value=!0,D.value=null,C.value=null;try{let e=await se.validateAccount(`NG`,j.value.code,m.value.accountNumber);C.value=e.data?.data||e.data}catch(e){D.value=e.response?.data?.message||e.response?.data||`Could not verify account`}finally{x.value=!1}}},V=async()=>{if(P.value){O.value=!0;try{let e=await xt.createSettlementAccount({name:C.value.account_name,bankCode:j.value.code,bankName:j.value.name,accountNumber:m.value.accountNumber,accountName:C.value.account_name,makePrimary:m.value.makePrimary});l(`created`,e),U()}catch(e){u.toast({title:e.response?.data?.message||`Failed to add settlement account`,variant:`error`})}finally{O.value=!1}}},U=()=>{m.value.accountNumber=``,m.value.makePrimary=!0,y.value=``,C.value=null,D.value=null,l(`close`)};return N(y,()=>{m.value.accountNumber.length===10&&z()}),(c,l)=>s.isOpen?(W(),o(`div`,{key:0,class:`fixed inset-0 bg-white/80 backdrop-blur-sm z-50 overflow-y-auto`,onClick:H(U,[`self`])},[g(`div`,St,[g(`div`,{class:`bg-stone-50 rounded-2xl shadow-2xl shadow-gray-300 border-4 border-white w-full max-w-md`,onClick:l[2]||=H(()=>{},[`stop`])},[l[8]||=g(`div`,{class:`p-6`},[g(`h2`,{class:`text-xl font-semibold text-slate-800`},`Add Settlement Account`),g(`p`,{class:`text-sm text-slate-500 mt-1`},` Payments will automatically settle to this bank account `)],-1),g(`div`,Ct,[g(`div`,wt,[l[3]||=g(`label`,{class:`block text-sm font-medium text-slate-700 mb-1`},`Bank`,-1),w(a(n),{modelValue:y.value,"onUpdate:modelValue":l[0]||=e=>y.value=e,class:`relative`,"onUpdate:open":L},{default:I(()=>[w(a(e),{class:`w-full`},{default:I(()=>[w(a(t),{class:`bg-stone-50 w-full`,placeholder:_.value?`Loading banks...`:`Select a bank...`},null,8,[`placeholder`])]),_:1}),w(a(r),{class:`absolute bg-stone-50 z-50 border border-solid border-slate-300 rounded-md mt-1 px-2 py-3 max-h-[250px] overflow-y-scroll w-full`,style:{"scrollbar-width":`none`}},{default:I(()=>[_.value?(W(),o(`div`,Tt,[w(a(p),{class:`w-4 h-4 animate-spin mx-auto`})])):(W(),o(v,{key:1},[M.value.length===0?(W(),o(`div`,Et,` No banks found `)):Z(``,!0),(W(!0),o(v,null,B(M.value,e=>(W(),S(a(i),{key:e.code,value:e.name,class:`px-4 rounded-full cursor-pointer`},{default:I(()=>[d(b(e.name),1)]),_:2},1032,[`value`]))),128))],64))]),_:1})]),_:1},8,[`modelValue`])]),g(`div`,null,[l[4]||=g(`label`,{class:`block text-sm font-medium text-slate-700 mb-1`},`Account Number`,-1),w(a(te),{"model-value":m.value.accountNumber,"onUpdate:modelValue":R,placeholder:`10-digit account number`,maxlength:`10`,inputmode:`numeric`,class:`rounded-full`},null,8,[`model-value`])]),x.value?(W(),o(`div`,Dt,[w(a(p),{class:`w-4 h-4 animate-spin`}),l[5]||=g(`span`,{class:`text-sm`},`Validating account...`,-1)])):C.value?(W(),o(`div`,Ot,[g(`div`,kt,[w(a(E),{class:`w-4 h-4`}),g(`span`,At,b(C.value.account_name),1)])])):D.value?(W(),o(`div`,jt,[g(`div`,Mt,[w(a(T),{class:`w-4 h-4`}),g(`span`,Nt,b(D.value),1)])])):Z(``,!0),g(`div`,Pt,[w(a(ce),{checked:m.value.makePrimary,"onUpdate:checked":l[1]||=e=>m.value.makePrimary=e,id:`makePrimary`},null,8,[`checked`]),l[6]||=g(`label`,{for:`makePrimary`,class:`text-sm text-slate-700 cursor-pointer`},` Set as primary settlement account `,-1)])]),g(`div`,Ft,[w(a(Q),{variant:`outline`,onClick:U,class:`rounded-full`},{default:I(()=>[...l[7]||=[d(`Cancel`,-1)]]),_:1}),w(a(Q),{onClick:V,disabled:!P.value||O.value,class:`rounded-full`},{default:I(()=>[O.value?(W(),S(a(p),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):Z(``,!0),d(` `+b(O.value?`Adding...`:`Add Account`),1)]),_:1},8,[`disabled`])])])])])):Z(``,!0)}},Lt={class:`absolute w-full flow-vault-page min-h-screen bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-blue-300/80 to-sky-800 from-5% overflow-y-scroll h-screen`,style:{"scrollbar-width":`none`}},Rt={class:`relative container mx-auto py-16 px-4 max-w-4xl`},zt={class:`flex items-center justify-between`},Bt={class:`flex items-center gap-3`},Vt={class:`font-medium text-blue-950`},Ht={class:`text-sm text-blue-950`},Ut={key:0,class:`text-right`},Wt={class:`font-medium text-slate-700`},Gt={key:1,class:`flex items-center justify-center py-16`},Kt={key:2,class:`text-center py-16 px-4`},qt={class:`w-20 h-20 mx-auto mb-6 rounded-full backdrop-blur-lg bg-white/5 border border-white/50 flex items-center justify-center`},Jt={class:`flex items-center justify-between mb-6`},Yt={class:`flex items-center gap-2`},Xt={class:`text-sm text-slate-500`},Zt={class:`flex items-center gap-2`},Qt={class:`text-sm`},$t={class:`bg-white rounded-2xl border shadow-sm p-4`},en={__name:`FlowVault`,setup(e){let t=J(!0),n=J(null),r=J(!1),i=J(null),s=J(null),u=J(!1),m=J(null),h=J(!1),_=J([]),x=f(()=>n.value?n.value.active?`bg-emerald-50 border-emerald-200`:`bg-amber-50 border-amber-200`:`bg-slate-50 border-slate-200`),C=f(()=>n.value?n.value.active?`bg-emerald-100 text-emerald-600`:`bg-amber-100 text-amber-600`:`bg-slate-100 text-slate-500`),T=f(()=>n.value?.active?A:c),O=f(()=>n.value?n.value.active?`Flow Vault Active`:n.value.state===`PENDING_VIRTUAL_ACCOUNT`?`Pending Virtual Account`:`Setup Required`:`Loading...`),k=f(()=>n.value?n.value.active?`Auto-settlement enabled`:n.value.state===`PENDING_VIRTUAL_ACCOUNT`?`Awaiting virtual account creation`:`Add a settlement account to get started`:``),j=async()=>{try{t.value=!0,n.value=await $.getVaultStatus()}catch(e){console.error(`Failed to load vault status:`,e),n.value={state:`NOT_SETUP`,active:!1}}finally{t.value=!1}},N=async()=>{try{r.value=!0,i.value=await $.verifyChain()}catch(e){i.value={valid:!1,message:`Verification failed: `+e.message}}finally{r.value=!1}},R=async()=>{await $.exportJsonl()},z=async()=>{await $.exportCsv()},B=()=>{h.value=!0},H=async()=>{try{_.value=await xt.getSettlementAccounts()}catch(e){console.error(`Failed to load settlement accounts:`,e),_.value=[]}},U=()=>{j(),H()},G=e=>{s.value=e,u.value=!0},q=()=>{u.value=!1,setTimeout(()=>{s.value=null},300)};return P(()=>{j(),H()}),(e,f)=>(W(),o(`div`,Lt,[w(oe),g(`div`,Rt,[f[10]||=g(`div`,{class:`mb-8`},[g(`h1`,{class:`text-2xl font-bold text-white mb-2`},`Flow Vault`),g(`p`,{class:`text-white`},`Payment flow timeline and settlement events`)],-1),n.value?(W(),o(`div`,{key:0,class:V([`mb-6 p-4 rounded-xl border`,x.value])},[g(`div`,zt,[g(`div`,Bt,[g(`div`,{class:V([`w-10 h-10 rounded-full flex items-center justify-center`,C.value])},[(W(),S(K(T.value),{class:`w-5 h-5`}))],2),g(`div`,null,[g(`h3`,Vt,b(O.value),1),g(`p`,Ht,b(k.value),1)])]),n.value.settlementConfigured?(W(),o(`div`,Ut,[f[2]||=g(`div`,{class:`text-xs text-slate-400`},`Settlement destination`,-1),g(`div`,Wt,b(n.value.settlementBank)+` `+b(n.value.settlementAccountMasked),1)])):Z(``,!0)])],2)):Z(``,!0),t.value?(W(),o(`div`,Gt,[w(a(p),{class:`w-8 h-8 animate-spin text-white`})])):n.value?.state===`NEEDS_SETTLEMENT_ACCOUNT`||n.value?.state===`NOT_SETUP`?(W(),o(`div`,Kt,[g(`div`,qt,[w(a(c),{class:`w-10 h-10 text-stone-100 animate-pulse`,style:{"animation-duration":`7s !important`}})]),f[4]||=g(`h2`,{class:`text-xl font-semibold text-white mb-3`},` Add a settlement account to activate your Flow Vault `,-1),f[5]||=g(`p`,{class:`text-white max-w-md mx-auto mb-6`},` Incoming payments will be routed and settled automatically to your bank account. `,-1),w(a(Q),{onClick:B,class:`rounded-full px-6`},{default:I(()=>[w(a(ee),{class:`w-4 h-4 mr-2`}),f[3]||=d(` Add Settlement Account `,-1)]),_:1})])):n.value?.active?(W(),o(v,{key:3},[g(`div`,Jt,[g(`div`,Yt,[g(`span`,Xt,b(n.value.blockCount)+` events recorded `,1)]),g(`div`,Zt,[w(a(Q),{variant:`outline`,size:`sm`,onClick:B,class:`rounded-full`},{default:I(()=>[w(a(F),{class:`w-4 h-4 mr-1`}),f[6]||=d(` Add Account `,-1)]),_:1}),w(a(Q),{variant:`outline`,size:`sm`,onClick:N,disabled:r.value,class:`rounded-full`},{default:I(()=>[w(a(D),{class:`w-4 h-4 mr-1`}),d(` `+b(r.value?`Verifying...`:`Verify Chain`),1)]),_:1},8,[`disabled`]),w(a(ne),null,{default:I(()=>[w(a(ae),{asChild:``},{default:I(()=>[w(a(Q),{variant:`outline`,size:`sm`,class:`rounded-full`},{default:I(()=>[w(a(l),{class:`w-4 h-4 mr-1`}),f[7]||=d(` Export `,-1)]),_:1})]),_:1}),w(a(ie),null,{default:I(()=>[w(a(re),{onClick:R},{default:I(()=>[w(a(L),{class:`w-4 h-4 mr-2`}),f[8]||=d(` Export JSONL `,-1)]),_:1}),w(a(re),{onClick:z},{default:I(()=>[w(a(M),{class:`w-4 h-4 mr-2`}),f[9]||=d(` Export CSV `,-1)]),_:1})]),_:1})]),_:1})])]),i.value?(W(),o(`div`,{key:0,class:V([`mb-4 p-3 rounded-lg flex items-center gap-2`,i.value.valid?`bg-emerald-50 text-emerald-700`:`bg-orange-50 text-orange-700`])},[(W(),S(K(i.value.valid?a(E):a(y)),{class:`w-5 h-5`})),g(`span`,Qt,b(i.value.message),1),g(`button`,{onClick:f[0]||=e=>i.value=null,class:`ml-auto`},[w(a(X),{class:`w-4 h-4`})])],2)):Z(``,!0),g(`div`,$t,[w(Ue,{ref_key:`timelineRef`,ref:m,onEventClick:G},null,512)])],64)):Z(``,!0)]),w(bt,{event:s.value,"is-open":u.value,onClose:q},null,8,[`event`,`is-open`]),w(It,{"is-open":h.value,onClose:f[1]||=e=>h.value=!1,onCreated:U},null,8,[`is-open`])]))}};export{en as default};