import{i as e,o as t,s as n}from"./utils-ZiIksPq3.js";import{t as r}from"./useDirection-in50hSnm.js";import{t as i}from"./useId-xsRq2HUO.js";import{a}from"./PopperContent-Dr_YT0U5.js";import{t as o}from"./VisuallyHiddenInput-m3iLWOCv.js";import{$t as s,Bt as c,D as l,Dt as u,Ht as d,Mt as f,Nt as p,O as m,Ot as h,P as g,Tt as _,U as v,Ut as y,V as ee,Wt as b,Y as x,bt as S,fn as C,gn as te,in as w,nn as T,on as E,qt as D,rt as O,tt as k,v as A,vn as j,yt as M,zt as N}from"./index-BNQA11Dp.js";function ne(e,t,r){let i=e.findIndex(e=>n(e,t)),a=e.findIndex(e=>n(e,r));if(i===-1||a===-1)return[];let[o,s]=[i,a].sort((e,t)=>e-t);return e.slice(o,s+1)}function P(e){let t=_(()=>j(e)),n=_(()=>new Intl.Collator(`en`,{usage:`search`,...t.value}));return{startsWith:(e,t)=>t.length===0?!0:(e=e.normalize(`NFC`),t=t.normalize(`NFC`),n.value.compare(e.slice(0,t.length),t)===0),endsWith:(e,t)=>t.length===0?!0:(e=e.normalize(`NFC`),t=t.normalize(`NFC`),n.value.compare(e.slice(-t.length),t)===0),contains:(e,t)=>{if(t.length===0)return!0;e=e.normalize(`NFC`),t=t.normalize(`NFC`);let r=0,i=t.length;for(;r+i<=e.length;r++){let a=e.slice(r,r+i);if(n.value.compare(t,a)===0)return!0}return!1}}}function F(){return{ALT:`Alt`,ARROW_DOWN:`ArrowDown`,ARROW_LEFT:`ArrowLeft`,ARROW_RIGHT:`ArrowRight`,ARROW_UP:`ArrowUp`,BACKSPACE:`Backspace`,CAPS_LOCK:`CapsLock`,CONTROL:`Control`,DELETE:`Delete`,END:`End`,ENTER:`Enter`,ESCAPE:`Escape`,F1:`F1`,F10:`F10`,F11:`F11`,F12:`F12`,F2:`F2`,F3:`F3`,F4:`F4`,F5:`F5`,F6:`F6`,F7:`F7`,F8:`F8`,F9:`F9`,HOME:`Home`,META:`Meta`,PAGE_DOWN:`PageDown`,PAGE_UP:`PageUp`,SHIFT:`Shift`,SPACE:` `,TAB:`Tab`,CTRL:`Control`,ASTERISK:`*`,SPACE_CODE:`Space`}}function I(e,t,n){return e===void 0?!1:Array.isArray(e)?e.some(e=>L(e,t,n)):L(e,t,n)}function L(e,t,r){return e===void 0||t===void 0?!1:typeof e==`string`?e===t:typeof r==`function`?r(e,t):typeof r==`string`?e?.[r]===t?.[r]:n(e,t)}var[R,re]=O(`ListboxRoot`),z=p({__name:`ListboxRoot`,props:{modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},multiple:{type:Boolean,required:!1},orientation:{type:String,required:!1,default:`vertical`},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},selectionBehavior:{type:String,required:!1,default:`toggle`},highlightOnHover:{type:Boolean,required:!1},by:{type:[String,Function],required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:[`update:modelValue`,`highlight`,`entryFocus`,`leave`],setup(n,{expose:i,emit:d}){let f=n,p=d,{multiple:g,highlightOnHover:_,orientation:y,disabled:x,selectionBehavior:S,dir:T}=te(f),{getItems:E}=A({isProvider:!0}),{handleTypeaheadSearch:O}=a(),{primitiveElement:k,currentElement:M}=l(),N=F(),P=r(T),I=t(M),R=C(),z=C(!1),B=C(!0),V=ee(f,`modelValue`,p,{defaultValue:f.defaultValue??(g.value?[]:void 0),passive:f.modelValue===void 0,deep:!0});function H(e){if(z.value=!0,f.multiple){let t=Array.isArray(V.value)?[...V.value]:[],n=t.findIndex(t=>L(t,e,f.by));f.selectionBehavior===`toggle`?(n===-1?t.push(e):t.splice(n,1),V.value=t):(V.value=[e],R.value=e)}else f.selectionBehavior===`toggle`&&L(V.value,e,f.by)?V.value=void 0:V.value=e;setTimeout(()=>{z.value=!1},1)}let U=C(null),W=C(null),G=C(!1),K=C(!1),q=v(),J=v(),Y=v();function X(){return E().map(e=>e.ref).filter(e=>e.dataset.disabled!==``)}function Z(e,t=!0){if(!e)return;U.value=e,B.value&&U.value.focus(),t&&U.value.scrollIntoView({block:`nearest`});let n=E().find(t=>t.ref===e);p(`highlight`,n)}function ie(e){if(G.value)Y.trigger(e);else{let t=E().find(t=>L(t.value,e,f.by));t&&(U.value=t.ref,Z(t.ref))}}function ae(e){U.value&&U.value.isConnected&&(e.preventDefault(),e.stopPropagation(),K.value||U.value.click())}function oe(e){if(B.value){if(z.value=!0,G.value)J.trigger(e);else{let t=e.altKey||e.ctrlKey||e.metaKey;if(t&&e.key===`a`&&g.value){let t=E();V.value=[...t.map(e=>e.value)],e.preventDefault(),Z(t[t.length-1].ref)}else if(!t){let t=O(e.key,E());t&&Z(t)}}setTimeout(()=>{z.value=!1},1)}}function se(){K.value=!0}function ce(){c(()=>{K.value=!1})}function Q(){c(()=>{let e=new KeyboardEvent(`keydown`,{key:`PageUp`});ue(e)})}function $(e){let t=U.value;t?.isConnected&&(W.value=t),U.value=null,p(`leave`,e)}function le(e){let t=new CustomEvent(`listbox.entryFocus`,{bubbles:!1,cancelable:!0});if(e.currentTarget?.dispatchEvent(t),p(`entryFocus`,t),!t.defaultPrevented)if(W.value)Z(W.value);else{let e=X()?.[0];Z(e)}}function ue(t){let n=e(t,y.value,P.value);if(!n)return;let r=X();if(U.value){if(n===`last`)r.reverse();else if(n===`prev`||n===`next`){n===`prev`&&r.reverse();let e=r.indexOf(U.value);r=r.slice(e+1)}de(t,r[0])}if(r.length){let e=!U.value&&n===`prev`?r.length-1:0;Z(r[e])}if(G.value)return J.trigger(t)}function de(e,t){if(!(G.value||f.selectionBehavior!==`replace`||!g.value||!Array.isArray(V.value))&&!((e.altKey||e.ctrlKey||e.metaKey)&&!e.shiftKey)&&e.shiftKey){let n=E().filter(e=>e.ref.dataset.disabled!==``),r=n.find(e=>e.ref===t)?.value;if(e.key===N.END?r=n[n.length-1].value:e.key===N.HOME&&(r=n[0].value),!r||!R.value)return;V.value=ne(n.map(e=>e.value),R.value,r)}}async function fe(e){if(await c(),G.value)q.trigger(e);else{let e=X(),t=e.find(e=>e.dataset.state===`checked`);t?Z(t):e.length&&Z(e[0])}}return s(V,()=>{z.value||c(()=>{fe()})},{immediate:!0,deep:!0}),i({highlightedElement:U,highlightItem:ie,highlightFirstItem:Q,highlightSelected:fe,getItems:E}),re({modelValue:V,onValueChange:H,multiple:g,orientation:y,dir:P,disabled:x,highlightOnHover:_,highlightedElement:U,isVirtual:G,virtualFocusHook:q,virtualKeydownHook:J,virtualHighlightHook:Y,by:f.by,firstValue:R,selectionBehavior:S,focusable:B,onLeave:$,onEnter:le,changeHighlight:Z,onKeydownEnter:ae,onKeydownNavigation:ue,onKeydownTypeAhead:oe,onCompositionStart:se,onCompositionEnd:ce,highlightFirstItem:Q}),(e,t)=>(b(),u(j(m),{ref_key:`primitiveElement`,ref:k,as:e.as,"as-child":e.asChild,dir:j(P),"data-disabled":j(x)?``:void 0,onPointerleave:$,onFocusout:t[0]||=async e=>{let t=e.relatedTarget||e.target;await c(),U.value&&j(M)&&!j(M).contains(t)&&$(e)}},{default:w(()=>[D(e.$slots,`default`,{modelValue:j(V)}),j(I)&&e.name?(b(),u(j(o),{key:0,name:e.name,value:j(V),disabled:j(x),required:e.required},null,8,[`name`,`value`,`disabled`,`required`])):h(`v-if`,!0)]),_:3},8,[`as`,`as-child`,`dir`,`data-disabled`]))}}),B=p({__name:`ListboxContent`,props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(e){let{CollectionSlot:t}=A(),n=R(),r=x(!1,10);return(e,i)=>(b(),u(j(t),null,{default:w(()=>[f(j(m),{role:`listbox`,as:e.as,"as-child":e.asChild,tabindex:j(n).focusable.value?j(n).highlightedElement.value?`-1`:`0`:`-1`,"aria-orientation":j(n).orientation.value,"aria-multiselectable":!!j(n).multiple.value,"data-orientation":j(n).orientation.value,onMousedown:i[0]||=S(e=>r.value=!0,[`left`]),onFocus:i[1]||=e=>{j(r)||j(n).onEnter(e)},onKeydown:[i[2]||=M(e=>{j(n).orientation.value===`vertical`&&(e.key===`ArrowLeft`||e.key===`ArrowRight`)||j(n).orientation.value===`horizontal`&&(e.key===`ArrowUp`||e.key===`ArrowDown`)||(e.preventDefault(),j(n).focusable.value&&j(n).onKeydownNavigation(e))},[`down`,`up`,`left`,`right`,`home`,`end`]),M(j(n).onKeydownEnter,[`enter`]),j(n).onKeydownTypeAhead]},{default:w(()=>[D(e.$slots,`default`)]),_:3},8,[`as`,`as-child`,`tabindex`,`aria-orientation`,`aria-multiselectable`,`data-orientation`,`onKeydown`])]),_:3}))}}),V=p({__name:`ListboxFilter`,props:{modelValue:{type:String,required:!1},autoFocus:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:`input`}},emits:[`update:modelValue`],setup(e,{emit:t}){let n=e,r=ee(n,`modelValue`,t,{defaultValue:``,passive:n.modelValue===void 0}),i=R(),{primitiveElement:a,currentElement:o}=l(),s=_(()=>n.disabled||i.disabled.value||!1),c=C();return T(()=>c.value=i.highlightedElement.value?.id),d(()=>{i.focusable.value=!1,setTimeout(()=>{n.autoFocus&&o.value?.focus()},1)}),y(()=>{i.focusable.value=!0}),(e,t)=>(b(),u(j(m),{ref_key:`primitiveElement`,ref:a,as:e.as,"as-child":e.asChild,value:j(r),disabled:s.value?``:void 0,"data-disabled":s.value?``:void 0,"aria-disabled":s.value??void 0,"aria-activedescendant":c.value,type:`text`,onKeydown:[M(S(j(i).onKeydownNavigation,[`prevent`]),[`down`,`up`,`home`,`end`]),M(j(i).onKeydownEnter,[`enter`])],onInput:t[0]||=e=>{r.value=e.target.value,j(i).highlightFirstItem()},onCompositionstart:j(i).onCompositionStart,onCompositionend:j(i).onCompositionEnd},{default:w(()=>[D(e.$slots,`default`,{modelValue:j(r)})]),_:3},8,[`as`,`as-child`,`value`,`disabled`,`data-disabled`,`aria-disabled`,`aria-activedescendant`,`onKeydown`,`onCompositionstart`,`onCompositionend`]))}}),[H,U]=O(`ListboxGroup`),W=p({__name:`ListboxGroup`,props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(e){let t=e,n=i(void 0,`reka-listbox-group`);return U({id:n}),(e,r)=>(b(),u(j(m),N({role:`group`},t,{"aria-labelledby":j(n)}),{default:w(()=>[D(e.$slots,`default`)]),_:3},16,[`aria-labelledby`]))}}),G=`listbox.select`,[K,q]=O(`ListboxItem`),J=p({__name:`ListboxItem`,props:{value:{type:null,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:`div`}},emits:[`select`],setup(e,{emit:t}){let n=e,r=t,a=i(void 0,`reka-listbox-item`),{CollectionItem:o}=A(),{forwardRef:s,currentElement:c}=g(),l=R(),d=_(()=>c.value===l.highlightedElement.value),p=_(()=>I(l.modelValue.value,n.value,l.by)),h=_(()=>l.disabled.value||n.disabled);async function v(e){r(`select`,e),!e?.defaultPrevented&&!h.value&&e&&(l.onValueChange(n.value),l.changeHighlight(c.value))}function y(e){let t={originalEvent:e,value:n.value};k(G,v,t)}return q({isSelected:p}),(e,t)=>(b(),u(j(o),{value:e.value},{default:w(()=>[E([d.value,p.value],()=>f(j(m),N({id:j(a)},e.$attrs,{ref:j(s),role:`option`,tabindex:j(l).focusable.value?d.value?`0`:`-1`:-1,"aria-selected":p.value,as:e.as,"as-child":e.asChild,disabled:h.value?``:void 0,"data-disabled":h.value?``:void 0,"data-highlighted":d.value?``:void 0,"data-state":p.value?`checked`:`unchecked`,onClick:y,onKeydown:M(S(y,[`prevent`]),[`space`]),onPointermove:t[0]||=()=>{j(l).highlightedElement.value!==j(c)&&j(l).highlightOnHover.value&&!j(l).focusable.value&&j(l).changeHighlight(j(c),!1)}}),{default:w(()=>[D(e.$slots,`default`)]),_:3},16,[`id`,`tabindex`,`aria-selected`,`as`,`as-child`,`disabled`,`data-disabled`,`data-highlighted`,`data-state`,`onKeydown`]),t,1)]),_:3},8,[`value`]))}});export{B as a,F as c,V as i,P as l,W as n,z as o,H as r,R as s,J as t};