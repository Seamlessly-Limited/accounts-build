import"./useFormControl-BWOmmYiS.js";import"./ListboxItem-i8wcDEmS.js";import"./nullish-CfjOSA4G.js";import"./CheckboxIndicator-Blzh6aVh.js";import"./useArrowNavigation-siWGBYoD.js";import"./ConfigProvider-BwNXqMge.js";import"./useHideOthers-C416Re6d.js";import"./useDirection-DYJPYRsI.js";import"./PopperAnchor-BHV4Kv-d.js";import"./useId-BEfc-0Pq.js";import"./useKbd-BvGB3m10.js";import"./PopperContent-DYn2KUeQ.js";import"./useTypeahead-b61J-STi.js";import"./DialogPortal-913ieDuk.js";import"./Teleport-DrGXNRYb.js";import"./utils-BEsFB3CI.js";import"./DialogTitle-BUR1zqy5.js";import"./utils-DlRpuNf9.js";import"./RovingFocusGroup-DqYe3043.js";import"./RovingFocusItem-DGQRTR_g.js";import"./VisuallyHiddenInput-DK27W3yR.js";import{t as e}from"./ComboboxAnchor-DT4FdUCk.js";import{i as t,n,r,s as i,t as a}from"./ComboboxItem-byr1zsK6.js";import"./DropdownMenuTrigger-BcawehIV.js";import{Bi as o,Bn as s,Dn as c,F as l,Fa as u,Fi as d,Gi as f,Hi as p,Jt as m,Ki as h,Kn as g,Li as _,Ln as v,N as y,Oa as b,Oi as x,Pa as S,Q as C,Ra as w,S as T,Ui as E,Un as D,Vi as O,Wi as k,Wn as A,Yn as j,Zn as M,a as ee,aa as N,b as P,ba as F,ca as I,ct as L,da as R,ha as z,i as B,ia as V,ki as H,lt as te,o as U,oa as W,or as G,pn as ne,qi as K,vr as q,wr as J,xr as Y,y as re,yn as ie,yr as ae,zt as X}from"./index-CTHZVx0Q.js";import{n as oe,t as se}from"./DialogContent-DBDLd1Cs.js";import{n as ce,r as le,t as ue}from"./DialogTitle-DU64UNVg.js";import{t as de}from"./DialogFooter-CdocHGcF.js";import{t as Z}from"./button-DTHLpYkO.js";import{t as fe}from"./Input-lhwdatZg.js";import{i as pe,n as Q,r as me,t as he}from"./DropdownMenuTrigger-DbkkbPD4.js";import{t as ge}from"./BackgroundAnimation-B6s-b0kX.js";import{t as _e}from"./BankAccountService-DLs_hixq.js";import{t as ve}from"./Checkbox-CZRPDl7O.js";var ye={class:`flex flex-col items-center`},be={class:`flex-1 min-w-0`},xe={class:`flex items-center justify-between gap-2 mb-1`},Se={class:`font-medium text-slate-800`},Ce={class:`text-xs text-slate-400`},we={class:`flex items-center gap-2 mt-2 text-sm text-slate-500`},Te={key:0},Ee={key:1,class:`text-xs text-slate-400 font-mono`},De={__name:`FlowEventCard`,props:{event:{type:Object,required:!0},isLast:{type:Boolean,default:!1}},emits:[`click`],setup(e){let t=e,n=o(()=>t.event.eventType===`INCOMING_PAYMENT`),r=o(()=>t.event.eventType===`SETTLEMENT_COMPLETED`),i=o(()=>t.event.eventType===`SETTLEMENT_FAILED`),a=o(()=>t.event.eventType===`SETTLEMENT_INITIATED`),c=o(()=>n.value?J:r.value?D:i.value?s:a.value?v:q),l=o(()=>{switch(t.event.eventType){case`INCOMING_PAYMENT`:return`Payment received`;case`SETTLEMENT_INITIATED`:return`Settlement initiated`;case`SETTLEMENT_COMPLETED`:return`Settled to bank`;case`SETTLEMENT_FAILED`:return`Settlement failed`;default:return t.event.eventType}}),d=o(()=>n.value?`animate-slide-in-left`:`animate-slide-in-right`),f=o(()=>n.value?`bg-emerald-100 text-emerald-600`:r.value?`bg-blue-100 text-blue-600`:i.value?`bg-orange-100 text-orange-600`:(a.value,`bg-slate-100 text-slate-600`)),m=o(()=>n.value?`from-emerald-200 to-transparent`:r.value?`from-blue-200 to-transparent`:`from-slate-200 to-transparent`),h=o(()=>n.value?`text-emerald-600`:r.value?`text-blue-600`:i.value?`text-orange-600`:`text-slate-700`),g=o(()=>{let e=t.event.payload?.amount,n=t.event.payload?.currency||`NGN`;return e?new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:n,minimumFractionDigits:0,maximumFractionDigits:2}).format(e):`—`}),_=o(()=>{if(!t.event.timestamp)return``;let e=new Date(t.event.timestamp),n=new Date-e,r=Math.floor(n/6e4),i=Math.floor(n/36e5),a=Math.floor(n/864e5);return r<1?`Just now`:r<60?`${r}m ago`:i<24?`${i}h ago`:a<7?`${a}d ago`:e.toLocaleDateString(`en-NG`,{day:`numeric`,month:`short`})}),y=e=>e?e.length<=12?e:e.substring(0,6)+`...`+e.substring(e.length-4):``;return(t,n)=>(W(),k(`div`,{class:u([`flow-event-card group relative flex items-start gap-4 p-4 rounded-xl transition-all duration-300 hover:bg-slate-50/50 cursor-pointer`,d.value]),onClick:n[0]||=n=>t.$emit(`click`,e.event)},[O(`div`,ye,[O(`div`,{class:u([`w-10 h-10 rounded-full flex items-center justify-center shrink-0 transition-all duration-300`,f.value])},[(W(),p(R(c.value),{class:`w-5 h-5`}))],2),e.isLast?E(``,!0):(W(),k(`div`,{key:0,class:u([`w-0.5 h-full min-h-[40px] mt-2 rounded-full bg-gradient-to-b`,m.value])},null,2))]),O(`div`,be,[O(`div`,xe,[O(`span`,Se,w(l.value),1),O(`span`,Ce,w(_.value),1)]),O(`div`,{class:u([`text-lg font-semibold`,h.value])},w(g.value),3),O(`div`,we,[e.event.payload?.payerName||e.event.payload?.bankName?(W(),k(`span`,Te,w(e.event.payload?.payerName||e.event.payload?.bankName),1)):E(``,!0),e.event.eventRef?(W(),k(`span`,Ee,w(y(e.event.eventRef)),1)):E(``,!0)])]),K(S(j),{class:`w-4 h-4 text-slate-300 group-hover:text-slate-500 transition-colors shrink-0 mt-1`})],2))}},Oe=B(De,[[`__scopeId`,`data-v-245f882a`]]),ke={class:`flex items-center justify-between mb-3`},Ae={class:`flex items-center gap-2`},je={class:`text-xs text-slate-400`},Me={key:0,class:`flex items-center justify-between`},Ne={class:`flex items-center gap-2`},Pe={key:1,class:`flex items-center justify-between`},Fe={class:`flex items-center gap-2`},Ie={class:`text-lg font-semibold text-emerald-600`},Le={class:`mt-1 text-xs text-slate-400 font-mono`},Re={key:1,class:`flex items-center gap-2 pl-4 my-2`},ze=[`onClick`],Be={class:`flex items-center justify-between`},Ve={class:`flex items-center gap-2`},He={class:`text-xs text-slate-600`},Ue={__name:`FlowEventGroup`,props:{group:{type:Object,required:!0}},emits:[`event-click`],setup(e){let t=e,n=o(()=>t.group.payment?.eventType===`VAULT_ACTIVATED`?`ACTIVATED`:t.group.status||`PENDING`),r=o(()=>{switch(n.value){case`COMPLETED`:return`Settled`;case`FAILED`:return`Failed`;case`INITIATED`:return`Settling...`;case`ACTIVATED`:return`Active`;default:return`Pending`}}),i=o(()=>{switch(n.value){case`COMPLETED`:return D;case`FAILED`:return s;case`INITIATED`:return X;case`ACTIVATED`:return C;default:return v}}),a=o(()=>{switch(n.value){case`COMPLETED`:return`bg-blue-50/50 border-blue-200`;case`FAILED`:return`bg-orange-50/50 border-orange-200`;case`ACTIVATED`:return`bg-slate-50/50 border-slate-200`;default:return`bg-slate-50/50 border-slate-200`}}),c=o(()=>{switch(n.value){case`COMPLETED`:return`bg-blue-100 text-blue-600`;case`FAILED`:return`bg-orange-100 text-orange-600`;case`ACTIVATED`:return`bg-blue-100 text-blue-600`;default:return`bg-slate-100 text-slate-500`}}),l=o(()=>{switch(n.value){case`COMPLETED`:return`text-blue-600`;case`FAILED`:return`text-orange-600`;case`ACTIVATED`:return`text-blue-600`;default:return`text-slate-500`}}),d=o(()=>{let e=t.group.payment?.timestamp;return e?new Date(e).toLocaleDateString(`en-NG`,{day:`numeric`,month:`short`,hour:`2-digit`,minute:`2-digit`}):``}),f=o(()=>{let e=t.group.payment;return e?m(e.payload?.amount,e.payload?.currency):`—`}),m=(e,t=`NGN`)=>e?new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:t,minimumFractionDigits:0,maximumFractionDigits:2}).format(e):`—`,h=e=>e?e.length<=12?e:e.substring(0,6)+`...`+e.substring(e.length-4):``,g=e=>e.eventType===`SETTLEMENT_COMPLETED`?D:e.eventType===`SETTLEMENT_FAILED`?s:v,y=e=>e.eventType===`SETTLEMENT_COMPLETED`?`text-blue-500`:e.eventType===`SETTLEMENT_FAILED`?`text-orange-500`:`text-slate-400`,b=e=>e.eventType===`SETTLEMENT_COMPLETED`?`Settled to bank`:e.eventType===`SETTLEMENT_FAILED`?`Settlement failed`:`Settling...`,x=e=>e.eventType===`SETTLEMENT_COMPLETED`?`border-blue-200 bg-blue-50/50`:e.eventType===`SETTLEMENT_FAILED`?`border-orange-200 bg-orange-50/50`:`border-slate-200`,T=e=>e.eventType===`SETTLEMENT_COMPLETED`?`text-blue-600`:e.eventType===`SETTLEMENT_FAILED`?`text-orange-600`:`text-slate-600`;return(t,n)=>(W(),k(`div`,{class:u([`flow-event-group p-4 rounded-xl border`,a.value])},[O(`div`,ke,[O(`div`,Ae,[O(`div`,{class:u([`w-8 h-8 rounded-full flex items-center justify-center`,c.value])},[(W(),p(R(i.value),{class:`w-4 h-4`}))],2),O(`span`,{class:u([`text-xs font-medium uppercase tracking-wide`,l.value])},w(r.value),3)]),O(`span`,je,w(d.value),1)]),e.group.payment?(W(),k(`div`,{key:0,class:`p-3 rounded-lg bg-white border cursor-pointer hover:bg-slate-50 transition-colors`,onClick:n[0]||=n=>t.$emit(`event-click`,e.group.payment)},[e.group.payment.eventType===`VAULT_ACTIVATED`?(W(),k(`div`,Me,[O(`div`,Ne,[K(S(C),{class:`w-4 h-4 text-blue-500`}),n[1]||=O(`span`,{class:`text-sm font-medium text-slate-700`},`Vault Activated`,-1)]),n[2]||=O(`span`,{class:`text-xs text-slate-500`},`System Event`,-1)])):(W(),k(`div`,Pe,[O(`div`,Fe,[K(S(J),{class:`w-4 h-4 text-emerald-500`}),n[3]||=O(`span`,{class:`text-sm font-medium text-slate-700`},`Payment received`,-1)]),O(`span`,Ie,w(f.value),1)])),O(`div`,Le,w(h(e.group.payment?.eventRef)),1)])):E(``,!0),e.group.settlements?.length?(W(),k(`div`,Re,[n[4]||=O(`div`,{class:`w-0.5 h-4 bg-slate-200`},null,-1),K(S(ae),{class:`w-3 h-3 text-slate-400`})])):E(``,!0),(W(!0),k(_,null,I(e.group.settlements,e=>(W(),k(`div`,{key:e.hash,class:u([`ml-6 p-2 rounded-lg border cursor-pointer hover:bg-slate-50 transition-colors`,x(e)]),onClick:n=>t.$emit(`event-click`,e)},[O(`div`,Be,[O(`div`,Ve,[(W(),p(R(g(e)),{class:u([`w-3 h-3`,y(e)])},null,8,[`class`])),O(`span`,He,w(b(e)),1)]),O(`span`,{class:u([`text-sm font-medium`,T(e)])},w(m(e.payload?.amount,e.payload?.currency)),3)])],10,ze))),128))],2))}},$={async getVaultStatus(){let e=await U.get(`/org/flow-vault`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e},async getTimeline(e=0,t=20){let n=await U.get(`/org/flow-vault/timeline`,{query:{page:e,size:t},authorizeRequest:!0,organisationAware:!0});return n?.data||n},async verifyChain(){let e=await U.get(`/org/flow-vault/verify`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e},async exportJsonl(){let e=await U.get(`/org/flow-vault/export/jsonl`,{responseType:`blob`,authorizeRequest:!0,organisationAware:!0}),t=window.URL.createObjectURL(new Blob([e])),n=document.createElement(`a`);n.href=t,n.setAttribute(`download`,`flowvault-${new Date().toISOString().split(`T`)[0]}.jsonl`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t)},async exportCsv(){let e=await U.get(`/org/flow-vault/export/csv`,{responseType:`blob`,authorizeRequest:!0,organisationAware:!0}),t=window.URL.createObjectURL(new Blob([e])),n=document.createElement(`a`);n.href=t,n.setAttribute(`download`,`flowvault-${new Date().toISOString().split(`T`)[0]}.csv`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t)},async getGroupedTimeline(){let e=await U.get(`/org/flow-vault/timeline/grouped`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e},async getVaultStats(){let e=await U.get(`/org/flow-vault/stats`,{authorizeRequest:!0,organisationAware:!0});return e?.data||e}},We={class:`flow-timeline`},Ge={class:`flex items-center justify-between mb-4`},Ke={class:`text-sm text-slate-500`},qe={key:0,class:`flex items-center justify-center py-12`},Je={key:1,class:`text-center py-12`},Ye={class:`w-16 h-16 mx-auto mb-4 rounded-full bg-slate-100 flex items-center justify-center`},Xe={key:2,class:`space-y-4`},Ze={key:3,class:`space-y-0`},Qe={__name:`FlowTimeline`,props:{pageSize:{type:Number,default:20}},emits:[`event-click`],setup(e,{expose:t,emit:n}){let r=e,i=n,a=b([]),s=b([]),c=b(!0),l=b(!1),d=b(!1),f=b(0),g=b(null),v=b(!0),y=null,x=o(()=>v.value?s.value.length===0:a.value.length===0),C=async()=>{try{c.value=!0;let e=await $.getTimeline(0,r.pageSize);a.value=e.content||[],d.value=!e.last,f.value=0}catch(e){console.error(`Failed to load timeline:`,e)}finally{c.value=!1}},T=async()=>{try{c.value=!0,s.value=await $.getGroupedTimeline()}catch(e){console.error(`Failed to load grouped timeline:`,e)}finally{c.value=!1}},D=async()=>{if(!(l.value||!d.value||v.value))try{l.value=!0,f.value++;let e=await $.getTimeline(f.value,r.pageSize);a.value.push(...e.content||[]),d.value=!e.last}catch(e){console.error(`Failed to load more events:`,e),f.value--}finally{l.value=!1}},A=()=>{v.value=!v.value,v.value?T():C()},j=e=>{i(`event-click`,e)},ee=()=>{g.value&&(y=new IntersectionObserver(e=>{e[0].isIntersecting&&d.value&&!l.value&&!v.value&&D()},{threshold:.1}),y.observe(g.value))};return V(()=>{T(),setTimeout(ee,500)}),N(()=>{y&&y.disconnect()}),t({refresh:()=>v.value?T():C()}),(e,t)=>(W(),k(`div`,We,[O(`div`,Ge,[O(`span`,Ke,w(v.value?`Grouped by payment`:`All events`),1),O(`button`,{onClick:A,class:u([`text-xs px-3 py-1 rounded-full border transition-colors`,v.value?`bg-blue-50 border-blue-200 text-blue-600`:`bg-slate-50 border-slate-200 text-slate-600`])},[K(S(m),{class:`w-3 h-3 inline mr-1`}),h(` `+w(v.value?`Show flat`:`Group by payment`),1)],2)]),c.value?(W(),k(`div`,qe,[K(S(X),{class:`w-6 h-6 animate-spin text-slate-400`})])):x.value?(W(),k(`div`,Je,[O(`div`,Ye,[K(S(Y),{class:`w-8 h-8 text-slate-400`})]),t[0]||=O(`h3`,{class:`text-lg font-medium text-slate-700 mb-2`},`No events yet`,-1),t[1]||=O(`p`,{class:`text-sm text-slate-500 max-w-sm mx-auto`},` Incoming payments and settlements will appear here as they flow through your vault. `,-1)])):v.value?(W(),k(`div`,Xe,[K(H,{name:`timeline`},{default:F(()=>[(W(!0),k(_,null,I(s.value,e=>(W(),p(Ue,{key:e.payment?.hash||e.settlements?.[0]?.hash,group:e,onEventClick:j},null,8,[`group`]))),128))]),_:1})])):(W(),k(`div`,Ze,[K(H,{name:`timeline`},{default:F(()=>[(W(!0),k(_,null,I(a.value,(e,t)=>(W(),p(Oe,{key:e.hash||e.index,event:e,"is-last":t===a.value.length-1,onClick:t=>j(e)},null,8,[`event`,`is-last`,`onClick`]))),128))]),_:1}),d.value?(W(),k(`div`,{key:0,ref_key:`loadMoreTrigger`,ref:g,class:`py-4 flex items-center justify-center`},[l.value?(W(),p(S(X),{key:1,class:`w-5 h-5 animate-spin text-slate-400`})):(W(),k(`button`,{key:0,onClick:D,class:`text-sm text-slate-500 hover:text-slate-700 flex items-center gap-2`},[K(S(M),{class:`w-4 h-4`}),t[2]||=h(` Load more `,-1)]))],512)):E(``,!0)]))]))}},$e=B(Qe,[[`__scopeId`,`data-v-dea6f07d`]]),et={key:0,class:`flow-event-drawer fixed inset-y-0 right-0 w-full max-w-md bg-white shadow-xl z-50 flex flex-col`},tt={class:`flex items-center justify-between p-4 border-b`},nt={class:`text-sm text-slate-500`},rt={key:0,class:`flex-1 overflow-y-auto p-4 space-y-6`},it={class:`text-2xl font-bold`},at={class:`space-y-4`},ot={class:`text-slate-700`},st={key:0},ct={class:`text-slate-700 font-mono text-sm`},lt={key:1},ut={class:`text-slate-700`},dt={key:2},ft={class:`text-slate-700`},pt={key:3},mt={class:`text-slate-700`},ht={key:4},gt={class:`text-slate-700 font-mono`},_t={key:5},vt={class:`text-orange-600`},yt={class:`space-y-3`},bt={class:`text-sm font-medium text-slate-700 flex items-center gap-2`},xt={class:`text-slate-700 font-mono`},St={class:`text-slate-700 font-mono text-xs break-all bg-slate-50 p-2 rounded`},Ct={class:`text-slate-700 font-mono text-xs break-all bg-slate-50 p-2 rounded`},wt={key:0,class:`space-y-3`},Tt={class:`text-slate-700 font-mono text-sm`},Et={class:`p-4 border-t bg-slate-50`},Dt={class:`flex items-center justify-between text-xs text-slate-500`},Ot={class:`flex items-center gap-1 text-emerald-500`},kt={__name:`FlowEventDrawer`,props:{event:{type:Object,default:null},isOpen:{type:Boolean,default:!1}},emits:[`close`],setup(e,{emit:t}){let n=e,r=t,i=()=>r(`close`),a=o(()=>n.event?.eventType===`INCOMING_PAYMENT`),s=o(()=>n.event?.eventType===`SETTLEMENT_COMPLETED`),c=o(()=>{if(!n.event)return``;switch(n.event.eventType){case`INCOMING_PAYMENT`:return`Payment Received`;case`SETTLEMENT_INITIATED`:return`Settlement Initiated`;case`SETTLEMENT_COMPLETED`:return`Settled to Bank`;case`SETTLEMENT_FAILED`:return`Settlement Failed`;default:return n.event.eventType}}),l=o(()=>a.value?`bg-emerald-50 text-emerald-700`:s.value?`bg-blue-50 text-blue-700`:`bg-slate-50 text-slate-700`),d=o(()=>{if(!n.event?.payload?.amount)return`—`;let e=n.event.payload.currency||`NGN`;return new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:e,minimumFractionDigits:0,maximumFractionDigits:2}).format(n.event.payload.amount)}),f=o(()=>n.event?.timestamp?new Date(n.event.timestamp).toLocaleString(`en-NG`,{dateStyle:`full`,timeStyle:`short`}):``);return(t,n)=>(W(),k(_,null,[K(x,{name:`drawer`},{default:F(()=>[e.isOpen?(W(),k(`div`,et,[O(`div`,tt,[O(`div`,null,[n[0]||=O(`h2`,{class:`text-lg font-semibold text-slate-800`},`Event Details`,-1),O(`p`,nt,w(c.value),1)]),O(`button`,{onClick:i,class:`p-2 rounded-lg hover:bg-slate-100 transition-colors`},[K(S(P),{class:`w-5 h-5 text-slate-500`})])]),e.event?(W(),k(`div`,rt,[O(`div`,{class:u([`p-4 rounded-xl`,l.value])},[n[1]||=O(`div`,{class:`text-sm opacity-75 mb-1`},`Amount`,-1),O(`div`,it,w(d.value),1)],2),O(`div`,at,[O(`div`,null,[n[2]||=O(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Timestamp`,-1),O(`p`,ot,w(f.value),1)]),e.event.eventRef?(W(),k(`div`,st,[n[3]||=O(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Reference`,-1),O(`p`,ct,w(e.event.eventRef),1)])):E(``,!0),e.event.payload?.payerName?(W(),k(`div`,lt,[n[4]||=O(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Payer`,-1),O(`p`,ut,w(e.event.payload.payerName),1)])):E(``,!0),e.event.payload?.payerEmail?(W(),k(`div`,dt,[n[5]||=O(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Payer Email`,-1),O(`p`,ft,w(e.event.payload.payerEmail),1)])):E(``,!0),e.event.payload?.bankName?(W(),k(`div`,pt,[n[6]||=O(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Bank`,-1),O(`p`,mt,w(e.event.payload.bankName),1)])):E(``,!0),e.event.payload?.accountNumber?(W(),k(`div`,ht,[n[7]||=O(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Account`,-1),O(`p`,gt,w(e.event.payload.accountNumber),1)])):E(``,!0),e.event.payload?.failureReason?(W(),k(`div`,_t,[n[8]||=O(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Failure Reason`,-1),O(`p`,vt,w(e.event.payload.failureReason),1)])):E(``,!0)]),n[15]||=O(`hr`,{class:`border-slate-100`},null,-1),O(`div`,yt,[O(`h3`,bt,[K(S(C),{class:`w-4 h-4 text-emerald-500`}),n[9]||=h(` Chain Verification `,-1)]),O(`div`,null,[n[10]||=O(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Block Index`,-1),O(`p`,xt,w(e.event.index),1)]),O(`div`,null,[n[11]||=O(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Block Hash`,-1),O(`p`,St,w(e.event.hash),1)]),O(`div`,null,[n[12]||=O(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Previous Hash`,-1),O(`p`,Ct,w(e.event.prevHash||`(genesis block)`),1)])]),e.event.payload?.flwRef?(W(),k(`div`,wt,[n[14]||=O(`h3`,{class:`text-sm font-medium text-slate-700`},`PSP Reference IDs`,-1),O(`div`,null,[n[13]||=O(`label`,{class:`text-xs font-medium text-slate-400 uppercase tracking-wider`},`Flutterwave Ref`,-1),O(`p`,Tt,w(e.event.payload.flwRef),1)])])):E(``,!0)])):E(``,!0),O(`div`,Et,[O(`div`,Dt,[n[17]||=O(`span`,null,`Cryptographically verified`,-1),O(`div`,Ot,[K(S(A),{class:`w-3.5 h-3.5`}),n[16]||=O(`span`,null,`Chain intact`,-1)])])])])):E(``,!0)]),_:1}),K(x,{name:`fade`},{default:F(()=>[e.isOpen?(W(),k(`div`,{key:0,class:`fixed inset-0 bg-black/20 z-40`,onClick:i})):E(``,!0)]),_:1})],64))}},At=B(kt,[[`__scopeId`,`data-v-90a5feef`]]),jt={async getSettlementAccounts(){return(await U.get(`/org/settlement-accounts`,{authorizeRequest:!0,organisationAware:!0}))?.data||[]},async getSupportedBanks(){return(await U.get(`/org/settlement-accounts/banks`,{authorizeRequest:!0,organisationAware:!0}))?.data||[]},async validateBankAccount(e,t){let n=await U.post(`/org/settlement-accounts/validate`,{data:{bankCode:e,accountNumber:t},authorizeRequest:!0,organisationAware:!0});return n?.data||n},async createSettlementAccount(e){let t=await U.post(`/org/settlement-accounts`,{data:e,authorizeRequest:!0,organisationAware:!0});return t?.data||t},async setPrimaryAccount(e){let t=await U.patch(`/org/settlement-accounts/${e}`,{data:{primary:!0},authorizeRequest:!0,organisationAware:!0});return t?.data||t},async disableAccount(e){let t=await U.patch(`/org/settlement-accounts/${e}`,{data:{enabled:!1},authorizeRequest:!0,organisationAware:!0});return t?.data||t},async getPrimaryAccount(){return(await U.get(`/org/settlement-accounts/primary`,{authorizeRequest:!0,organisationAware:!0}))?.data||null},async deleteSettlementAccount(e){let t=await U.delete(`/org/settlement-accounts/${e}`,{authorizeRequest:!0,organisationAware:!0});return t?.data||t},async retrySettlementAccount(e){let t=await U.post(`/org/settlement-accounts/${e}/retry`,{authorizeRequest:!0,organisationAware:!0});return t?.data||t}},Mt={class:`w-1/3 bg-slate-50/50 border-r border-slate-200 flex flex-col`},Nt={class:`flex-1 overflow-y-auto p-3 space-y-3`},Pt={key:0,class:`py-8 text-center text-slate-400 text-sm animate-pulse`},Ft={key:1,class:`py-12 px-4 text-center text-slate-400 text-sm`},It={class:`flex items-start justify-between mb-2`},Lt=[`title`],Rt=[`onClick`,`disabled`],zt={class:`flex flex-col gap-1`},Bt={class:`text-xs text-slate-500 font-mono tracking-wider`},Vt={class:`text-[10px] text-slate-400 font-medium truncate`},Ht={key:0,class:`mt-3 pt-2 border-t border-slate-50`},Ut={class:`inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-emerald-50 text-emerald-700 text-[10px] font-bold tracking-wide border border-emerald-100`},Wt={class:`w-2/3 flex flex-col bg-white h-full relative z-10`},Gt={class:`flex-1 overflow-y-auto px-8 py-6 space-y-6`},Kt={class:`relative space-y-2`},qt={key:0,class:`py-4 text-center text-slate-500`},Jt={key:0,class:`py-4 text-center text-slate-500 text-sm`},Yt={class:`space-y-2`},Xt={key:0,class:`py-2 flex items-center gap-3 text-slate-500`},Zt={key:1,class:`p-4 rounded-xl bg-emerald-50 border border-emerald-100 shadow-sm animate-in fade-in slide-in-from-top-2 duration-300`},Qt={class:`flex items-start gap-3`},$t={class:`bg-emerald-100 rounded-full p-1 mt-0.5`},en={class:`font-medium text-emerald-900 text-lg leading-tight`},tn={key:2,class:`p-4 rounded-xl bg-red-50 border border-red-100 shadow-sm animate-in fade-in slide-in-from-top-2 duration-300`},nn={class:`flex items-start gap-3`},rn={class:`bg-red-100 rounded-full p-1 mt-0.5`},an={class:`flex-1`},on={class:`text-sm text-red-800`},sn={class:`mt-3`},cn={class:`flex items-start gap-3 p-4 rounded-xl border border-slate-200 bg-slate-50/50`},ln={class:`p-6 border-t border-slate-100 bg-slate-50/30 flex items-center justify-between`},un={class:`flex items-center gap-3`},dn={key:0,class:`text-xs text-slate-400 italic`},fn={__name:`SettlementAccountDialog`,props:{isOpen:{type:Boolean,default:!1},initialAccounts:{type:Array,default:()=>[]}},emits:[`close`,`created`,`deleted`],setup(s,{emit:c}){let m=s,v=c,y=ee(),x=b([]),C=b(!1),T=b(null);b(null);let D=b(null),j=b({accountNumber:``,makePrimary:!0}),M=b([]),N=b(!1),P=b(``),L=b(``),R=b(!1),B=b(null),V=b(null),H=b(!1),U=o(()=>{let e=new Map;for(let t of M.value)e.set(t.name,t);return e}),G=o(()=>P.value?U.value.get(P.value):null),ne=o(()=>{if(!L.value)return M.value;let e=L.value.toLowerCase();return M.value.filter(t=>t.name.toLowerCase().includes(e))}),q=o(()=>G.value&&j.value.accountNumber.length===10&&B.value&&!R.value),J=async()=>{C.value=!0;try{let e=await jt.getSettlementAccounts();console.log(`[SettlementAccountDialog] Raw API response:`,e),console.log(`[SettlementAccountDialog] Type:`,typeof e,Array.isArray(e)),Array.isArray(e)?x.value=e.filter(e=>e.status!==`Inactive`):(console.error(`[SettlementAccountDialog] Unexpected data format:`,e),x.value=[]),console.log(`[SettlementAccountDialog] Filtered accounts:`,x.value)}catch(e){console.error(`Failed to fetch accounts:`,e)}finally{C.value=!1}},Y=e=>{D.value=e},re=async()=>{if(!D.value)return;let e=D.value;T.value=e.reference;try{await jt.deleteSettlementAccount(e.reference),y.toast({title:`Success`,message:`Settlement account removed`,variant:`success`}),v(`deleted`,e),D.value=null,await J()}catch(e){let t=e.response?.data?.message||`Failed to remove account`;console.error(`Delete failed:`,t,e),y.toast({title:`Error`,message:t,variant:`error`}),D.value=null}finally{T.value=null}},ie=e=>!e||e.length<4?`****`:`****`+e.slice(-4),ae=async()=>{if(!(N.value||M.value.length>0)){N.value=!0;try{let{data:e}=await _e.getBanksByCountry(`NG`);M.value=(e||[]).sort((e,t)=>e.name.localeCompare(t.name))}catch(e){console.error(`Failed to load banks:`,e)}finally{N.value=!1}}},pe=e=>{e&&M.value.length===0&&ae()},Q=0,me=e=>{let t=String(e).replace(/\D/g,``).slice(0,10);j.value.accountNumber=t,B.value=null,V.value=null,t.length===10&&G.value&&he()},he=async()=>{if(!G.value||j.value.accountNumber.length!==10)return;let e=++Q;R.value=!0,V.value=null,B.value=null;try{let t=await _e.validateAccount(`NG`,G.value.code,j.value.accountNumber);if(e!==Q)return;B.value=t.data?.data||t.data}catch(t){if(e!==Q)return;V.value=t.response?.data?.message||t.response?.data||`Could not verify account`}finally{e===Q&&(R.value=!1)}},ge=async()=>{if(q.value){H.value=!0;try{let e=await jt.createSettlementAccount({name:B.value.account_name,bankCode:G.value.code,bankName:G.value.name,accountNumber:j.value.accountNumber,accountName:B.value.account_name,makePrimary:j.value.makePrimary});v(`created`,e);try{await J()}catch(e){console.error(`Failed to refresh accounts after creation`,e)}ye(),v(`close`)}catch(e){y.toast({title:e.response?.data?.message||`Failed to add settlement account`,variant:`error`})}finally{H.value=!1}}},ye=()=>{j.value.accountNumber=``,j.value.makePrimary=!0,P.value=``,L.value=``,B.value=null,V.value=null},be=()=>{ye(),Q++,v(`close`)};return z(P,()=>{j.value.accountNumber.length===10&&he()}),z(()=>m.isOpen,async e=>{e&&await J()}),(o,c)=>s.isOpen?(W(),k(`div`,{key:0,class:`fixed inset-0 bg-white/80 backdrop-blur-sm z-50 flex items-center justify-center p-4`,onClick:d(be,[`self`])},[O(`div`,{class:`bg-stone-50 rounded-2xl shadow-2xl shadow-gray-300 border-4 border-white w-full max-w-4xl h-[600px] flex overflow-hidden`,onClick:c[3]||=d(()=>{},[`stop`])},[O(`div`,Mt,[c[8]||=O(`div`,{class:`p-4 border-b border-slate-200 bg-slate-50`},[O(`h3`,{class:`font-medium text-slate-700 text-sm uppercase tracking-wider`},`Settlement Accounts`)],-1),O(`div`,Nt,[C.value?(W(),k(`div`,Pt,` Loading accounts... `)):x.value.length===0?(W(),k(`div`,Ft,[...c[6]||=[f(`<div class="bg-slate-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-3"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-slate-400"><rect width="20" height="12" x="2" y="6" rx="2"></rect><circle cx="12" cy="12" r="2"></circle><path d="M6 12h.01M18 12h.01"></path></svg></div><p>No accounts yet.</p><p class="text-xs pt-1 opacity-70">Added accounts will appear here.</p>`,3)]])):E(``,!0),(W(!0),k(_,null,I(x.value,e=>(W(),k(`div`,{key:e.reference,class:`group relative bg-white p-4 rounded-xl border border-slate-200 shadow-sm transition-all hover:border-slate-300 hover:shadow-md`},[O(`div`,It,[O(`div`,{class:`font-semibold text-slate-800 text-sm truncate pr-2`,title:e.bankName},w(e.bankName),9,Lt),O(`button`,{onClick:t=>Y(e),disabled:T.value===e.reference,class:`opacity-0 group-hover:opacity-100 transition-all p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg -mr-1.5 -mt-1.5 focus:opacity-100`,title:`Delete Account`},[T.value===e.reference?(W(),p(S(X),{key:0,class:`w-3.5 h-3.5 animate-spin`})):(W(),p(S(l),{key:1,class:`w-3.5 h-3.5`}))],8,Rt)]),O(`div`,zt,[O(`div`,Bt,w(ie(e.accountNumber)),1),O(`div`,Vt,w(e.accountName),1)]),e.primary?(W(),k(`div`,Ht,[O(`span`,Ut,[K(S(A),{class:`w-2.5 h-2.5`}),c[7]||=h(` PRIMARY `,-1)])])):E(``,!0)]))),128))])]),O(`div`,Wt,[c[18]||=O(`div`,{class:`p-8 pb-6 border-b border-slate-100`},[O(`h2`,{class:`text-2xl font-bold text-slate-800`},`Add Account`),O(`p`,{class:`text-sm text-slate-500 mt-1`},` Link a new corporate bank account for automated settlements `)],-1),O(`div`,Gt,[O(`div`,Kt,[c[10]||=O(`label`,{class:`text-sm font-semibold text-slate-700`},`Select Bank`,-1),K(S(r),{modelValue:P.value,"onUpdate:modelValue":c[0]||=e=>P.value=e,searchTerm:L.value,"onUpdate:searchTerm":c[1]||=e=>L.value=e,"filter-function":e=>e,class:`relative`,"onUpdate:open":pe},{default:F(()=>[K(S(e),{class:`w-full relative`},{default:F(()=>[K(S(n),{class:`bg-slate-50 w-full pr-8 border-slate-200 shadow-sm`,placeholder:N.value?`Loading banks...`:`Search for your bank...`},null,8,[`placeholder`]),K(S(t),{class:`absolute right-0 top-0 bottom-0 px-3 flex items-center justify-center text-slate-400 hover:text-slate-600`},{default:F(()=>[...c[9]||=[O(`svg`,{xmlns:`http://www.w3.org/2000/svg`,width:`16`,height:`16`,viewBox:`0 0 24 24`,fill:`none`,stroke:`currentColor`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`,class:`lucide lucide-chevrons-up-down`},[O(`path`,{d:`m7 15 5 5 5-5`}),O(`path`,{d:`m7 9 5-5 5 5`})],-1)]]),_:1})]),_:1}),K(S(i),{class:`absolute bg-white z-[60] border border-solid border-slate-200 rounded-sm mt-1 p-1 max-h-[280px] overflow-y-auto w-full shadow-xl`,style:{"scrollbar-width":`thin`}},{default:F(()=>[N.value?(W(),k(`div`,qt,[K(S(X),{class:`w-5 h-5 animate-spin mx-auto text-blue-500`})])):(W(),k(_,{key:1},[ne.value.length===0?(W(),k(`div`,Jt,` No banks found `)):E(``,!0),(W(!0),k(_,null,I(ne.value,e=>(W(),p(S(a),{key:e.code,value:e.name,class:`px-3 py-2.5 text-sm rounded-md cursor-pointer hover:bg-slate-50 data-[highlighted]:bg-blue-50 data-[highlighted]:text-blue-700 transition-colors`},{default:F(()=>[h(w(e.name),1)]),_:2},1032,[`value`]))),128))],64))]),_:1})]),_:1},8,[`modelValue`,`searchTerm`,`filter-function`])]),O(`div`,Yt,[c[11]||=O(`label`,{class:`text-sm font-semibold text-slate-700`},`Account Number`,-1),K(S(fe),{"model-value":j.value.accountNumber,"onUpdate:modelValue":me,placeholder:`10-digit account number`,maxlength:`10`,inputmode:`numeric`,class:`bg-slate-50 border-slate-200 shadow-sm font-mono text-base tracking-wide`},null,8,[`model-value`])]),R.value?(W(),k(`div`,Xt,[K(S(X),{class:`w-4 h-4 animate-spin text-blue-500`}),c[12]||=O(`span`,{class:`text-sm`},`Verifying account details...`,-1)])):B.value?(W(),k(`div`,Zt,[O(`div`,Qt,[O(`div`,$t,[K(S(A),{class:`w-4 h-4 text-emerald-600`})]),O(`div`,null,[c[13]||=O(`div`,{class:`text-xs font-semibold text-emerald-600 uppercase tracking-wide mb-1`},` Verified Account Name`,-1),O(`div`,en,w(B.value.account_name),1)])])])):V.value?(W(),k(`div`,tn,[O(`div`,nn,[O(`div`,rn,[K(S(g),{class:`w-4 h-4 text-red-600`})]),O(`div`,an,[c[15]||=O(`div`,{class:`text-xs font-semibold text-red-600 uppercase tracking-wide mb-1`},` Verification Failed`,-1),O(`span`,on,w(V.value),1),O(`div`,sn,[K(S(Z),{size:`sm`,variant:`outline`,onClick:he,disabled:R.value,class:`rounded-full text-xs border-red-200 text-red-700 hover:bg-red-100`},{default:F(()=>[K(S(te),{class:u([`w-3 h-3 mr-1`,{"animate-spin":R.value}])},null,8,[`class`]),c[14]||=h(` Retry Verification `,-1)]),_:1},8,[`disabled`])])])])])):E(``,!0),O(`div`,cn,[K(S(ve),{checked:j.value.makePrimary,"onUpdate:checked":c[2]||=e=>j.value.makePrimary=e,id:`makePrimary`,class:`mt-1`},null,8,[`checked`]),c[16]||=O(`label`,{for:`makePrimary`,class:`text-sm text-slate-600 cursor-pointer select-none`},[O(`span`,{class:`block font-medium text-slate-800 mb-0.5`},`Set as Primary Account`),h(` Make this the default account for all future settlements. `)],-1)])]),O(`div`,ln,[K(S(Z),{variant:`ghost`,onClick:be,class:`rounded-full text-slate-500 hover:text-slate-700 hover:bg-slate-100`},{default:F(()=>[...c[17]||=[h(` Close `,-1)]]),_:1}),O(`div`,un,[!q.value&&j.value.accountNumber.length>0&&!B.value&&!R.value?(W(),k(`div`,dn,` Complete steps to proceed `)):E(``,!0),K(S(Z),{onClick:ge,disabled:!q.value||H.value,class:u([`px-8 shadow-lg shadow-blue-200 hover:shadow-blue-300 transition-all disabled:opacity-50 disabled:shadow-none`,q.value?`rounded-full`:`bg-slate-200 text-slate-400`])},{default:F(()=>[H.value?(W(),p(S(X),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):E(``,!0),h(` `+w(H.value?`Linking Account...`:`Add Settlement Account`),1)]),_:1},8,[`disabled`,`class`])])])])]),K(S(oe),{open:!!D.value,"onUpdate:open":c[5]||=e=>{e||(D.value=null)}},{default:F(()=>[K(S(se),{class:`max-w-md`},{default:F(()=>[K(S(ce),null,{default:F(()=>[K(S(ue),null,{default:F(()=>[...c[19]||=[h(`Remove Settlement Account`,-1)]]),_:1}),K(S(le),null,{default:F(()=>[c[20]||=h(` Are you sure you want to remove `,-1),O(`strong`,null,w(D.value?.bankName),1),h(` (`+w(D.value?.accountNumber)+`)? This action cannot be undone. `,1)]),_:1})]),_:1}),K(S(de),{class:`gap-2 sm:gap-2 pt-8`},{default:F(()=>[K(S(Z),{class:`rounded-full`,variant:`outline`,onClick:c[4]||=e=>D.value=null},{default:F(()=>[...c[21]||=[h(`Cancel`,-1)]]),_:1}),K(S(Z),{class:`rounded-full`,variant:`destructive`,onClick:re,disabled:T.value},{default:F(()=>[T.value?(W(),p(S(X),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):E(``,!0),h(` `+w(T.value?`Removing...`:`Remove Account`),1)]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`open`])])):E(``,!0)}},pn={class:`absolute w-full flow-vault-page min-h-screen bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-blue-300/80 to-sky-800 from-5% overflow-y-scroll h-screen`,style:{"scrollbar-width":`none`}},mn={class:`relative container mx-auto py-16 px-4 max-w-4xl`},hn={class:`flex items-center justify-between`},gn={class:`flex items-center gap-3`},_n={class:`font-medium text-blue-950`},vn={class:`text-sm text-blue-950`},yn={key:0,class:`text-right`},bn={class:`font-medium text-slate-700`},xn={key:1,class:`flex items-center justify-center py-16`},Sn={key:2,class:`py-16 px-4`},Cn={key:0,class:`text-center`},wn={class:`w-20 h-20 mx-auto mb-6 rounded-full backdrop-blur-lg bg-white/5 border border-white/50 flex items-center justify-center`},Tn={key:1,class:`max-w-2xl mx-auto`},En={class:`bg-white rounded-xl border shadow-sm p-4 mb-6`},Dn={class:`font-semibold text-slate-700 mb-3 flex items-center gap-2`},On={class:`space-y-3`},kn={class:`flex items-center gap-3`},An={class:`w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center`},jn={class:`font-medium text-slate-700 flex items-center gap-2`},Mn={key:0,class:`px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded-full text-xs font-semibold`},Nn={class:`text-sm text-slate-500`},Pn={class:`text-center`},Fn={key:3,class:`text-center py-16 px-4`},In={class:`w-20 h-20 mx-auto mb-6 rounded-full backdrop-blur-lg bg-white/5 border border-white/50 flex items-center justify-center`},Ln={class:`flex justify-center`},Rn={class:`flex items-center justify-between mb-6`},zn={class:`flex items-center gap-2`},Bn={class:`text-sm text-slate-500`},Vn={class:`flex items-center gap-2`},Hn={class:`text-sm`},Un={class:`grid grid-cols-3 gap-4 mb-6`},Wn={class:`bg-white rounded-xl border shadow-sm p-4 text-center`},Gn={class:`text-2xl font-bold text-amber-600`},Kn={class:`bg-white rounded-xl border shadow-sm p-4 text-center`},qn={class:`text-2xl font-bold text-emerald-600`},Jn={class:`bg-white rounded-xl border shadow-sm p-4 text-center`},Yn={class:`text-2xl font-bold text-blue-600`},Xn={class:`bg-white rounded-2xl border shadow-sm p-4`},Zn={__name:`FlowVault`,setup(e){let t=b(!0),n=b(null),r=b(null),i=b(!1),a=b(null),s=b(null),l=b(!1),d=b(null),f=b(!1);b(null);let m=b(null),g=e=>new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:`NGN`,minimumFractionDigits:0,maximumFractionDigits:0}).format(e||0),v=e=>!e||e.length<4?`****`:`****`+e.slice(-4),x=o(()=>n.value?n.value.active?`bg-emerald-50 border-emerald-200`:`bg-amber-50 border-amber-200`:`bg-slate-50 border-slate-200`),D=o(()=>n.value?n.value.active?`bg-emerald-100 text-emerald-600`:`bg-amber-100 text-amber-600`:`bg-slate-100 text-slate-500`),j=o(()=>n.value?.active?re:T),M=o(()=>n.value?n.value.active?`Flow Vault Active`:n.value.state===`PENDING_VIRTUAL_ACCOUNT`?`Pending Virtual Account`:`Setup Required`:`Loading...`),ee=o(()=>n.value?n.value.active?`Auto-settlement enabled`:n.value.state===`PENDING_VIRTUAL_ACCOUNT`||n.value.state===`PENDING_ACTIVATION`?`Awaiting activation`:`Add a settlement account to get started`:``),z=async(e=!1)=>{try{e||(t.value=!0);let i=await $.getVaultStatus();console.log(`[FlowVault] Vault status response:`,i),console.log(`[FlowVault] settlementAccounts in response:`,i.settlementAccounts),n.value=i,r.value={unpaidInvoices:i.unpaidInvoices||0,paidInvoices:i.paidInvoices||0,totalProcessed:i.totalProcessed||0,settlementAccounts:i.settlementAccounts||[]},i.state===`PENDING_VIRTUAL_ACCOUNT`||i.state===`PENDING_ACTIVATION`?m.value||=(console.log(`Starting polling for vault activation...`),setInterval(()=>z(!0),5e3)):m.value&&=(console.log(`Vault active or setup required. Stopping polling.`),clearInterval(m.value),null)}catch(e){console.error(`Failed to load dashboard:`,e),n.value||={state:`NOT_SETUP`,active:!1}}finally{e||(t.value=!1)}},B=()=>z(),H=async()=>{try{i.value=!0,a.value=await $.verifyChain()}catch{a.value={valid:!1,message:`Verification failed: `}}finally{i.value=!1}},U=async()=>{await $.exportJsonl()},q=async()=>{await $.exportCsv()},J=()=>{f.value=!0},Y=()=>{z()},ae=e=>{s.value=e,l.value=!0},oe=()=>{l.value=!1,setTimeout(()=>{s.value=null},300)};return V(()=>{z()}),N(()=>{m.value&&clearInterval(m.value)}),(e,o)=>(W(),k(`div`,pn,[K(ge),O(`div`,mn,[o[19]||=O(`div`,{class:`mb-8`},[O(`h1`,{class:`text-2xl font-bold text-white mb-2`},`Flow Vault`),O(`p`,{class:`text-white`},`Payment flow timeline and settlement events`)],-1),n.value?(W(),k(`div`,{key:0,class:u([`mb-6 p-4 rounded-xl border`,x.value])},[O(`div`,hn,[O(`div`,gn,[O(`div`,{class:u([`w-10 h-10 rounded-full flex items-center justify-center`,D.value])},[(W(),p(R(j.value),{class:`w-5 h-5`}))],2),O(`div`,null,[O(`h3`,_n,w(M.value),1),O(`p`,vn,w(ee.value),1)])]),n.value.settlementConfigured?(W(),k(`div`,yn,[o[2]||=O(`div`,{class:`text-xs text-slate-400`},`Settlement destination`,-1),O(`div`,bn,w(n.value.settlementBank)+` `+w(n.value.settlementAccountMasked),1)])):E(``,!0)])],2)):E(``,!0),t.value?(W(),k(`div`,xn,[K(S(X),{class:`w-8 h-8 animate-spin text-white`})])):n.value?.state===`NEEDS_SETTLEMENT_ACCOUNT`||n.value?.state===`NOT_SETUP`?(W(),k(`div`,Sn,[r.value?.settlementAccounts?.length?(W(),k(`div`,Tn,[o[8]||=O(`div`,{class:`mb-8 text-center`},[O(`h2`,{class:`text-xl font-bold text-white mb-2`},`Setup Incomplete`),O(`p`,{class:`text-white/80`},`Some settlement accounts require attention before the vault can be activated.`)],-1),O(`div`,En,[O(`h3`,Dn,[K(S(G),{class:`w-4 h-4`}),o[6]||=h(` Settlement Accounts `,-1)]),O(`div`,On,[(W(!0),k(_,null,I(r.value.settlementAccounts,e=>(W(),k(`div`,{key:e.reference,class:`flex items-center justify-between p-3 bg-slate-50 rounded-lg`},[O(`div`,kn,[O(`div`,An,[K(S(G),{class:`w-5 h-5 text-blue-600`})]),O(`div`,null,[O(`div`,jn,[h(w(e.bankName)+` `,1),e.primary?(W(),k(`span`,Mn,`Primary`)):E(``,!0)]),O(`div`,Nn,w(v(e.accountNumber))+` • `+w(e.accountName),1)])])]))),128))])]),O(`div`,Pn,[K(S(Z),{onClick:J,class:`rounded-full px-6 bg-white text-blue-900 hover:bg-slate-100`},{default:F(()=>[K(S(L),{class:`w-4 h-4 mr-2`}),o[7]||=h(` Switch Account `,-1)]),_:1})])])):(W(),k(`div`,Cn,[O(`div`,wn,[K(S(T),{class:`w-10 h-10 text-stone-100 animate-pulse`,style:{"animation-duration":`7s !important`}})]),o[4]||=O(`h2`,{class:`text-xl font-semibold text-white mb-3`},` Add a settlement account to activate your Flow Vault `,-1),o[5]||=O(`p`,{class:`text-white max-w-md mx-auto mb-6`},` Incoming payments will be routed and settled automatically to your bank account. `,-1),K(S(Z),{onClick:J,class:`rounded-full px-6`},{default:F(()=>[K(S(G),{class:`w-4 h-4 mr-2`}),o[3]||=h(` Add Settlement Account `,-1)]),_:1})]))])):n.value?.state===`PENDING_VIRTUAL_ACCOUNT`||n.value?.state===`PENDING_ACTIVATION`?(W(),k(`div`,Fn,[O(`div`,In,[K(S(X),{class:`w-10 h-10 text-stone-100 animate-spin`})]),o[10]||=O(`h2`,{class:`text-xl font-semibold text-white mb-3`},` Finalizing activation... `,-1),o[11]||=O(`p`,{class:`text-white max-w-md mx-auto mb-6 opacity-80`},` We are completing the setup of your settlement connection. This usually takes less than a minute. `,-1),O(`div`,Ln,[K(S(Z),{variant:`outline`,onClick:B,class:`rounded-full bg-white/10 text-white border-white/20 hover:bg-white/20 font-semibold px-6`},{default:F(()=>[K(S(te),{class:`w-4 h-4 mr-2`}),o[9]||=h(` Check Status `,-1)]),_:1})])])):n.value?.active?(W(),k(_,{key:4},[O(`div`,Rn,[O(`div`,zn,[O(`span`,Bn,w(n.value.blockCount)+` events recorded `,1)]),O(`div`,Vn,[K(S(Z),{variant:`outline`,size:`sm`,onClick:J,class:`rounded-full`},{default:F(()=>[K(S(L),{class:`w-4 h-4 mr-1`}),o[12]||=h(` Switch Account `,-1)]),_:1}),K(S(Z),{variant:`outline`,size:`sm`,onClick:H,disabled:i.value,class:`rounded-full`},{default:F(()=>[K(S(C),{class:`w-4 h-4 mr-1`}),h(` `+w(i.value?`Verifying...`:`Verify Chain`),1)]),_:1},8,[`disabled`]),K(S(pe),null,{default:F(()=>[K(S(he),{asChild:``},{default:F(()=>[K(S(Z),{variant:`outline`,size:`sm`,class:`rounded-full`},{default:F(()=>[K(S(c),{class:`w-4 h-4 mr-1`}),o[13]||=h(` Export `,-1)]),_:1})]),_:1}),K(S(me),null,{default:F(()=>[K(S(Q),{onClick:U},{default:F(()=>[K(S(ie),{class:`w-4 h-4 mr-2`}),o[14]||=h(` Export JSONL `,-1)]),_:1}),K(S(Q),{onClick:q},{default:F(()=>[K(S(ne),{class:`w-4 h-4 mr-2`}),o[15]||=h(` Export CSV `,-1)]),_:1})]),_:1})]),_:1})])]),a.value?(W(),k(`div`,{key:0,class:u([`mb-4 p-3 rounded-lg flex items-center gap-2`,a.value.valid?`bg-emerald-50 text-emerald-700`:`bg-orange-50 text-orange-700`])},[(W(),p(R(a.value.valid?S(A):S(y)),{class:`w-5 h-5`})),O(`span`,Hn,w(a.value.message),1),O(`button`,{onClick:o[0]||=e=>a.value=null,class:`ml-auto`},[K(S(P),{class:`w-4 h-4`})])],2)):E(``,!0),O(`div`,Un,[O(`div`,Wn,[O(`div`,Gn,w(r.value?.unpaidInvoices||0),1),o[16]||=O(`div`,{class:`text-xs text-slate-500 uppercase tracking-wide`},`Unpaid Invoices`,-1)]),O(`div`,Kn,[O(`div`,qn,w(r.value?.paidInvoices||0),1),o[17]||=O(`div`,{class:`text-xs text-slate-500 uppercase tracking-wide`},`Paid Invoices`,-1)]),O(`div`,Jn,[O(`div`,Yn,w(g(r.value?.totalProcessed||0)),1),o[18]||=O(`div`,{class:`text-xs text-slate-500 uppercase tracking-wide`},`Total Processed`,-1)])]),O(`div`,Xn,[K($e,{ref_key:`timelineRef`,ref:d,onEventClick:ae},null,512)])],64)):E(``,!0)]),K(At,{event:s.value,"is-open":l.value,onClose:oe},null,8,[`event`,`is-open`]),K(fn,{"is-open":f.value,"initial-accounts":r.value?.settlementAccounts||[],onClose:o[1]||=e=>f.value=!1,onCreated:Y,onDeleted:Y},null,8,[`is-open`,`initial-accounts`])]))}};export{Zn as default};