import{Fa as e,Ki as t,Li as n,Oa as r,Pa as i,Ra as a,Vi as o,Wi as s,ca as c,gr as l,ha as u,ia as d,o as f,oa as p,qi as m,zt as h}from"./index-CTHZVx0Q.js";var g={class:`bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden p-6 space-y-4`},_={class:`font-semibold text-gray-900 flex items-center gap-2`},v={key:0,class:`text-sm text-gray-500 flex items-center gap-2`},y={key:1,class:`text-sm text-gray-500 italic`},b={key:2,class:`overflow-x-auto`},x={class:`w-full text-sm text-left`},S={class:`px-4 py-2`},C={class:`px-4 py-2`},w={class:`text-gray-700 font-medium`},T={class:`px-4 py-2 text-right font-medium`},E={class:`px-4 py-2`},D={__name:`AllocationHistory`,props:{targetType:String,targetId:String},setup(D){let O=D,k=r([]),A=r(!1),j=async()=>{if(O.targetId){A.value=!0;try{k.value=(await f.get(`/org/payments/target/${encodeURIComponent(O.targetType||`Sales Invoice`)}/${encodeURIComponent(O.targetId)}`,{authorizeRequest:!0,organisationAware:!0})).data||[]}catch(e){console.error(`Failed to fetch allocations:`,e),k.value=[]}finally{A.value=!1}}},M=(e,t)=>new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:t||`NGN`}).format(e||0),N=e=>e?new Date(e).toLocaleDateString(`en-NG`,{day:`numeric`,month:`short`,year:`numeric`}):`-`,P=e=>e===`SUBMITTED`?`bg-green-100 text-green-800`:e===`CANCELLED`?`bg-red-100 text-red-800`:e===`DRAFT`?`bg-yellow-100 text-yellow-800`:`bg-gray-100 text-gray-800`;return d(j),u(()=>O.targetId,j),(r,u)=>(p(),s(`div`,g,[o(`h3`,_,[m(i(l),{class:`w-5 h-5 text-gray-400`}),u[0]||=t(` Payment Allocations `,-1)]),A.value?(p(),s(`div`,v,[m(i(h),{class:`w-4 h-4 animate-spin`}),u[1]||=t(` Loading... `,-1)])):k.value.length===0?(p(),s(`div`,y,`No payments allocated.`)):(p(),s(`div`,b,[o(`table`,x,[u[2]||=o(`thead`,{class:`text-xs text-gray-500 uppercase bg-gray-50`},[o(`tr`,null,[o(`th`,{class:`px-4 py-2`},`Date`),o(`th`,{class:`px-4 py-2`},`Reference`),o(`th`,{class:`px-4 py-2 text-right`},`Amount`),o(`th`,{class:`px-4 py-2`},`Status`)])],-1),o(`tbody`,null,[(p(!0),s(n,null,c(k.value,t=>(p(),s(`tr`,{key:t.reference,class:`border-b last:border-0 hover:bg-gray-50`},[o(`td`,S,a(N(t.allocationDate)),1),o(`td`,C,[o(`span`,w,a(t.reference),1)]),o(`td`,T,a(M(t.allocatedAmount,t.currency)),1),o(`td`,E,[o(`span`,{class:e([P(t.status),`px-2 py-1 rounded-full text-xs font-bold`])},a(t.status),3)])]))),128))])])]))]))}};export{D as default};