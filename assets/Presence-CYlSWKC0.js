import{A as e,D as t,I as n,O as r,X as i,ft as a,gt as o,v as s,z as c}from"./index-vegYmq3T.js";import{i as l}from"./dist-7nj00zp2.js";import{h as u,i as d,n as f,v as p}from"./useForwardExpose-CjVMQCNw.js";function m(e){return s(()=>p(e)?!!d(e)?.closest(`form`):!0)}function h(e,t){let n=a(e);function r(e){return t[n.value][e]??n.value}return{state:n,dispatch:e=>{n.value=r(e)}}}function g(e,t){let r=a({}),o=a(`none`),l=a(e),d=e.value?`mounted`:`unmounted`,p,m=t.value?.ownerDocument.defaultView??f,{state:g,dispatch:v}=h(d,{mounted:{UNMOUNT:`unmounted`,ANIMATION_OUT:`unmountSuspended`},unmountSuspended:{MOUNT:`mounted`,ANIMATION_END:`unmounted`},unmounted:{MOUNT:`mounted`}}),y=e=>{if(u){let n=new CustomEvent(e,{bubbles:!1,cancelable:!1});t.value?.dispatchEvent(n)}};i(e,async(e,i)=>{let a=i!==e;if(await n(),a){let n=o.value,a=_(t.value);e?(v(`MOUNT`),y(`enter`),a===`none`&&y(`after-enter`)):a===`none`||a===`undefined`||r.value?.display===`none`?(v(`UNMOUNT`),y(`leave`),y(`after-leave`)):i&&n!==a?(v(`ANIMATION_OUT`),y(`leave`)):(v(`UNMOUNT`),y(`after-leave`))}},{immediate:!0});let b=e=>{let n=_(t.value),r=n.includes(CSS.escape(e.animationName)),i=g.value===`mounted`?`enter`:`leave`;if(e.target===t.value&&r&&(y(`after-${i}`),v(`ANIMATION_END`),!l.value)){let e=t.value.style.animationFillMode;t.value.style.animationFillMode=`forwards`,p=m?.setTimeout(()=>{t.value?.style.animationFillMode===`forwards`&&(t.value.style.animationFillMode=e)})}e.target===t.value&&n===`none`&&v(`ANIMATION_END`)},x=e=>{e.target===t.value&&(o.value=_(t.value))},S=i(t,(e,t)=>{e?(r.value=getComputedStyle(e),e.addEventListener(`animationstart`,x),e.addEventListener(`animationcancel`,b),e.addEventListener(`animationend`,b)):(v(`ANIMATION_END`),p!==void 0&&m?.clearTimeout(p),t?.removeEventListener(`animationstart`,x),t?.removeEventListener(`animationcancel`,b),t?.removeEventListener(`animationend`,b))},{immediate:!0}),C=i(g,()=>{let e=_(t.value);o.value=g.value===`mounted`?e:`none`});return c(()=>{S(),C()}),{isPresent:s(()=>[`mounted`,`unmountSuspended`].includes(g.value))}}function _(e){return e&&getComputedStyle(e).animationName||`none`}var v=t({name:`Presence`,props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(t,{slots:n,expose:i}){let{present:s,forceMount:c}=o(t),u=a(),{isPresent:f}=g(s,u);i({present:f});let p=n.default({present:f.value});p=l(p||[]);let m=r();if(p&&p?.length>1){let e=m?.parent?.type.name?`<${m.parent.type.name} />`:`component`;throw Error([`Detected an invalid children for \`${e}\` for  \`Presence\` component.`,``,"Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.",`You can apply a few solutions:`,["Provide a single child element so that `presence` directive attach correctly.",`Ensure the first child is an actual element instead of a raw text node or comment node.`].map(e=>`  - ${e}`).join(`
`)].join(`
`))}return()=>c.value||s.value||f.value?e(n.default({present:f.value})[0],{ref:e=>{let t=d(e);return t?.hasAttribute===void 0||(t?.hasAttribute(`data-reka-popper-content-wrapper`)?u.value=t.firstElementChild:u.value=t),t}}):null}});export{m as n,v as t};