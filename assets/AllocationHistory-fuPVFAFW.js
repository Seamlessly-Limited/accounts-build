import{Bt as e,Fa as t,Ki as n,Li as r,Oa as i,Pa as a,Ra as o,Vi as s,Wi as c,ca as l,gr as u,ha as d,ia as f,o as p,oa as m,qi as h}from"./index-BHNnQTTo.js";var g={class:`bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden p-6 space-y-4`},_={class:`font-semibold text-gray-900 flex items-center gap-2`},v={key:0,class:`text-sm text-gray-500 flex items-center gap-2`},y={key:1,class:`text-sm text-gray-500 italic`},b={key:2,class:`overflow-x-auto`},x={class:`w-full text-sm text-left`},S={class:`px-4 py-2`},C={class:`px-4 py-2`},w={class:`text-gray-700 font-medium`},T={class:`px-4 py-2 text-right font-medium`},E={class:`px-4 py-2`},D={__name:`AllocationHistory`,props:{targetType:String,targetId:String},setup(D){let O=D,k=i([]),A=i(!1),j=async()=>{if(O.targetId){A.value=!0;try{k.value=(await p.get(`/org/payments/target/${encodeURIComponent(O.targetType||`Sales Invoice`)}/${encodeURIComponent(O.targetId)}`,{authorizeRequest:!0,organisationAware:!0})).data||[]}catch(e){console.error(`Failed to fetch allocations:`,e),k.value=[]}finally{A.value=!1}}},M=(e,t)=>new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:t||`NGN`}).format(e||0),N=e=>e?new Date(e).toLocaleDateString(`en-NG`,{day:`numeric`,month:`short`,year:`numeric`}):`-`,P=e=>e===`SUBMITTED`?`bg-green-100 text-green-800`:e===`CANCELLED`?`bg-red-100 text-red-800`:e===`DRAFT`?`bg-yellow-100 text-yellow-800`:`bg-gray-100 text-gray-800`;return f(j),d(()=>O.targetId,j),(i,d)=>(m(),c(`div`,g,[s(`h3`,_,[h(a(u),{class:`w-5 h-5 text-gray-400`}),d[0]||=n(` Payment Allocations `,-1)]),A.value?(m(),c(`div`,v,[h(a(e),{class:`w-4 h-4 animate-spin`}),d[1]||=n(` Loading... `,-1)])):k.value.length===0?(m(),c(`div`,y,`No payments allocated.`)):(m(),c(`div`,b,[s(`table`,x,[d[2]||=s(`thead`,{class:`text-xs text-gray-500 uppercase bg-gray-50`},[s(`tr`,null,[s(`th`,{class:`px-4 py-2`},`Date`),s(`th`,{class:`px-4 py-2`},`Reference`),s(`th`,{class:`px-4 py-2 text-right`},`Amount`),s(`th`,{class:`px-4 py-2`},`Status`)])],-1),s(`tbody`,null,[(m(!0),c(r,null,l(k.value,e=>(m(),c(`tr`,{key:e.reference,class:`border-b last:border-0 hover:bg-gray-50`},[s(`td`,S,o(N(e.allocationDate)),1),s(`td`,C,[s(`span`,w,o(e.reference),1)]),s(`td`,T,o(M(e.allocatedAmount,e.currency)),1),s(`td`,E,[s(`span`,{class:t([P(e.status),`px-2 py-1 rounded-full text-xs font-bold`])},o(e.status),3)])]))),128))])])]))]))}};export{D as default};