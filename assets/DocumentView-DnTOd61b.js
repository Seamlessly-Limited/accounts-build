import"./useFormControl-DNz7k4w5.js";import"./ListboxItem-gURPCPWT.js";import"./useNonce-Zz8BWqvg.js";import"./nullish-CfjOSA4G.js";import"./useArrowNavigation-siWGBYoD.js";import"./ConfigProvider-CX3z9H2g.js";import"./useHideOthers-BMVpLdiv.js";import"./useDirection-CVICsvLJ.js";import"./PopperAnchor-BDMp0DVx.js";import"./useId-D49Isxay.js";import"./useKbd-BvGB3m10.js";import"./PopperContent-CYLydaJo.js";import"./useTypeahead-DQhWDs5L.js";import"./DialogPortal-ByZ-ApFh.js";import"./Teleport-nEgZhyc-.js";import"./utils-Bv7ngM-A.js";import"./DialogTitle-msxagOR7.js";import"./utils-BngY0H0a.js";import"./RovingFocusGroup-BE-sAXeo.js";import"./VisuallyHiddenInput-DzwRJu2R.js";import"./ComboboxItem-yuuEIVEa.js";import"./ComboboxGroup-oY2S-egi.js";import"./DropdownMenuTrigger-BH8h516Z.js";import"./MenuSeparator-B2rQS07Y.js";import"./DropdownMenuSeparator-2LegL34y.js";import"./Label-BzNmG4jj.js";import"./SelectViewport-VrHoVk6u.js";import"./SelectGroup-mRhUQAYm.js";import{Ai as e,At as t,Di as n,Dn as r,Gi as i,Gt as a,Ni as o,Oi as s,Pi as c,Qi as l,Sa as u,Sn as d,T as f,Ta as p,X as m,Yi as h,ct as g,dn as _,fr as v,g as y,gn as ee,gt as te,h as b,ha as x,ji as S,ki as C,na as w,o as T,qi as E,sa as D,tn as O,wi as k,xa as A}from"./index-DUz5oLRf.js";import{n as j,t as M}from"./DialogContent-Cu4jeHS4.js";import{n as N,r as P,t as F}from"./DialogTitle-Cnc8au_F.js";import{t as I}from"./DialogFooter-CZX4uIFg.js";import{t as L}from"./WorkspaceStore-DloGvRxv.js";import{t as R}from"./Input-nMYpliAi.js";import{t as z}from"./button-CLcRjLYE.js";import{i as ne,n as B,r as re,t as V}from"./DropdownMenuTrigger-DAfLkUey.js";import{t as H}from"./DropdownMenuSeparator-CkaniFT2.js";import"./DynamicIcon-9hv_PMkg.js";import"./BottomSheet-BbvV1osc.js";import"./viewRegistry-DuQEad4b.js";import{t as U}from"./Label-BF80UCQs.js";import"./LinkField-JIFjc5kv.js";import"./SelectValue-B-w7Avnt.js";import{t as W}from"./DocForm-BDvxZvMs.js";import{t as G}from"./Textarea-B2ujhXoz.js";var K={class:`grid gap-4 py-4`},q={class:`grid gap-2`},J={class:`grid gap-2`},Y={class:`grid gap-2`},X={__name:`ShareDialog`,props:{modelValue:{type:Boolean,default:!1},doctype:{type:String,required:!0},docName:{type:String,required:!0},defaultRecipient:{type:String,default:``},docData:{type:Object,default:()=>({})}},emits:[`update:modelValue`,`sent`],setup(r,{emit:i}){let a=r,l=i,{toast:u}=b(),d=x(!1),f=n({get:()=>a.modelValue,set:e=>l(`update:modelValue`,e)}),m=x({recipient:``,subject:``,content:``});w(()=>a.modelValue,e=>{e&&(m.value.recipient=a.defaultRecipient||a.docData.email||``,m.value.subject=`${a.doctype} Shared: ${a.docName}`,m.value.content=`Please find the attached ${a.doctype} ${a.docName}.`)});let h=async()=>{if(m.value.recipient){d.value=!0;try{await T.post(`/org/doc/Notification`,{data:{related_document:a.docName,recipient:m.value.recipient,channel:`Email`,subject:m.value.subject,content:m.value.content,status:`Queued`},authorizeRequest:!0,organisationAware:!0}),u({title:`Notification Queued`,description:`Email to ${m.value.recipient} has been queued.`,variant:`success`}),f.value=!1,l(`sent`)}catch(e){console.error(e),u({title:`Failed to Share`,description:e.response?.data?.message||e.message,variant:`destructive`})}finally{d.value=!1}}};return(n,i)=>(E(),C(A(j),{open:f.value,"onUpdate:open":i[4]||=e=>f.value=e},{default:D(()=>[c(A(M),{class:`sm:max-w-[500px]`},{default:D(()=>[c(A(N),null,{default:D(()=>[c(A(F),null,{default:D(()=>[o(`Share `+p(r.doctype),1)]),_:1}),c(A(P),null,{default:D(()=>[...i[5]||=[o(` Send this document via email. `,-1)]]),_:1})]),_:1}),s(`div`,K,[s(`div`,q,[c(A(U),{for:`recipient`},{default:D(()=>[...i[6]||=[o(`Recipient Email`,-1)]]),_:1}),c(A(R),{id:`recipient`,modelValue:m.value.recipient,"onUpdate:modelValue":i[0]||=e=>m.value.recipient=e,placeholder:`name@example.com`,type:`email`},null,8,[`modelValue`])]),s(`div`,J,[c(A(U),{for:`subject`},{default:D(()=>[...i[7]||=[o(`Subject`,-1)]]),_:1}),c(A(R),{id:`subject`,modelValue:m.value.subject,"onUpdate:modelValue":i[1]||=e=>m.value.subject=e,placeholder:`Subject line`},null,8,[`modelValue`])]),s(`div`,Y,[c(A(U),{for:`message`},{default:D(()=>[...i[8]||=[o(`Message (Optional)`,-1)]]),_:1}),c(A(G),{id:`message`,modelValue:m.value.content,"onUpdate:modelValue":i[2]||=e=>m.value.content=e,placeholder:`Add a personal message...`,rows:`4`},null,8,[`modelValue`])])]),c(A(I),null,{default:D(()=>[c(A(z),{variant:`outline`,onClick:i[3]||=e=>f.value=!1},{default:D(()=>[...i[9]||=[o(`Cancel`,-1)]]),_:1}),c(A(z),{onClick:h,disabled:d.value||!m.value.recipient},{default:D(()=>[d.value?(E(),C(A(t),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):e(``,!0),o(` `+p(d.value?`Sending...`:`Send`),1)]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`open`]))}},ie={class:`h-full flex flex-col bg-slate-50/50`},ae={class:`flex-none px-6 py-3 bg-white border-b border-gray-200 flex items-center justify-between sticky top-0 z-20`},oe={class:`flex items-center space-x-4`},se={class:`p-2 rounded-lg bg-stone-100`},ce={class:`flex items-center gap-2`},le={class:`text-[10px] font-bold text-stone-400 uppercase tracking-widest`},ue={class:`text-lg font-bold text-stone-900 leading-tight`},de={class:`flex items-center gap-2`},fe={class:`flex items-center bg-stone-100 p-0.5 rounded-full border border-stone-200 shadow-sm`},pe={class:`p-2 hover:bg-stone-100 rounded-full text-stone-500 transition-colors`},me={class:`flex-1 overflow-auto`},he={key:0,class:`h-full flex items-center justify-center`},ge={key:1,class:`h-full`},_e={key:0,class:`max-w-4xl mx-auto py-8 px-6`},ve={class:`bg-white rounded-3xl shadow-xl shadow-stone-200/50 border border-stone-200/60 overflow-hidden ring-1 ring-black/5`},ye={class:`px-8 py-8 border-b border-stone-100 flex justify-between items-start bg-gradient-to-br from-white to-stone-50/50`},be={class:`text-3xl font-black text-stone-900 tracking-tight`},xe={class:`text-stone-500 mt-1 flex items-center gap-2`},Se={class:`text-right`},Ce={class:`text-sm font-medium text-stone-600`},we={class:`p-8 space-y-10`},Te={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-12 gap-y-8`},Ee={class:`block text-[10px] font-bold text-stone-400 uppercase tracking-widest group-hover:text-stone-500 transition-colors`},De={class:`text-sm font-semibold text-stone-800 break-words`},Oe=[`onClick`],ke={key:0,class:`space-y-8 pt-6 border-t border-stone-100`},Ae={class:`block text-[10px] font-bold text-stone-400 uppercase tracking-widest`},je={class:`text-sm text-stone-600 leading-relaxed bg-stone-50/50 p-4 rounded-xl border border-stone-100 whitespace-pre-wrap`},Me={class:`pt-10 mt-10 border-t border-stone-100 flex items-center justify-between text-[11px] text-stone-400`},Ne={class:`flex items-center gap-4`},Pe={class:`flex items-center gap-1`},Fe={class:`flex items-center gap-1`},Ie={class:`flex items-center gap-1 font-mono uppercase opacity-60`},Z={key:1,class:`h-full`},Q={__name:`DocumentView`,props:{doctype:{type:String,required:!0},name:{type:String,required:!0},initialMode:{type:String,default:`view`}},setup(w){let j=w,{toast:M}=b(),N=L(),P=x(!0),F=x(j.initialMode),I=x({}),R=x({}),z=x(!1),U=n(()=>R.value.fields?R.value.fields.filter(e=>![`TABLE`,`SECTION_BREAK`,`COLUMN_BREAK`,`TEXT`,`LONG_TEXT`,`HTML`,`JSON`,`HEADING`].includes(e.fieldtype)&&!e.hidden):[]),G=n(()=>R.value.fields?R.value.fields.filter(e=>[`TEXT`,`LONG_TEXT`,`HTML`,`JSON`].includes(e.fieldtype)&&!e.hidden):[]);i(K);async function K(){P.value=!0;try{let[e,t]=await Promise.all([T.get(`/org/doctypes/${encodeURIComponent(j.doctype)}`,{authorizeRequest:!0,organisationAware:!0}),T.get(`/org/doc/${encodeURIComponent(j.doctype)}/${encodeURIComponent(j.name)}`,{authorizeRequest:!0,organisationAware:!0})]);R.value=e.data||e,I.value=t.data||t}catch(e){console.error(e),M({title:`Fetch failed`,description:e.message,variant:`destructive`})}finally{P.value=!1}}function q(e){I.value=e,F.value=`view`,M({title:`Updated`,description:`Changes saved successfully`,variant:`success`})}function J(e){return y[e]||O}function Y(e){return typeof e==`number`?{0:`Draft`,1:`Submitted`,2:`Cancelled`}[e]||`Unknown`:e||`Draft`}function Q(e){return{Draft:`bg-stone-100 text-stone-600`,Submitted:`bg-blue-100 text-blue-600`,Paid:`bg-green-100 text-green-600`,Cancelled:`bg-red-100 text-red-600`,Active:`bg-indigo-100 text-indigo-600`}[Y(e)]||`bg-stone-100 text-stone-600`}function $(e){return e?new Date(e).toLocaleString(void 0,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`}):`—`}function Le(e){return e?new Date(e).toLocaleDateString(void 0,{year:`numeric`,month:`short`,day:`numeric`}):`—`}function Re(e){return e==null?`—`:new Intl.NumberFormat(void 0,{style:`currency`,currency:I.value.currency||`NGN`}).format(e)}function ze(e,t){!e||!t||N.openTab({id:`doctype-view-${e}-${t}`,title:t,icon:`FileText`,type:`doctype-view`,doctype:e,docName:t,closable:!0})}function Be(){z.value=!0}function Ve(){N.openTab({id:`archive-${j.doctype}-${j.name}`,title:`Archive: ${j.name}`,type:`archive`,doctype:j.doctype,docName:j.name,closable:!0})}function He(){M({title:`Duplicate`,description:`Duplication coming soon`})}function Ue(){window.print()}return(n,i)=>(E(),S(k,null,[s(`div`,ie,[s(`header`,ae,[s(`div`,oe,[s(`div`,se,[(E(),C(l(J(R.value.icon)),{class:`w-5 h-5 text-stone-600`}))]),s(`div`,null,[s(`div`,ce,[s(`span`,le,p(R.value.name),1),I.value.status?(E(),S(`span`,{key:0,class:u([`px-1.5 py-0.5 rounded-full text-[9px] font-bold uppercase tracking-wider`,Q(I.value.status||I.value.docstatus)])},p(Y(I.value.status||I.value.docstatus)),3)):e(``,!0)]),s(`h1`,ue,p(I.value[R.value.title_field]||I.value.name||w.name),1)])]),s(`div`,de,[s(`div`,fe,[s(`button`,{onClick:i[0]||=e=>F.value=`view`,class:u([`px-4 py-1.5 rounded-full text-xs font-semibold transition-all flex items-center gap-2`,F.value===`view`?`bg-white text-stone-900 shadow-sm ring-1 ring-stone-900/5`:`text-stone-500 hover:text-stone-700`])},[c(A(_),{class:`w-3.5 h-3.5`}),i[3]||=o(` View `,-1)],2),s(`button`,{onClick:i[1]||=e=>F.value=`edit`,class:u([`px-4 py-1.5 rounded-full text-xs font-semibold transition-all flex items-center gap-2`,F.value===`edit`?`bg-white text-stone-900 shadow-sm ring-1 ring-stone-900/5`:`text-stone-500 hover:text-stone-700`])},[c(A(te),{class:`w-3.5 h-3.5`}),i[4]||=o(` Edit `,-1)],2)]),i[8]||=s(`div`,{class:`w-px h-6 bg-stone-200 mx-1`},null,-1),s(`button`,{onClick:Be,class:`p-2 hover:bg-stone-100 rounded-full text-stone-500 transition-colors`},[c(A(m),{class:`w-4 h-4`})]),c(A(ne),null,{default:D(()=>[c(A(V),{"as-child":``},{default:D(()=>[s(`button`,pe,[c(A(ee),{class:`w-4 h-4`})])]),_:1}),c(A(re),{align:`end`},{default:D(()=>[c(A(B),{onClick:Ue},{default:D(()=>[c(A(g),{class:`w-4 h-4 mr-2`}),i[5]||=o(` Print `,-1)]),_:1}),c(A(B),{onClick:He},{default:D(()=>[c(A(d),{class:`w-4 h-4 mr-2`}),i[6]||=o(` Duplicate `,-1)]),_:1}),c(A(H)),c(A(B),{onClick:Ve,class:`text-amber-600`},{default:D(()=>[c(A(v),{class:`w-4 h-4 mr-2`}),i[7]||=o(` Archive `,-1)]),_:1})]),_:1})]),_:1})])]),s(`div`,me,[P.value?(E(),S(`div`,he,[c(A(t),{class:`w-8 h-8 animate-spin text-stone-300`})])):(E(),S(`div`,ge,[F.value===`view`?(E(),S(`div`,_e,[s(`div`,ve,[s(`div`,ye,[s(`div`,null,[s(`h2`,be,p(I.value[R.value.title_field]||I.value.name||w.name),1),s(`p`,xe,[c(A(a),{class:`w-3.5 h-3.5 opacity-40`}),o(` `+p(I.value.name),1)])]),s(`div`,Se,[i[9]||=s(`p`,{class:`text-[10px] font-bold text-stone-400 uppercase tracking-widest mb-1`},`Created `,-1),s(`p`,Ce,p($(I.value.created_at)),1)])]),s(`div`,we,[s(`div`,Te,[(E(!0),S(k,null,h(U.value,e=>(E(),S(`div`,{key:e.fieldname,class:`space-y-1.5 group`},[s(`label`,Ee,p(e.label),1),s(`div`,De,[e.fieldtype===`CURRENCY`?(E(),S(k,{key:0},[o(p(Re(I.value[e.fieldname])),1)],64)):e.fieldtype===`CHECKBOX`?(E(),S(`span`,{key:1,class:u(I.value[e.fieldname]?`text-green-600`:`text-stone-400 opacity-50`)},p(I.value[e.fieldname]?`Yes`:`No`),3)):e.fieldtype===`DATE`?(E(),S(k,{key:2},[o(p(Le(I.value[e.fieldname])),1)],64)):e.fieldtype===`LINK`?(E(),S(`button`,{key:3,onClick:t=>ze(e.options,I.value[e.fieldname]),class:`text-blue-600 hover:text-blue-800 hover:underline decoration-2 underline-offset-4 decoration-blue-200 transition-all`},p(I.value[e.fieldname]),9,Oe)):(E(),S(k,{key:4},[o(p(I.value[e.fieldname]||`—`),1)],64))])]))),128))]),G.value.length>0?(E(),S(`div`,ke,[(E(!0),S(k,null,h(G.value,e=>(E(),S(`div`,{key:e.fieldname,class:`space-y-2`},[s(`label`,Ae,p(e.label),1),s(`div`,je,p(I.value[e.fieldname]||`No content provided.`),1)]))),128))])):e(``,!0),s(`div`,Me,[s(`div`,Ne,[s(`span`,Pe,[c(A(f),{class:`w-3 h-3`}),o(` Owner: `+p(I.value.owner||`System`),1)]),s(`span`,Fe,[c(A(r),{class:`w-3 h-3`}),o(` Modified: `+p($(I.value.modified_at||I.value.updated_at)),1)])]),s(`div`,Ie,` MOD: `+p(R.value.module),1)])])])])):(E(),S(`div`,Z,[c(W,{doctype:w.doctype,name:w.name,"is-new":!1,"is-embedded":``,onSaved:q},null,8,[`doctype`,`name`])]))]))])]),I.value.name?(E(),C(X,{key:0,modelValue:z.value,"onUpdate:modelValue":i[2]||=e=>z.value=e,doctype:w.doctype,docName:w.name,docData:I.value},null,8,[`modelValue`,`doctype`,`docName`,`docData`])):e(``,!0)],64))}};export{Q as default};