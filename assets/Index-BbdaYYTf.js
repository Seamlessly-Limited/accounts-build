import{B as e,H as t,S as n,St as r,T as i,W as a,a as o,et as s,f as c,m as l,o as u,w as d,x as f,y as p}from"./index-4ZmatjLT.js";import"./VisuallyHidden-BMoChTfG.js";import"./dist-1hay9DAo.js";import"./useArrowNavigation-9kt7NZor.js";import"./useForwardExpose-6sUiVR1u.js";import"./useDirection-aUV61Fbq.js";import"./VisuallyHiddenInput-DWGggc4t.js";import"./Label-IOZNx8Pf.js";import{n as m,r as h,t as g}from"./PinInputSlot-B20smsI2.js";import"./utils-DJKW7nPS.js";import"./dist-CQ4NwXXT.js";import{r as _}from"./UserService-C1_pNoI_.js";import{t as v}from"./Card-CRjTeu-x.js";import{t as y}from"./CardContent-BppXbrpw.js";import{t as b}from"./CardDescription--eeMdWHn.js";import{n as x,t as S}from"./CardTitle-CzZs1zq1.js";import{t as C}from"./BackgroundAnimation-Dg04LcbR.js";import{t as w}from"./button-DT88A13k.js";import{t as T}from"./Input-CvdiO7o9.js";import{t as E}from"./Label-CTzDFwKT.js";import{a as D,i as O,n as k,r as A,t as j}from"./form-D2QBssog.js";import"./Label-Dj-8etDF.js";var M={name:`PasswordResetView`,components:{Card:v,CardHeader:x,CardTitle:S,CardDescription:b,CardContent:y,Button:w,Input:T,Label:E,BackgroundAnimation:C,FormField:D,FormItem:k,FormLabel:j,FormControl:O,PinInput:h,PinInputGroup:m,PinInputSlot:g,FormDescription:A},data(){return{email:``,token:[],loading:!1,message:``,requestingReset:!0,resendCount:0,resendWaitTime:0}},computed:{formDisabled(){return this.loading||void 0}},methods:{paste(e){let t=(e.clipboardData||window.clipboardData).getData(`text`).trim();this.token=[``,...t.split(``)],t.length===6&&this.completeVerification()},focusNext(e,t){let n=`${e.target.value}`.trim();if(t===6&&n)return this.completeVerification();n.length===1&&t<6&&this.$refs[`otpInput`+(t+1)][0].focus(),n.length===0&&t>1&&this.$refs[`otpInput`+(t-1)][0].focus()},countDown(){this.resendWaitTime=60+this.resendCount;let e=setInterval(()=>--this.resendWaitTime,998);setTimeout(()=>{clearInterval(e),this.resendWaitTime=0},this.resendWaitTime*1e3)},async requestPasswordReset(){if(!this.email)return;this.loading=!0;let e=u();try{if(this.resendCount>90)return;let{message:t}=await _.requestPasswordReset(this.email);this.requestingReset=!1,this.resendCount+=30,this.countDown(),this.message=t,e.toast({message:t,type:`success`,duration:5e3})}catch(t){e.toast({message:t.message,duration:5e3,type:`error`})}this.loading=!1},async completeVerification(){let e=u(),t=``;try{if(t=this.token.reduce((e,t)=>`${e}${t}`),t.length<6)throw Error(`Invalid code provided!`)}catch{e.toast({message:`Invalid code provided!`,duration:5e3,type:`error`});return}this.loading=!0;try{await _.validatePasswordReset(t),this.$router.push(`/password-reset/complete`)}catch(t){e.toast({message:t.message,duration:5e3,type:`error`})}this.loading=!1}}},N={class:`min-h-screen flex flex-col items-center justify-center bg-stone-100 relative overflow-hidden`},P={key:0,class:`space-y-2 my-5`},F={class:`flex items-center gap-2`},I={key:1,class:`grid grid-cols-1 gap-2 mt-4 w-full`},L={class:`text-sm text-muted-foreground w-full`},R=[`innerHTML`],z={class:`flex justify-end mt-3`},B={key:0},V={key:1},H={key:2,class:`mt-4 text-sm text-gray-700`},U={key:0},W={key:1};function G(o,u,m,h,g,_){let v=a(`BackgroundAnimation`),y=a(`CardTitle`),b=a(`CardDescription`),x=a(`CardHeader`),S=a(`Label`),C=a(`Input`),w=a(`FormLabel`),T=a(`PinInputSlot`),E=a(`PinInputGroup`),D=a(`PinInput`),O=a(`FormControl`),k=a(`FormItem`),A=a(`FormField`),j=a(`Button`),M=a(`CardContent`),G=a(`Card`);return e(),n(`div`,N,[i(v),i(G,{class:`relative z-10 w-full max-w-lg rounded-2xl shadow-md border-solid backdrop-blur bg-white/80`},{default:s(()=>[i(x,{class:`space-y-2`},{default:s(()=>[i(y,{class:`text-2xl font-semibold`},{default:s(()=>[...u[4]||=[d(`Reset your password`,-1)]]),_:1}),i(b,null,{default:s(()=>[...u[5]||=[d(`Secure your account with a new password.`,-1)]]),_:1})]),_:1}),i(M,{class:``},{default:s(()=>[p(`form`,{onSubmit:u[3]||=c(e=>g.requestingReset?_.requestPasswordReset():_.completeVerification(),[`prevent`])},[g.requestingReset?(e(),n(`div`,P,[i(S,{for:`email`},{default:s(()=>[...u[6]||=[d(`Email Address`,-1)]]),_:1}),p(`div`,F,[i(C,{id:`email`,type:`email`,placeholder:`The email address linked to your account`,modelValue:g.email,"onUpdate:modelValue":u[0]||=e=>g.email=e,disabled:_.formDisabled,required:``,class:`flex-1 rounded-full`},null,8,[`modelValue`,`disabled`])])])):(e(),n(`div`,I,[i(A,null,{default:s(()=>[i(k,null,{default:s(()=>[i(w,null,{default:s(()=>[...u[7]||=[d(`OTP`,-1)]]),_:1}),i(O,null,{default:s(()=>[i(D,{class:`rounded-full`,id:`pin-input`,modelValue:g.token,"onUpdate:modelValue":u[1]||=e=>g.token=e,placeholder:`○`,onComplete:_.completeVerification},{default:s(()=>[i(E,null,{default:s(()=>[(e(),n(l,null,t(6,(e,t)=>i(T,{key:e,index:t},null,8,[`index`])),64))]),_:1})]),_:1},8,[`modelValue`,`onComplete`])]),_:1})]),_:1})]),_:1}),p(`div`,L,[p(`p`,{class:`text-xs`,innerHTML:g.message},null,8,R)])])),p(`div`,z,[i(j,{type:`submit`,disabled:g.loading,class:`bg-black text-white rounded-full hover:bg-gray-800`},{default:s(()=>[g.loading?(e(),n(`span`,V,`Processing...`)):(e(),n(`span`,B,`Continue`))]),_:1},8,[`disabled`])]),g.requestingReset?f(``,!0):(e(),n(`div`,H,[g.resendWaitTime==0?(e(),n(`span`,U,[u[8]||=d(` Didn’t get an email? `,-1),p(`span`,{class:`text-blue-600 font-semibold cursor-pointer`,onClick:u[2]||=(...e)=>_.requestPasswordReset&&_.requestPasswordReset(...e)},` Request another code `)])):(e(),n(`span`,W,`Try again in `+r(g.resendWaitTime)+`s`,1))]))],32)]),_:1})]),_:1}),u[9]||=p(`div`,{class:`mt-4 text-end w-full max-w-lg px-2`},[p(`p`,{class:`text-xs`},[d(` Can’t access your email? `),p(`a`,{href:`https://seamlessly.ng/contact`,class:`text-blue-600 font-semibold`},`Contact Us`)])],-1)])}var K=o(M,[[`render`,G]]);export{K as default};