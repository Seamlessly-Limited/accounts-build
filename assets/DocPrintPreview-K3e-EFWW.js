import{Bi as e,Fa as t,Ki as n,La as r,Li as i,Oa as a,Pa as o,Ra as s,Ui as c,Vi as l,Wi as u,ba as ee,ca as d,i as f,ia as te,o as p,oa as m,pt as h,qi as g}from"./index-CTHZVx0Q.js";import{t as ne}from"./button-DTHLpYkO.js";var re={class:`print-preview-container`},ie={class:`no-print flex justify-end items-center mb-8 gap-3 max-w-4xl mx-auto px-4 sm:px-0`},ae={key:0,class:`flex justify-center items-center h-64`},oe={key:1,ref:`printRef`,class:`print-document bg-white p-4 shadow-lg rounded-lg max-w-4xl mx-auto`},se={class:`m-8 py-6`},ce={class:`flex justify-between items-start mb-8`},le=[`src`],ue={class:`text-2xl font-bold text-gray-900`},_={class:`text-sm text-gray-600`},v={key:1,class:`text-xs text-gray-500 font-medium`},y={class:`text-sm text-gray-600`},b={key:2,class:`text-sm text-gray-600`},x={class:`text-right`},S={class:`text-lg font-bold text-gray-900`},C={class:`mt-2 space-y-1`},w={key:0,class:`text-xs text-gray-500 font-medium`},T={key:1,class:`text-xs text-gray-500 font-medium`},E={class:`mb-8 p-4 bg-gray-50 rounded-lg`},D={class:`text-lg font-semibold text-gray-900`},O={class:`w-full mb-8 print-table`},k={class:`py-3 text-sm text-gray-600`},A={class:`py-3 text-sm text-gray-900`},j={class:`py-3 text-sm text-gray-900 text-right`},M={class:`py-3 text-sm text-gray-900 text-right`},N={class:`py-3 text-sm text-gray-900 text-right`},P={class:`py-3 text-sm text-gray-900 text-right font-medium`},F={class:`flex justify-end mb-8`},I={class:`w-64`},L={class:`flex justify-between py-2 border-b border-gray-100`},R={class:`font-medium`},z={key:0,class:`flex justify-between py-2 border-b border-gray-100`},B={class:`font-medium`},V={class:`flex justify-between py-3 text-lg font-bold`},H={class:`text-blue-600`},U={key:0,class:`flex items-center gap-4 mb-8 p-4 bg-gray-50 rounded-lg`},de=[`src`],fe={class:`grid grid-cols-2 gap-x-8 gap-y-4 mb-8`},pe={class:`text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1`},me={class:`text-sm text-gray-900`},he={class:`text-sm font-bold text-gray-700 uppercase mb-3 border-b pb-1`},ge={class:`w-full print-table`},_e={class:`border-b-2 border-gray-200`},ve={class:`py-2 text-xs text-gray-500`},ye={key:2,class:`mb-6`},be={class:`text-sm text-gray-700 whitespace-pre-line`},xe={key:3,class:`mb-6 pt-4 border-t border-gray-200`},Se={class:`text-xs text-gray-600 whitespace-pre-line`},Ce={class:`pt-8 border-t border-gray-200 text-center mt-auto`},we={class:`text-xs text-gray-500`},Te={key:0,class:`text-xs text-gray-400 mt-1`},W={__name:`DocPrintPreview`,props:{doctype:{type:String,required:!0},name:{type:String,required:!0}},setup(f){let W=f,G=a({}),K=a({}),q=a({}),J=a({}),Y=a(!0);function X(e){return e==null?`₦0.00`:new Intl.NumberFormat(`en-NG`,{style:`currency`,currency:G.value.currency||`NGN`}).format(e)}function Z(e){return e?new Date(e).toLocaleDateString(`en-GB`,{day:`2-digit`,month:`short`,year:`numeric`}):`-`}function Ee(e){return{Draft:`text-gray-500`,Submitted:`text-blue-600`,Paid:`text-green-600`,Partial:`text-amber-600`,Overdue:`text-red-600`,Cancelled:`text-red-600`,Approved:`text-green-600`,Pending:`text-amber-600`,Active:`text-green-600`}[e]||`text-gray-500`}function Q(e){return[`CURRENCY`,`FLOAT`,`INT`,`PERCENT`].includes(e.fieldtype)}let De=e(()=>K.value.fields?K.value.fields.filter(e=>!e.hidden&&![`TABLE`,`SECTION_BREAK`,`COLUMN_BREAK`,`HTML`,`READ_ONLY`].includes(e.fieldtype)&&G.value[e.fieldname]!==void 0&&G.value[e.fieldname]!==null&&G.value[e.fieldname]!==``):[]),Oe=e(()=>K.value.fields?K.value.fields.filter(e=>e.fieldtype===`TABLE`&&!e.hidden):[]);function $(e){if(!G.value[e.fieldname]||G.value[e.fieldname].length===0)return[];let t=G.value[e.fieldname][0];return Object.keys(t).filter(e=>![`name`,`owner`,`creation`,`modified`,`modified_by`,`parent`,`parentfield`,`parenttype`,`idx`,`docstatus`].includes(e)).map(e=>({fieldname:e,label:e.replace(/_/g,` `).toUpperCase(),fieldtype:typeof t[e]==`number`?`CURRENCY`:`DATA`}))}function ke(){window.print()}async function Ae(){Y.value=!0;try{K.value=(await p.get(`/org/doctypes/${encodeURIComponent(W.doctype)}`,{authorizeRequest:!0,organisationAware:!0})).data||{},G.value=(await p.get(`/org/doc/${encodeURIComponent(W.doctype)}/${encodeURIComponent(W.name)}`,{authorizeRequest:!0,organisationAware:!0})).data||{},document.title=`${W.doctype}: ${W.name} - Print Preview`;try{J.value=(await p.get(`/org/details`,{authorizeRequest:!0,organisationAware:!0})).data||{}}catch(e){console.error(`Failed to fetch organisation details:`,e)}try{q.value=(await p.get(`/org/doc/Brand Settings/Brand Settings`,{authorizeRequest:!0,organisationAware:!0})).data||{}}catch{console.warn(`Brand settings not found`)}}catch(e){console.error(`Failed to fetch data:`,e)}finally{Y.value=!1}}return te(Ae),(e,a)=>(m(),u(`div`,re,[l(`div`,ie,[g(o(ne),{variant:`outline`,onClick:ke,class:`rounded-full shadow-sm bg-white hover:bg-stone-50 border-stone-200 text-stone-600 px-6 font-semibold h-10`},{default:ee(()=>[g(o(h),{class:`w-4 h-4 mr-2`}),a[0]||=n(` Print `,-1)]),_:1})]),Y.value?(m(),u(`div`,ae,[...a[1]||=[l(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600`},null,-1)]])):(m(),u(`div`,oe,[l(`div`,se,[l(`div`,ce,[l(`div`,null,[q.value?.logo_url?(m(),u(`img`,{key:0,src:q.value.logo_url,alt:`Company Logo`,class:`h-16 mb-2`},null,8,le)):c(``,!0),l(`h1`,ue,s(J.value?.legalName||J.value?.name||q.value?.legal_name||`Company Name`),1),l(`p`,_,s(J.value?.fullAddress||q.value?.full_address||``),1),J.value?.state||J.value?.country?(m(),u(`p`,v,s([J.value?.state,J.value?.country].filter(Boolean).join(`, `)),1)):c(``,!0),l(`p`,y,s(J.value?.phone||q.value?.phone||``),1),J.value?.email||q.value?.email?(m(),u(`p`,b,s(J.value?.email||q.value?.email),1)):c(``,!0)]),l(`div`,x,[l(`h2`,{class:`text-3xl font-black mb-1 uppercase tracking-tight`,style:r({color:K.value?.color||`#2563eb`})},s(K.value?.name||f.doctype),5),l(`p`,S,`#`+s(G.value.name||W.name),1),l(`div`,C,[G.value.posting_date||G.value.date?(m(),u(`p`,w,` DATE: `+s(Z(G.value.posting_date||G.value.date)),1)):c(``,!0),G.value.due_date?(m(),u(`p`,T,` DUE: `+s(Z(G.value.due_date)),1)):c(``,!0),G.value.status?(m(),u(`p`,{key:2,class:t([`text-xs font-bold uppercase`,Ee(G.value.status)])},` STATUS: `+s(G.value.status),3)):c(``,!0)])])]),f.doctype===`Sales Invoice`?(m(),u(i,{key:0},[l(`div`,E,[a[2]||=l(`h3`,{class:`text-sm font-semibold text-gray-500 uppercase mb-2`},`Bill To`,-1),l(`p`,D,s(G.value.customer_name),1)]),l(`table`,O,[a[3]||=l(`thead`,null,[l(`tr`,{class:`border-b-2 border-gray-200`},[l(`th`,{class:`text-left py-2 text-sm font-semibold text-gray-600`},`#`),l(`th`,{class:`text-left py-2 text-sm font-semibold text-gray-600`},`Description`),l(`th`,{class:`text-right py-2 text-sm font-semibold text-gray-600`},`Qty`),l(`th`,{class:`text-right py-2 text-sm font-semibold text-gray-600`},`Rate`),l(`th`,{class:`text-right py-2 text-sm font-semibold text-gray-600`},`Tax`),l(`th`,{class:`text-right py-2 text-sm font-semibold text-gray-600`},`Amount`)])],-1),l(`tbody`,null,[(m(!0),u(i,null,d(G.value.items||[],(e,t)=>(m(),u(`tr`,{key:t,class:`border-b border-gray-100`},[l(`td`,k,s(t+1),1),l(`td`,A,s(e.description),1),l(`td`,j,s(e.qty),1),l(`td`,M,s(X(e.rate)),1),l(`td`,N,s(X(e.tax_amount||0)),1),l(`td`,P,s(X(e.net_amount||e.amount)),1)]))),128))])]),l(`div`,F,[l(`div`,I,[l(`div`,L,[a[4]||=l(`span`,{class:`text-gray-600`},`Subtotal`,-1),l(`span`,R,s(X(G.value.grand_total)),1)]),G.value.total_tax?(m(),u(`div`,z,[a[5]||=l(`span`,{class:`text-gray-600`},`Tax`,-1),l(`span`,B,s(X(G.value.total_tax)),1)])):c(``,!0),l(`div`,V,[a[6]||=l(`span`,null,`Total Due`,-1),l(`span`,H,s(X(G.value.outstanding_amount||G.value.grand_total)),1)])])]),G.value.qr_code?(m(),u(`div`,U,[l(`img`,{src:G.value.qr_code,alt:`Payment QR Code`,class:`w-24 h-24`},null,8,de),a[7]||=l(`div`,null,[l(`p`,{class:`text-sm font-semibold text-gray-700`},`Scan to Pay`),l(`p`,{class:`text-xs text-gray-500`},`Use your phone to scan and pay instantly`)],-1)])):c(``,!0)],64)):(m(),u(i,{key:1},[l(`div`,fe,[(m(!0),u(i,null,d(De.value,e=>(m(),u(`div`,{key:e.fieldname,class:`border-b border-gray-50 py-2`},[l(`h4`,pe,s(e.label),1),l(`p`,me,[e.fieldtype===`CURRENCY`?(m(),u(i,{key:0},[n(s(X(G.value[e.fieldname])),1)],64)):e.fieldtype===`DATE`?(m(),u(i,{key:1},[n(s(Z(G.value[e.fieldname])),1)],64)):(m(),u(i,{key:2},[n(s(G.value[e.fieldname]||`—`),1)],64))])]))),128))]),(m(!0),u(i,null,d(Oe.value,e=>(m(),u(`div`,{key:e.fieldname,class:`mb-8`},[l(`h3`,he,s(e.label),1),l(`table`,ge,[l(`thead`,null,[l(`tr`,_e,[a[8]||=l(`th`,{class:`text-left py-2 text-xs font-semibold text-gray-600`},`#`,-1),(m(!0),u(i,null,d($(e),e=>(m(),u(`th`,{key:e.fieldname,class:t([`text-left py-2 text-xs font-semibold text-gray-600`,{"text-right":Q(e)}])},s(e.label),3))),128))])]),l(`tbody`,null,[(m(!0),u(i,null,d(G.value[e.fieldname]||[],(r,a)=>(m(),u(`tr`,{key:a,class:`border-b border-gray-50`},[l(`td`,ve,s(a+1),1),(m(!0),u(i,null,d($(e),e=>(m(),u(`td`,{key:e.fieldname,class:t([`py-2 text-xs text-gray-900`,{"text-right":Q(e)}])},[e.fieldtype===`CURRENCY`?(m(),u(i,{key:0},[n(s(X(r[e.fieldname])),1)],64)):(m(),u(i,{key:1},[n(s(r[e.fieldname]||`—`),1)],64))],2))),128))]))),128))])])]))),128))],64)),G.value.payment_instructions?(m(),u(`div`,ye,[a[9]||=l(`h3`,{class:`text-sm font-semibold text-gray-500 uppercase mb-2`},`Payment Instructions`,-1),l(`p`,be,s(G.value.payment_instructions),1)])):c(``,!0),G.value.terms_and_conditions||G.value.terms?(m(),u(`div`,xe,[a[10]||=l(`h3`,{class:`text-sm font-semibold text-gray-500 uppercase mb-2`},`Terms & Conditions`,-1),l(`p`,Se,s(G.value.terms_and_conditions||G.value.terms),1)])):c(``,!0),l(`div`,Ce,[l(`p`,we,`Regulated and Powered by `+s(q.value?.legal_name||`Seamlessly`),1),q.value?.website?(m(),u(`p`,Te,s(q.value.website),1)):c(``,!0)])])],512))]))}},G=f(W,[[`__scopeId`,`data-v-d8d2684c`]]);export{G as default};