import{A as e,D as t,H as n,M as r,X as i,Z as a,ct as o,ft as s,v as c}from"./index-vegYmq3T.js";import{n as l}from"./VisuallyHidden-DQsaJJLU.js";import{r as u}from"./dist-7nj00zp2.js";function d(e){return typeof e==`string`?`'${e}'`:new f().serialize(e)}var f=function(){class e{#t=new Map;compare(e,t){let n=typeof e,r=typeof t;return n===`string`&&r===`string`?e.localeCompare(t):n===`number`&&r===`number`?e-t:String.prototype.localeCompare.call(this.serialize(e,!0),this.serialize(t,!0))}serialize(e,t){if(e===null)return`null`;switch(typeof e){case`string`:return t?e:`'${e}'`;case`bigint`:return`${e}n`;case`object`:return this.$object(e);case`function`:return this.$function(e)}return String(e)}serializeObject(e){let t=Object.prototype.toString.call(e);if(t!==`[object Object]`)return this.serializeBuiltInType(t.length<10?`unknown:${t}`:t.slice(8,-1),e);let n=e.constructor,r=n===Object||n===void 0?``:n.name;if(r!==``&&globalThis[r]===n)return this.serializeBuiltInType(r,e);if(typeof e.toJSON==`function`){let t=e.toJSON();return r+(typeof t==`object`&&t?this.$object(t):`(${this.serialize(t)})`)}return this.serializeObjectEntries(r,Object.entries(e))}serializeBuiltInType(e,t){let n=this[`$`+e];if(n)return n.call(this,t);if(typeof t?.entries==`function`)return this.serializeObjectEntries(e,t.entries());throw Error(`Cannot serialize ${e}`)}serializeObjectEntries(e,t){let n=Array.from(t).sort((e,t)=>this.compare(e[0],t[0])),r=`${e}{`;for(let e=0;e<n.length;e++){let[t,i]=n[e];r+=`${this.serialize(t,!0)}:${this.serialize(i)}`,e<n.length-1&&(r+=`,`)}return r+`}`}$object(e){let t=this.#t.get(e);return t===void 0&&(this.#t.set(e,`#${this.#t.size}`),t=this.serializeObject(e),this.#t.set(e,t)),t}$function(e){let t=Function.prototype.toString.call(e);return t.slice(-15)===`[native code] }`?`${e.name||``}()[native]`:`${e.name}(${e.length})${t.replace(/\s*\n\s*/g,``)}`}$Array(e){let t=`[`;for(let n=0;n<e.length;n++)t+=this.serialize(e[n]),n<e.length-1&&(t+=`,`);return t+`]`}$Date(e){try{return`Date(${e.toISOString()})`}catch{return`Date(null)`}}$ArrayBuffer(e){return`ArrayBuffer[${new Uint8Array(e).join(`,`)}]`}$Set(e){return`Set${this.$Array(Array.from(e).sort((e,t)=>this.compare(e,t)))}`}$Map(e){return this.serializeObjectEntries(`Map`,e.entries())}}for(let t of[`Error`,`RegExp`,`URL`])e.prototype[`$`+t]=function(e){return`${t}(${e})`};for(let t of[`Int8Array`,`Uint8Array`,`Uint8ClampedArray`,`Int16Array`,`Uint16Array`,`Int32Array`,`Uint32Array`,`Float32Array`,`Float64Array`])e.prototype[`$`+t]=function(e){return`${t}[${e.join(`,`)}]`};for(let t of[`BigInt64Array`,`BigUint64Array`])e.prototype[`$`+t]=function(e){return`${t}[${e.join(`n,`)}${e.length>0?`n`:``}]`};return e}();function p(e,t){return e===t||d(e)===d(t)}var m=`data-reka-collection-item`;function h(d={}){let{key:f=``,isProvider:p=!1}=d,h=`${f}CollectionProvider`,g;if(p){let e=s(new Map);g={collectionRef:s(),itemMap:e},n(h,g)}else g=r(h);let _=(e=!1)=>{let t=g.collectionRef.value;if(!t)return[];let n=Array.from(t.querySelectorAll(`[${m}]`)),r=Array.from(g.itemMap.value.values()).sort((e,t)=>n.indexOf(e.ref)-n.indexOf(t.ref));return e?r:r.filter(e=>e.ref.dataset.disabled!==``)},v=t({name:`CollectionSlot`,setup(t,{slots:n}){let{primitiveElement:r,currentElement:a}=l();return i(a,()=>{g.collectionRef.value=a.value}),()=>e(u,{ref:r},n)}}),y=t({name:`CollectionItem`,inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(t,{slots:n,attrs:r}){let{primitiveElement:i,currentElement:s}=l();return a(e=>{if(s.value){let n=o(s.value);g.itemMap.value.set(n,{ref:s.value,value:t.value}),e(()=>g.itemMap.value.delete(n))}}),()=>e(u,{...r,[m]:``,ref:i},n)}}),b=c(()=>Array.from(g.itemMap.value.values())),x=c(()=>g.itemMap.value.size);return{getItems:_,reactiveItems:b,itemMapSize:x,CollectionSlot:v,CollectionItem:y}}export{p as n,h as t};